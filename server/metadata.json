[
    {
        "data": "账号接口 1\nimport Callout from “nextra-theme-docs/callout ”; import AuthDigram from\n“./assets/login.svg ”;\n账号接口\n1.流程\n游戏入口页面需要加载平台提供的 g123-cp-sdk ，见 G123 CP SDK\n1.用户打开 /刷新游戏页面\n2.平台加载游戏 iframe, 使用平台提供的 g123-cp-sdk 在游戏页面内获取 code。见 :获取\n平台参数\n3.游戏前端将 code发送到游戏 Login 服务器，在 Login 服务器上端调用 获取平台用户 ID\nAPI\n-平台负责判定用户的地区，语言、币种 -玩家无需注册游戏，平台会自动分配唯一的 G123 ID; -\n用户可将 G123 ID 绑至第三方 SNS账号 - G123 ID 格式 : G开头的 7~9位数字字母组合。\n例： G16ITBZL W\n2.准备\n登入 Publisher->G123 接入 1.获取appId、appSecret 2.配置游戏入口 URL ,从\nPublisher 部署游戏 3.拷贝G123测试环境入口 ,从平台入口访问游戏\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp账号接口 2\n平台游戏入口 系统要求\n/game/$appId iOS Safari > 14,Android Chrome > 94,Chrome >\n94,PC(Windows, Mac OSX), not IE\n3.获取平台用户 ID API\n本地开发\n可使用下列入口将本地的游戏地址加载到测试页面中，以方便在本地开发调试获取平台参数等功能。\n(注：由于 Safari 等部分浏览器强制 https，需要更改浏览器安全设置才能正常加载 )\nhttps://h5.stg.g123.jp/game/ 𝑎𝑝𝑝𝐼𝑑?𝑔𝑎𝑚𝑒𝐸𝑛𝑡𝑟𝑦 = {本地入口地址 }\n如: https://h5.stg.g123.jp/game/testapp?gameEntry=http://localhost:3000\nEndpoint\nRequest"
    },
    {
        "data": "(注：由于 Safari 等部分浏览器强制 https，需要更改浏览器安全设置才能正常加载 )\nhttps://h5.stg.g123.jp/game/ 𝑎𝑝𝑝𝐼𝑑?𝑔𝑎𝑚𝑒𝐸𝑛𝑡𝑟𝑦 = {本地入口地址 }\n如: https://h5.stg.g123.jp/game/testapp?gameEntry=http://localhost:3000\nEndpoint\nRequest\nGET{API_Host}/api/v1/cp/user?code={access_code}&globalize=1\nRequest Header\nRequest\nheader V alue Description\nContent-\nTypeapplication/json\nAuthorization Basic base64(\n‘𝑎𝑝𝑝𝐼𝑑 ∶ appSecret ’)使用 Basic认证方式发送 appId\n和 appSecret, Base64 encode\nResponse账号接口 3\nparameter value samples description\nuserId G12345678 G123 ID; 平\n台发行的用户\nID\nregion 已废止 ,请忽略\ncountry JP 、US、CA等 用户所在国\n家/地区代码。\n使用 ISO\n3166-1\nalpha-2\nlang ja、en、zh-CN 、zh-TW 、fr等 游戏内显示语言\n代码 ISO\n639-1和\nBCP 47 ，\ncurrency JPY 、USD、GBP等 平台依据用户地\n区确定支付货币\n代码 ISO\n4727\nError\n401 code unavailable; //code 已过期，请重新加载页面获取新的 code\nCORS: // 请使用服务器端，禁止在前端暴露秘钥\n用例\nRequest\ncurl\\\n-H\"Content-Type:application/json\" \\\n-H\"Authorization:Basic $(echo-n$APP_ID:$APP_SECRET |openssl base64 -A)\"\\\n\"https://h5.stg.g123.jp/api/v1/cp/user?code= $ACCESS_CODE &globalize=1\"账号接口 4\nResponse\n{"
    },
    {
        "data": "-H\"Content-Type:application/json\" \\\n-H\"Authorization:Basic $(echo-n$APP_ID:$APP_SECRET |openssl base64 -A)\"\\\n\"https://h5.stg.g123.jp/api/v1/cp/user?code= $ACCESS_CODE &globalize=1\"账号接口 4\nResponse\n{\n\"userId\" :\"G1234567\" ,\n\"region\" :\"GLOBAL\" ,\n\"country\" :\"CA\",\n\"lang\":\"en\",\n\"currency\" :\"USD\"\n}\n4.游戏内切换语言\n当玩家在游戏内更改语言时，需通过此 API通知平台。平台收到后会自动刷新页面并生成新的 code，\n确保平台与游戏语言一致。游戏内无需实现“切换语言”功能。\nwindow.top.postMessage (\n{\naction:\"switch_lang\" ,\ndata:{\nlang:\"en\",// lang 参数保持一致\n},\n},\n\"*\"\n);\n仅用于游戏本身支持语言切换的情况G123平台接入指南 1\nimport Callout from ‘nextra-theme-docs/callout ’\nG123 平台接入指南\n一、 G123 平台特性\n• G123平台主打 H5网页游戏，开发适配时请参考 最佳实践\n• G123用户无需注册账号，进入游戏即为其分配唯一的用户 ID（G123 ID ）\n• G123平台支持 多语言切换\n• G123平台提供推荐 多语言字体 下载，开发多语言游戏版本时，请参照下载使用\n• G123平台支持 多币种支付\n二、接入流程概述\n图 1: workflow\n三、 G123 平台接口 /文档列表\n平台接\n口/文档 说明 接入阶段\n翻译 (必接 )可上传原文\n文本，并下\n载译文游戏制作G123平台接入指南 2\n平台接\n口/文档 说明 接入阶段\n账号 (必接 )获取 G123\n用户唯一\nID及国际\n化参数等账\n号信息测试环境 &正式环境\n支付 (必接 )接入 G123\n平台支付系\n统（多币种\n支持）测试环境 &正式环境\n打点 (必接 )向 G123\n平台上报重\n要的日志数\n据测试环境 &正式环境\n客服 (必接 )调起 G123\n平台客服系"
    },
    {
        "data": "文本，并下\n载译文游戏制作G123平台接入指南 2\n平台接\n口/文档 说明 接入阶段\n账号 (必接 )获取 G123\n用户唯一\nID及国际\n化参数等账\n号信息测试环境 &正式环境\n支付 (必接 )接入 G123\n平台支付系\n统（多币种\n支持）测试环境 &正式环境\n打点 (必接 )向 G123\n平台上报重\n要的日志数\n据测试环境 &正式环境\n客服 (必接 )调起 G123\n平台客服系\n统测试环境 &正式环境\n礼包 (必接 )提供\npopup\nAPI接口\n给平台，调\n用 gift\nAPI获取\n礼包信息测试环境 &正式环境\n活动 (必接 )游戏内活动\n效果数据分\n析用上线前正式环境\n附加功能\n(选接 )G123\nSNS分\n享/绑定 /切\n换账号登选\n接 API测试环境 &正式环境G123平台接入指南 3\n平台接\n口/文档 说明 接入阶段\n部署 申请 Infra\n资源与发布\n游戏（建议\n接入平台前\n完成\nMVP 部\n署）测试环境 &正式环境\n常见问题 关于接入平\n台时的常见\n问题正式环境\n国际化对应 国际化参数\n详解测试环境 &正式环境\nJS SDK JS SDK 测试环境 &正式环境\n消息推送 Push\nMessage测试环境 &正式环境\n查询用户\nIM绑定User IM\nBind测试环境 &正式环境\n四、接入须知\n多语言切换技术要点\n平台这边默认所有游戏、后续都会进行海外的投放、游戏国际化的技术实现、请提前同步以下几点\n•游戏的多语言支持：玩家可以在游戏内自由 切换语言 。\n请务必确认对游戏切语言的支持、必要时烦请提前做好游戏架构更新。\n•玩家进入游戏时的语言：始终根据平台透传的相关 语言参数、展示给玩家对应的语言界面。\n•切换语言时与平台的联动：玩家游戏内切换语言时、需要将切换的目标 语言参数通知平台。\n•海外多币种支持：始终根据平台透传的 币种参数、使用该币种的固定价目表来展示金额、以及创\n建订单。 （创建订单时传递的金额和币种一定要匹配）G123平台接入指南 4\n•支持全球玩家混服等数据互动：后台全球玩家数据互通、 infra单地区单系统即可。 （阿里云日\n本区、全球玩家访问速度没问题）\n接入详情请参照： 国际化详细文档\n其他须知\n1.所有 API请走后端 ,不要将平台 key等暴露在前端显示\n2.网络不稳定或支付测试报错时请尝试连接 VPN后重试"
    },
    {
        "data": "建订单。 （创建订单时传递的金额和币种一定要匹配）G123平台接入指南 4\n•支持全球玩家混服等数据互动：后台全球玩家数据互通、 infra单地区单系统即可。 （阿里云日\n本区、全球玩家访问速度没问题）\n接入详情请参照： 国际化详细文档\n其他须知\n1.所有 API请走后端 ,不要将平台 key等暴露在前端显示\n2.网络不稳定或支付测试报错时请尝试连接 VPN后重试\n3.控制台偶有报错是由于网络不稳定，属于正常情况，持续报错才有问题\n4.平台提供了 登录支付模拟 demo\n5.平台测试环境数据库 15分钟无动作会自动休眠，发送一次请求后即可唤醒数据库，等待 1~2\n分钟即可。\n五、最佳实践\n资源加载\n•图片等静态资源、尽量不要做加密处理。很多设备的加解密性能很差、影响游戏加载速度。\n•尽早发现功能上的加载热点（比如某个功能的点开需要数十个资源请求） 、做好相关资源的提前加\n载。\n•在不影响玩家体验的前提下、尽量压缩游戏资源、以加快 CDN下载速度与减少资源内存占\n用。 （ CDN自动压缩的对象资源最大 10M）\n•游戏整体的静态资源、尽量做到分批加载。如加载完游戏首屏的资源下载量 20M、通过新手教\n程的资源下载量 50M等。 （以页游的推广策略与留存来看、大多数玩家可能在前期离开、 CDN\n的按量成本需要做好控制）\n•游戏使用 cocos引擎时、前端 maxConcurrency 与 maxRequestsPerF rame 配\n置可尽量调大些。现在连接都是 http 2.0 、调大这些参数会加载得更快、尤其对于数量多的小\n文件。 REF\n•同上，使用白鹭引擎时，通过 setMaxLoadingThread() 增加资源并发加载数G123平台接入指南 5\njs代码压缩\n•代码混淆会使 js文件大小急剧增加，使游戏加载速度变慢，因此不推荐对 js进行代码混淆。可\n以使用 T erser/UglifyJS 等工具对代码进行压缩。\n游戏体验相关\n关于游戏服务器选服\n•游戏服务器命名统一从 S1，S2，S3的形式递增往下命名，无需特殊命名名称\n•游戏载入时，不要停留在选服页面，直接进入游戏，仅在用户在设定中选择服务器时才显示选服\n确认页面\n关于游戏内常规运营活动\n•游戏内签到功能，尽量做到用户登录后直接弹出来，自动为用户点击签到并领取奖励\n平台游戏实例"
    },
    {
        "data": "以使用 T erser/UglifyJS 等工具对代码进行压缩。\n游戏体验相关\n关于游戏服务器选服\n•游戏服务器命名统一从 S1，S2，S3的形式递增往下命名，无需特殊命名名称\n•游戏载入时，不要停留在选服页面，直接进入游戏，仅在用户在设定中选择服务器时才显示选服\n确认页面\n关于游戏内常规运营活动\n•游戏内签到功能，尽量做到用户登录后直接弹出来，自动为用户点击签到并领取奖励\n平台游戏实例\n4.追踪转化 (过期 ) 1\nimport Callout from ‘nextra-theme-docs/callout ’\n4.追踪转化 (过期 )\n使用场景：玩家触发 玩家创角成功 事件(广告转化条件 )时，游戏通过此 API通知平台。\ntry {\nwindow .top .postMessage (JSON .stringify ({\nevent :'CreateRole' ,\n}) ,'https://h5.stg.g123.jp' );\n//正式环境 https://h5.g123.jp\n} catch (e) {\nwindow .console && window .console .log (e) ;\n}\n*一位玩家只允许触发一次广告转化条件 *根据游戏不同，会有玩家创角事件以外的转化条件云原生部署平台 1\nimport Callout from “nextra-theme-docs/callout ”;\n云原生部署平台\nG123所有游戏均部署在基于 Kubernetes 构建的云平台上。游戏服务端各容器化应用的镜像推送、\n部署、 DB配置等内容，以及客户端的 CDN配置、资源上传等，均可通过 Publisher 工具（使\n用说明书 ）来实现系统组件的申请与修改、应用程序的部署与发布等。平台同时提供基于 Grafana\nCloud的日志监控系统 。\n1.系统构成\nDOs\n•支持 CDN 全球节点部署、客户端 静态资源 及公开的客户端用 配置文件 。 （提供命令行与拖拽\n上传）\n•支持各种应用的 分布式部署。 （如游服、登陆等服务的幂等冗余部署、需要保证数据一致性）\n•支持各种 多进程应用拆分成多容器部署。 （如游服应用的主逻辑进程、数据存储进程、网关进程\n等。任意容器掉线、集群自动拉起。 ）"
    },
    {
        "data": "Cloud的日志监控系统 。\n1.系统构成\nDOs\n•支持 CDN 全球节点部署、客户端 静态资源 及公开的客户端用 配置文件 。 （提供命令行与拖拽\n上传）\n•支持各种应用的 分布式部署。 （如游服、登陆等服务的幂等冗余部署、需要保证数据一致性）\n•支持各种 多进程应用拆分成多容器部署。 （如游服应用的主逻辑进程、数据存储进程、网关进程\n等。任意容器掉线、集群自动拉起。 ）\n•支持登入 容器内访问。 （ Publisher 工具内对应 APP下的服务页面内可登入 Pod）\n•支持游服类型 APP的自动部署 与自动开服 。\n•支持各种应用的 不停机滚动更新。 （先启动新版本后停止旧版本、推荐登录支付等 无状态 APP使\n用）\n•支持三种外部存储：主从非分片 Redis (5.0 ,6.0 ,7.0 ),集群版 MySQL (5.7 ,\n8.0 ) &副本集 MongoDB (5.0 ).（GMS用玩家行为数据请分库分表存储、平台不\n额外提供数据库集群、保留最近一个月的数据即可）\n•支持服务端多 APP共享配置文件 的管理。 （ Publisher 工具内服务端的配置文件功能）\n•支持定时任务 。 （有任务容器的部署与启动时间、精准定时任务请通过 API等方式实现）\n•支持各应用 APP公网访问地址的 WSS 协议通信。 （通过负载均衡 ALB反向代理实现、\n请在应用层做好协议升级： 浏览器 → ALB 某 APP路径 :443 → 某 APP的“对外”端\n口:9000）\n•支持 SSL证书托管、无需在应用内实现。云原生部署平台 2\n•支持自动收集 服务端应用打印到、 标准输出 （ stdout 、 控制台输出） 的日志至 Grafana Cloud\n实时查询 。\n•支持各系统组件与应用性能的 Grafana Cloud 实时监控 。\nDON’T s\n•不提供本地 磁盘。 （容器内 /g123/ 路径下文件、支持持久化存储与下载。适用于低 I/O场景、\n勿保存日志文件）\n•不提供 Windows 镜像部署。\n•不提供基础镜像 、请各游戏根据技术栈自行选取。 （不推荐使用 3.3及更早版本 Alpine 镜像）\n•不提供默认 时区的配置、请在各应用镜像 Dockerfile 内定义。 （ ENV TZ=Asia/Tokyo ）"
    },
    {
        "data": "DON’T s\n•不提供本地 磁盘。 （容器内 /g123/ 路径下文件、支持持久化存储与下载。适用于低 I/O场景、\n勿保存日志文件）\n•不提供 Windows 镜像部署。\n•不提供基础镜像 、请各游戏根据技术栈自行选取。 （不推荐使用 3.3及更早版本 Alpine 镜像）\n•不提供默认 时区的配置、请在各应用镜像 Dockerfile 内定义。 （ ENV TZ=Asia/Tokyo ）\n•不提供应用停机前的 内存数据 入库。 （务必做好主进程 PID 1 监听 OS、发出的 SIGTERM\n以优雅停机）\n•不提供单应用多端口的 公网访问。 （每个 APP只有第一个端口对外、包括多容器部署场景、其\n他端口对外请自行实现转发）\n•不支持负载均衡与服务端超过 60秒闲置的长连接。 （请主动实现保活心跳机制、每 60秒内进\n行一次报文交互）\n•不支持服务间通过 IP地址连接。 （请使用内网域名）\n•不要自己做操作系统级别的 crontab .（请使用 Publisher 定时任务功能）\n•不要自己做 中间件的容器化部署。 （如消息队列、 Zookeeper 等）\n•不要自己做数据 pipeline .（如 Hadoop 等）\n2.功能模块\n以下为发布至 G123平台前需要各游戏开发实现的功能列表\n2.1自动开服\n游服类型 APP需提供该功能。可优先游戏部署、正式上线前必须对应完成\n•游服类型 APP需支持、在特定开服策略 （如游戏客户端埋点 g_createrole 创角 5000\n人）下的自动部署与开服功能。云原生部署平台 3\n•游服 N-1服达到开服策略定义（如创角 5000人）时、会触发游服 N服的“自动开服”操作。\n如：\n1.平台查询游服 N-1服的创角人数、达到开游服 N服条件\n–API ￿: 实时查询游戏客户端上报给平台的创角埋点定义（默认）\n–API ￿ :实时查询游戏内创角定义、如果必要请提供相关 API接口并通过自动开\n服“保护机制”开启（可选）\n2.平台调用游戏的 开服通知 API ￿：游服 N服可允许玩家进入、新玩家请导流至此服并\n更新选服页面\n3.游戏调用平台的 开服回调 API ￿：能否开服\n4.平台接收开服回调、并通过小包在钉钉大群通知开服结果\n5.平台调用游戏的 部署通知 API ￿：准备部署游服 N+1服、请做好该服的初始化动作 （如"
    },
    {
        "data": "服“保护机制”开启（可选）\n2.平台调用游戏的 开服通知 API ￿：游服 N服可允许玩家进入、新玩家请导流至此服并\n更新选服页面\n3.游戏调用平台的 开服回调 API ￿：能否开服\n4.平台接收开服回调、并通过小包在钉钉大群通知开服结果\n5.平台调用游戏的 部署通知 API ￿：准备部署游服 N+1服、请做好该服的初始化动作 （如\n数据库初始化、配置更新等）\n6.游戏调用平台的 部署回调 API ￿：能否部署\n7.平台接收正常的部署回调：环境变量 $SERVER_ID 自动 +1并用于启动游服 N+1\n服\n•开服策略调整时、请更新开服配置（如 CPU/Mem 等）以保证系统稳定运行云原生部署平台 4\n2.1.1 部署当游服 APP 完成 1服部署并首次开启自动开服功能时、系统会主动发起针对 2\n服的部署 API调用。此时 1服为导流服、2服为预备服（完成部署、等待开服）\n2.1.1.1 部署通知 API W ebhook\n必须是 https接口、请在 Publisher 内记入 { Webhook }\nAuthorization\n平台调用该 { Webhook } 时会使用、请在 Publisher 内记入 { Token }云原生部署平台 5\nRequest\n当自动开服策略 不包含创角人数 （如按付费人数或者定时开服等）时、请求中的\nserverUsers 字段将默认传入： 0\n{\n\"actionId\" : string //操作的 TraceID ,publisher 会用该 TraceID 来追踪这次操作的状态\n\"serverUsers\" : number //新服配置的创角人数或 0\n\"serverId\" : number //当前请求开第几个服\n\"newServerNames\" : [] string //游服类型 APP下的 Pod名称、即 {游服 APP名称 }{serverId }\n\"callbackToken\" : string //调用平台回调 API时需要回传该 Token\n}\nResponse\n{\n\"message\" : string\n}\nHttpStatusCode Description\n200 OK.如果 webhook 同步执行，耗时不长，可直接返回 200无需回调平台"
    },
    {
        "data": "\"callbackToken\" : string //调用平台回调 API时需要回传该 Token\n}\nResponse\n{\n\"message\" : string\n}\nHttpStatusCode Description\n200 OK.如果 webhook 同步执行，耗时不长，可直接返回 200无需回调平台\n202 Accept. 如果该 webhook 需要异步执行，返回 202.完成后调用平台的开\n服回调 API\n403 No Permission. 当 T oken 不正确时\n422 请求不能执行，请返回 message\n示例\nW ebhook\nhttps://appid-slb.stg.g123-cpp.com/center/new_server\nAuthorization\nT oken: test_g123_token1234\nRequest云原生部署平台 6\nPOST /center/new_server Host: https://appid-slb.stg.g123-cpp.com\nAuthorization: test_g123_token1234\n{\n\"actionId\" : \"1000\" ,\n\"serverUsers\" : 5000 , //新服配置 5000创角\n\"serverId\" : 2, //新服为 2服\n\"newServerNames\" : [\"game2\" ] //游服类型 APP名称为 game\n\"callbackToken\" : \"^6Q%j0kZ74S\" //调用平台回调 API时需要\n}\n2.1.1.2 部署回调 API\n如果部署通知 API返回 200不需要调用该接口。\n•测试环境： https://game-cloud.stg.g123.jp/cp/api/v1/new_server/callback\n•正式环境： https://game-cloud.g123.jp/cp/api/v1/new_server/callback\nRequest\n{\n\"appId\" : string\n\"actionId\" : string //回传平台调用开服通知 API时的 actionId\n\"callbackToken\" : string //回传平台调用开服通知 API时的 callbackToken"
    },
    {
        "data": "•正式环境： https://game-cloud.g123.jp/cp/api/v1/new_server/callback\nRequest\n{\n\"appId\" : string\n\"actionId\" : string //回传平台调用开服通知 API时的 actionId\n\"callbackToken\" : string //回传平台调用开服通知 API时的 callbackToken\n\"success\" : bool //处理成功\n\"message\" : string //处理失败时将原因放在该字段\n}\nResponse\n{\n\"type\" : string\n\"message\" : string\n\"reason\" : string\n}云原生部署平台 7\nHttpStatusCode Type Description\n200 OK\n403 NO_PERMISSION 没有权限\n422 NO_W AITING_ACTION 该开服流程没有使用回调（请查看 部署通知 API在实现时返回的\n200）\n2.1.2 开服默认游服 APP 在开启自动开服功能前、已手动完成 1服的部署与开服。以下为\n针对从游服 2服起的 API调用\n2.1.2.1 开服通知 API W ebhook\n必须是 https接口、请在 Publisher 内记入 { Webhook }\nAuthorization\n平台调用该 { Webhook } 时会使用、请在 Publisher 内记入 { Token }\nRequest\n当自动开服策略 不包含创角人数 （如按付费人数或者定时开服等）时、请求中的\nserverUsers 字段将默认传入： 0\nPOST {Webhook }\nAuthorization: { Token }\n{\n\"actionId\" : string //操作的 TraceID ,publisher 会用该 TraceID 来追踪这次操作的状态\n\"serverUsers\" : number //新服配置的创角人数或 0\n\"serverId\" : number //当前请求开第几个服\n\"newServerNames\" : [] string //游服类型 APP下的 Pod名称、即 {游服 APP名称 }{serverId }"
    },
    {
        "data": "\"serverUsers\" : number //新服配置的创角人数或 0\n\"serverId\" : number //当前请求开第几个服\n\"newServerNames\" : [] string //游服类型 APP下的 Pod名称、即 {游服 APP名称 }{serverId }\n\"callbackToken\" : string //调用平台回调 API时需要回传该 Token\n}\nResponse云原生部署平台 8\n{\n\"message\" : string\n}\nHttpStatusCode Description\n200 OK.如果 webhook 同步执行，耗时不长，可直接返回 200无需回调平台\n202 Accept. 如果该 webhook 需要异步执行，返回 202.完成后调用平台的开\n服回调 API\n403 No Permission. 当 T oken 不正确时\n422 请求不能执行，请返回 message\n示例\nW ebhook\nhttps://appid-slb.stg.g123-cpp.com/center/open_server\nAuthorization\nT oken: test_g123_token1234\nRequest\nPOST /center/open_server Host: https://appid-slb.stg.g123-cpp.com\nAuthorization: test_g123_token1234\n{\n\"actionId\" : \"1000\" ,\n\"serverUsers\" : 5000 , //新服配置 5000创角\n\"serverId\" : 2, //新服为 2服\n\"newServerNames\" : [\"game2\" ] //游服类型 APP名称为 game\n\"callbackToken\" : \"^6Q%j0kZ74S\" //调用平台回调 API时需要\n}\n2.1.2.2 开服回调 API\n如果开服通知 API返回 200则无需调用该接口。云原生部署平台 9\n•测试环境： https://game-cloud.stg.g123.jp/cp/api/v1/open_server/callback"
    },
    {
        "data": "\"callbackToken\" : \"^6Q%j0kZ74S\" //调用平台回调 API时需要\n}\n2.1.2.2 开服回调 API\n如果开服通知 API返回 200则无需调用该接口。云原生部署平台 9\n•测试环境： https://game-cloud.stg.g123.jp/cp/api/v1/open_server/callback\n•正式环境： https://game-cloud.g123.jp/cp/api/v1/open_server/callback\nRequest\n{\n\"appId\" : string\n\"actionId\" : string //回传平台调用开服通知 API时的 actionId\n\"callbackToken\" : string //回传平台调用开服通知 API时的 callbackToken\n\"success\" : bool //处理成功\n\"message\" : string //处理失败时将原因放在该字段\n}\nResponse\n{\n\"type\" : string\n\"message\" : string\n\"reason\" : string\n}\nHttpStatusCode Type Description\n200 OK\n403 NO_PERMISSION 没有权限\n422 NO_W AITING_ACTION 该开服流程没有使用回调（请查看 开服通知 API在实现时返回的\n200）\n2.2游服合服\n随着游戏上线时间拉长、既存游服的 DAU会逐渐降低、影响游戏内的玩家生态。建议通过监控游服\n数据、做 不定期合服 来提高游戏玩家的活跃度等。\n请参考以下合服流程、提前做好游服相关数据库表 Schema 的设计、方便合并。\n如：游服 1、2、3、4合服的大致流程如下 -数据库：游服 1、2、3的库表合并至 4服的库表\n（策划提供方案、各 CP服务端自行完成） -配置文件 ：1、2、3、4服的相关配置做合并或更新（ CP云原生部署平台 10\n服务端） -客户端：将 1、2、3服导流至 4服服务端（ CP客户端） -游服：删除游服 1、2、3\n的 Pod（CP服务端）\n3.附录\n3.1系统架构图\nG123平台主推基于 Kubernetes 的云原生游戏系统、需要各 CP根据下面的示意图、调整优化\n游戏架构，并进行特定功能的开发。"
    },
    {
        "data": "服务端） -客户端：将 1、2、3服导流至 4服服务端（ CP客户端） -游服：删除游服 1、2、3\n的 Pod（CP服务端）\n3.附录\n3.1系统架构图\nG123平台主推基于 Kubernetes 的云原生游戏系统、需要各 CP根据下面的示意图、调整优化\n游戏架构，并进行特定功能的开发。\n•公网层（红） CDN通过全球边缘节点下载客户端资源至玩家浏览器\n•公网层（红） ALB反向代理游戏服务端所有应用 APP与玩家浏览器通信\n•计算层（绿） ALB通过将工具添加的应用 APP名称做为路径导流至应用（公\n网访问地址）\n•计算层（绿） APP之间的通信走域名（内网访问地址）做内网的服务发现\n•存储层（蓝） DB理论上只能内网访问、公网连接需在工具内配置 IP白名单\n3.2日志与监控\n我们基于 Grafana LGTM 技术栈， 构建了一套可观察方案。 为了“轻”且“快”， 我们采用了 Grafana\nCloud 的全托管式。\n3.2.1 日志查询\n3.2.1.1 基础篇\n1.访问 Grafana Cloud 并通过 Auth0 登录\n•用户名和密码和登录 Publisher 工具是一样的。\n•如果登录后，发现找不到 Explore ，请联系 CTW SRE 。首次登录后，才能赋权。\n2.左边栏选择 Explore\n3.数据源 Data Source 选择对应游戏的 ${game}-logs云原生部署平台 11\n图 1: workflow云原生部署平台 12\n图 2: workflow\n图 3: workflow云原生部署平台 13\n• ￿选择 ${game}-logs\n• ￿选择集群：测试环境的 cluster 是 cpp-stg-k8s ,生产环境的 cluster 是\ncpp-pro-k8s\n• ￿选择自己游戏的 namespace .可以追加 app纬度来过滤出特定 APP\n• ￿可以过滤任意字段\n图 4: workflow\n4.加速查询\n•建议通过选择时间来缩小查询日志的范围。范围越小，查询速度越快。\n•注意时区。默认是浏览器时区。\n5.其他最佳实践\n• ￿可以在自由编辑和辅助编辑模式之间切换\n• ￿可以直接分享你的查询语句、这在调试时非常实用\n• ￿可以查看你的查询历史记录、支持收藏"
    },
    {
        "data": "• ￿可以过滤任意字段\n图 4: workflow\n4.加速查询\n•建议通过选择时间来缩小查询日志的范围。范围越小，查询速度越快。\n•注意时区。默认是浏览器时区。\n5.其他最佳实践\n• ￿可以在自由编辑和辅助编辑模式之间切换\n• ￿可以直接分享你的查询语句、这在调试时非常实用\n• ￿可以查看你的查询历史记录、支持收藏\n• ￿实时 Live模式、类似 tail -f 、日志会实时刷屏、可监控发版情况云原生部署平台 14\n图 5: workflow\n图 6: workflow云原生部署平台 15\n3.2.1.2 进阶篇\n1. F or more advanced usage, please read and learn the LogQL.\n•日志搜索语言是 LogQL ，可以参考 这个链接 去学习完整的用法。\n2.日志可以是结构化的，比如 JSON，也可以是平文。 LogQL 内置了几种分析器，最常用的是\n• json用来分析 JSON 格式日志\n• pattern 用来分析空格分开的日志。例：时间组件文件行号日志内容\n• logfmt 用 来 分 析 logfmt 格 式 （ key=value ） 的 日 志。 例： time=xxxx\ncomponent=xxxx file=xxxx\n• regexp 用来做正则表达式捕捉。\n–注意：这里的正则表达是 Golang RE2 syntax ，不是常用的 Perl文法。\n–注意：正则表达捕捉很慢。\n示例 1\n（1）label是可以做正则匹配的。 （ 2）这里用了 | pattern `<_> <stream> <_>` 来分析\n日志。\n• |是连接符，用来把多个处理串联起来。\n• pattern 指明要用的分析器。\n• ` `用来把分析语言包裹起来， 也可以用双引号“， 但要注意分析语言里面的双引号需要 escape 。\n• <_>每个匹配用 <>包裹起来，下划线 _表明不需要 index 这个捕捉。\n• <_> <stream> <_> 这里的意思是，第一个用空格分离的字段–时间–不要。第二个字短捕\n捉并命名为 stream ，后面所有的字段都不要。\n–注意：这里捕捉成功后，会自动增加一个叫做 stream 的索引。后面可以直接用这个索\n引。\n–这是 LogQL 最强大的地方，运行时动态索引。\n示例 2"
    },
    {
        "data": "• <_>每个匹配用 <>包裹起来，下划线 _表明不需要 index 这个捕捉。\n• <_> <stream> <_> 这里的意思是，第一个用空格分离的字段–时间–不要。第二个字短捕\n捉并命名为 stream ，后面所有的字段都不要。\n–注意：这里捕捉成功后，会自动增加一个叫做 stream 的索引。后面可以直接用这个索\n引。\n–这是 LogQL 最强大的地方，运行时动态索引。\n示例 2\n复杂化上面的示例 1，我们做点无用的复杂来展示一个完整的分析功能。 LogQL 如下：\nsum by (dest) (\ncount_over_time(\n{cluster=\"cpp-stg-k8s\", namespace=\"ginei\", pod_container =~ \"gameserver[0-9]{1,4}\"}云原生部署平台 16\n图 7: workflow\n| pattern `<_> <stream> <_> write message to <dest> fail`\n| __error__ =\"\"\n| stream = \"stderr\"\n[1m])\n)\n• pattern `<_> <stream> <_> write message to <dest> fail` 会\n匹配这样的日志 :\n–2023-02-17T17:55:26.204880125+08:00 stderr F 2023/02/17\n17:55:26 [W] /var/lib/jenkins/workspace/yyz-g123-game/modules/gatenew/gateway.go:69\nwrite message to 100010 fail, not exist 并取出 stderr 和\n100010 部分，分别索引为 stream 和 dest。\n• __error__ =\"\" 用来过滤掉分析器出错的日志。 error 是一个内部变量，用来保存\nLogQL 的执行错误。\n• stream = \"stderr\" 用我们前面分析器里建立的 index 来过滤日志。\n• count_over_time( xxxx [$interval]) 用来计数指定间隔 $internal 内有\n多少条日志命中，这里是 1分钟。云原生部署平台 17\n图 8: workflow"
    },
    {
        "data": "LogQL 的执行错误。\n• stream = \"stderr\" 用我们前面分析器里建立的 index 来过滤日志。\n• count_over_time( xxxx [$interval]) 用来计数指定间隔 $internal 内有\n多少条日志命中，这里是 1分钟。云原生部署平台 17\n图 8: workflow\n• sum by (dest) (xxxx) 用dest来做聚合。因此，上面的 LogQL 用来统计，出现\nwrite message to xxx 这样的错误日志每分钟，每个 dest有多少条。\n3.2.2 监控查询\n3.2.2.1 系统监控\n1.访问 Grafana Cloud 并通过 Auth0 登录\n•用户名和密码和登录 Publisher 工具是一样的。\n•如果登录后，发现找不到 Dashboard ，请联系 CTW SRE 。首次登录后，才能赋权。\n2.左边栏选择 Dashboard 并找到自己的 appid\n•如果大盘有数据或者系统组件监控项缺失，请联系 CTW SRE 。\n3.2.2.2 游服监控 为完整监控各游服的状态或者协助自动开服，请实现以下游服列表 zonelist\nAPI接口供平台调用查询游服状态。\n1. API需要通过公网访问，所以需要认证。认证可以是 API token ，也可以是 bare auth 。\n实现方式可由游戏开发方决定。 API endpoint 中的 key，是用 API token 实现的例子。\n2. healthcheck 的深度由游戏开发方决定。但至少要反应 登录服务 是否健康。因为经常会遇\n到游戏服务器进程和端口健康，但玩家无法登录的情况。云原生部署平台 18\n图 9: workflow\n3. API的字段含义在 {Properties} 小结有描述。\n4. healthcheck 的实现必须是异步，非阻塞的。否则会对游戏造成影响。一个外部监控点，访问\n/healthcheck 的频率为 60秒 /次。但可能会从多点访问，所以 API的 rqs会 >=\n1。\nEndpoint\nURL路径格式可以自主设定\nGET https://${appid}-slb.pro.g123-cpp.com/gs/zonelist\nAuthentication\nUse HTTP header."
    },
    {
        "data": "/healthcheck 的频率为 60秒 /次。但可能会从多点访问，所以 API的 rqs会 >=\n1。\nEndpoint\nURL路径格式可以自主设定\nGET https://${appid}-slb.pro.g123-cpp.com/gs/zonelist\nAuthentication\nUse HTTP header.\nAuthorization: Token configured in publisher\nResponse\nSuccess\nHTTP 200 OK\n{云原生部署平台 19\n\"code\" : 0,\n\"data\" : {\n\"zonelist\" :[\n{\n\"ID\" : 1,\n\"capacity\" : 3974 ,\n\"createrole\" : 3010 ,\n\"online\" : 27 ,\n\"paiduser\" : 57 ,\n\"opentime\" : \"2022-07-16T19:20+09:00\" ,\n\"updatetime\" : \"2022-07-16T19:20+09:00\" ,\n\"path\" :\"/gs0001\" ,\n\"svrname\" : \"s1\" ,\n\"status\" : 0,\n\"url\" :\"https://${appid}-slb.pro.g123-cpp.com/login/zonelogin/1\"\n},\n...\n]\n}\n}\nError\nHTTP 400 Bad Request\n{\n\"code\" : 1,\n\"message\" : \"Error description\"\n}\nProperties\ncode (int) status of the zonelist API itself\n• 0: The API is healthy .\n• 1: There is a failure.云原生部署平台 20\ndata (object) | Parameter | Description | | ———— - |—————————————————————————————————\n–| | zonelist (array) | An array of game zones. | | ID (int) | UID, 游服的唯一标"
    },
    {
        "data": "• 1: There is a failure.云原生部署平台 20\ndata (object) | Parameter | Description | | ———— - |—————————————————————————————————\n–| | zonelist (array) | An array of game zones. | | ID (int) | UID, 游服的唯一标\n识。不可变更。 | | capacity (int) | 游服的创角上限。 | | createrole (int) | 游服的实时创\n角数。 createrole => capacity 意味着满服。务必实现。 | | online (int) | 实时在线玩家数。\n如何判断玩家是否在线，由 CP开发方决定。 | | paiduser (int) | 游服的实时付费数。务必实现。\n| | opentime (string) | 开服时间。时间格式是 YYYY-MM-DDTHH:MM+09:00 。\n| | updatetime (string) | 游服最后一次更新时间。比如合服，开服，维护等。时间格式是\nYYYY-MM-DDTHH:MM+09:00 。| | path (string) | 该游服的路由路径。配置在路\n由规则里的路径。比如 /game1 。| | svrname (string) | 游服表示名。比如 game1 。| |\nstatus (int) | 该游服状态码： - 0：正常 - 101：异常 - 102：维护中 - 201：可开服 - 202：\n导流中（开服完毕） - 301：已合服 - 302：合服中 - 501：特殊游服，比如先锋服，灰度发布服，蓝\n绿发布服等。 | | url (string) | 登录该游服的 URL。|\nmessage (string) error message in response\n3.2.2.3 运行时监控 会提供一些常见编程语言的运行时数据收集方案。\nJava Instrumentation\n我们可以通过 OpenTelemetry 把 Java程序的运行时（ Runtime ）数据收集并发送到\nGrafana Cloud ，从而实现实时分析和监控。\n配置方法"
    },
    {
        "data": "message (string) error message in response\n3.2.2.3 运行时监控 会提供一些常见编程语言的运行时数据收集方案。\nJava Instrumentation\n我们可以通过 OpenTelemetry 把 Java程序的运行时（ Runtime ）数据收集并发送到\nGrafana Cloud ，从而实现实时分析和监控。\n配置方法\n1.在 publisher.g123.jp 里配置程序的环境变量。\n在工具内特定 APP的部署配置页面，添加以下环境变量：\nOTEL_EXPORTER_OTLP_PROTOCOL =http/protobuf\nOTEL_RESOURCE_ATTRIBUTES =service.version= ${ENV} ,service.namespace= ${GAME} ,service.name= ${SVRNAME} ,service.instance.id= $SERVER_ID\nOTEL_EXPORTER_OTLP_ENDPOINT =http://flow-grafana-agent.grafana:4317\nOTEL_SDK_DISABLED =fase\n•替换变量 ${ENV} 为你要配置的环境 ,只能是 staging 或者 production.\n•替换变量 ${GAME} 为你要配置的游戏名 ,比如 yowapeda, transformers, etc.\n•替换变量 ${SVRNAME} 为你要配置的服务名 ,比如 gameserver, login_server or\ncenter云原生部署平台 21\n•例子。在生产环境 production 里，为游戏 transfomrers 的游戏服 gameserver\n配置：\nOTEL_EXPORTER_OTLP_PROTOCOL =http/protobuf\nOTEL_RESOURCE_ATTRIBUTES =service.version=production,service.namespace=transformers,service.name=gameserver,service.instance.id= $SERVER_ID"
    },
    {
        "data": "配置：\nOTEL_EXPORTER_OTLP_PROTOCOL =http/protobuf\nOTEL_RESOURCE_ATTRIBUTES =service.version=production,service.namespace=transformers,service.name=gameserver,service.instance.id= $SERVER_ID\nOTEL_EXPORTER_OTLP_ENDPOINT =http://flow-grafana-agent.grafana:4317\nOTEL_SDK_DISABLED =fase\n2.在 Java程序启动行加载 opentelemetry-java-instrumentation\n•下载最新的 opentelemetry-java-instrumentation.jar 文件。下载链接\n•添加 opentelemetry-java-instrumentation.jar 到程序启动中。\njava -javaagent:path /to/opentelemetry-javaagent.jar \\\n-jar myapp.jar\n比如某游戏，配置 opentelemetry-java-instrumentation 后的实际启动命令\n行如下：\n￿ kubectl exec -it pod/gameserver1-75cbb79f94-r7nfz -- ps ww 1\nPID TTY STAT TIME COMMAND\n1 ? Ssl 3:19 java -javaagent:opentelemetry-javaagent.jar -XX:MaxRAMPercentage=75.0 -jar bszn-game-1.0.jar -DLog4jContextSelector=org.apache.logging.log4j.core.async.AsyncLoggerContextSelector -Djava.ext.dirs=./config/ com.webgame.GameApplication\nPublisherP A YP A Y 红包活动 1\nPayPay 红包活动\n活动时间\n预计在 12月中旬 ~\n活动描述"
    },
    {
        "data": "PublisherP A YP A Y 红包活动 1\nPayPay 红包活动\n活动时间\n预计在 12月中旬 ~\n活动描述\n当用户通过 PayPay 活动入口进入游戏创建角色，并且达到指定级数（ 10级）时，游戏向平台发送\n通知，平台弹出输入邮箱页面，将指定的奖品发送到用户邮箱。\nCP对应流程\n1.当用户达到 10级时 , CP游戏服务器向平台服务器发送事件，平台返回响应消息\n2. CP游戏服务器将收到的响应信息推送至游戏前端 ,前端将该信息通过 win-\ndow.top.postMessage 发送到平台主窗口。\n注:游戏服务器端要确保用户达到指定等级\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp\n此外， 该流程使用登录流程的 appId 和appSecret ， 参见 https://developers.g123.jp/login.html#_1-\n%E7%99%BB%E5%BD%95\n1.1创建事件\nPOST /api/v1/cp/game_event/level_upP A YP A Y 红包活动 2\nRequest Header 使用 Basic认证方式发送 appId 和 appSecret\nRequest header Description\nContent-Type application/json\nAuthorization Basic base64( ‘𝑎𝑝𝑝𝐼 𝑑 ∶ appSecret ’)\nRequest Body\nRequest Body F ormat V alue Required\nuid string 用户游戏唯一标示 id Y es\nserver_id string 用户所在游戏服 id Y es\nctwid string g123 平台生成 id Y es\ntimestamp long 事件发生时间 (UNIX 时间单位 :ms) Y es\nlevel integer 用户级别 Y es\nResponse Body 状态码 : 200消息内容： JSON 格式的返回数据\n注:返回的数据格式可能会在正式版本发布时有所变动，请在 1.2前端事件触发这一步中，将返回数\n据全部通过 postMessage 提交\n示例"
    },
    {
        "data": "timestamp long 事件发生时间 (UNIX 时间单位 :ms) Y es\nlevel integer 用户级别 Y es\nResponse Body 状态码 : 200消息内容： JSON 格式的返回数据\n注:返回的数据格式可能会在正式版本发布时有所变动，请在 1.2前端事件触发这一步中，将返回数\n据全部通过 postMessage 提交\n示例\ncurl -i -X POST \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization:Basic $(echo -n $APP_ID:$APP_SECRET | openssl base64 -A)\" \\\n-d \\\n'{\n\"uid\": \"123\",\n\"server_id\": \"s73\",\n\"ctwid\": \"GIL6T4CO\",\n\"timestamp\": 1605076260715,\n\"level\": 10P A YP A Y 红包活动 3\n}' \\\n'https://h5.stg.g123.jp/api/v1/cp/game_event/level_up'\nOUTPUT:\nHTTP/1.1 200 OK\nvary: accept-encoding\ncontent-type: application/json;charset=UTF-8\ntransfer-encoding: chunked\ndate: Wed, 11 Nov 2020 07:53:51 GMT\nconnection: close\n{\"action\":\"game_event_created\",\"id\":\"1\",\"token\":\"fdda6c9f-5745-4adc-9541-c3827d654dfa\"}\n注:返回的数据格式可能会在正式版本发布时有所变动\n1.2前端事件触发\n将平台服务器的返回的消息，在前端通过 window.top.postMessage 传递到平台\nwindow.top.postMessage(responseData, '*');附加功能（选接） 1\nimport Callout from ‘nextra-theme-docs/callout ’\n附加功能（选接）\n1.获取用户绑定 SNS账号信息"
    },
    {
        "data": "1.2前端事件触发\n将平台服务器的返回的消息，在前端通过 window.top.postMessage 传递到平台\nwindow.top.postMessage(responseData, '*');附加功能（选接） 1\nimport Callout from ‘nextra-theme-docs/callout ’\n附加功能（选接）\n1.获取用户绑定 SNS账号信息\nGET: {API Host}/api/v1/cp/user?code={access_code}&fields=providers\n返回 :\n{\n\"userId\" :\"*******\"\n\"providers\" :[\"FACEBOOK\" ,\"LINE\"]//用户未绑定账号时为空\n}\n监听 SNS账号绑定成功事件\n用户绑定事件发生变化时，平台会通过 postMessage 向游戏 iframe 内发送如下的绑定变化\nevent:\n{\n\"category\" :\"g123_auth_event\" ,\n\"action\" :\"p_sns_bind_changed\"\n}\n游戏内需监听用户绑定 SNS账号事件（如绑定奖励） ，可添加监听器方法。\nwindow.addEventListener (\"message\" ,(e) =>{\nif(\ne&&\ne.data&&\ne.data.category ===\"g123_auth_event\" &&\ne.data.action===\"p_sns_bind_changed\"\n) {附加功能（选接） 2\n//和游戏服务器进行通讯，在服务器上调用 [2.5获取用户绑定 SNS账号信息 ]的接口确认用户最新的绑定账号信息\n}\n});\n2.分享 &邀请 API\n分享 API\n玩家使用场景：玩家在游戏中点击分享按钮，平台打开分享界面，生成分享链接 /game/$appId\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"share\",\n\"data\":{\n\"ctw_line_share_text\" :\"快来领取屠龙宝刀 \",\n\"ctw_twitter_share_text\" :\"快来领取屠龙宝刀 \",//分享的文字中不能带有 #\n\"ctw_copy_text\" :\"快来领取屠龙宝刀 \","
    },
    {
        "data": "window.top.postMessage (JSON.stringify ({\n\"action\" :\"share\",\n\"data\":{\n\"ctw_line_share_text\" :\"快来领取屠龙宝刀 \",\n\"ctw_twitter_share_text\" :\"快来领取屠龙宝刀 \",//分享的文字中不能带有 #\n\"ctw_copy_text\" :\"快来领取屠龙宝刀 \",\n\"ctw_twitter_share_via\" :\"user1\",\n\"ctw_twitter_share_hashtags\" :\"tag1,tag2\" ,\n\"ctw_share_id\" :\"sample_share_id\" ,\n\"ctw_share_extra\" :\"sample_extra\" ,\n}\n}),'*');\n-分享的文案，链接等内容请在对接群中与 PM沟通 -提高获取邀请奖励的门槛，尽量避免用户为了\n得到奖励而刷 CTWID ，具体请与 PM沟通\n参数\nparameter value required?\nctw_line_share_text 分享到 LINE 的文字 Y es\nctw_twitter_share_text 分享到 T witter 文字 Y es\nctw_copy_text 复制到剪贴板的文字 Y es\nctw_twitter_share_via @ 符号后面的参数，分享来自哪位用户 No附加功能（选接） 3\nparameter value required?\nctw_twitter_share_hashtags 有多个 hashtag 时请用英文” ,“号隔开，\n不需要加井号No\nctw_share_id 透传参数，推荐配置发出邀请的玩家的 ID\n等No\nctw_share_extra 透传参数， CP自定义的分享邀请相关的参\n数No\n邀请 API\n使用场景：玩家 A通过上述分享接口发送给玩家 B后，玩家 B通过该链接进入游戏时，平台将上述\nctw_share_id ,ctw_share_extra 参数补在 CP游戏 URL后面，游戏需要处理相应的\n邀请逻辑和奖励机制。\n分享效果截图\n图 1: share\n进入分享界面附加功能（选接） 4\n图 2: share result\n分享结果\n3.刷新页面 API\n重新加载整个页面平台游戏页面"
    },
    {
        "data": "使用场景：玩家 A通过上述分享接口发送给玩家 B后，玩家 B通过该链接进入游戏时，平台将上述\nctw_share_id ,ctw_share_extra 参数补在 CP游戏 URL后面，游戏需要处理相应的\n邀请逻辑和奖励机制。\n分享效果截图\n图 1: share\n进入分享界面附加功能（选接） 4\n图 2: share result\n分享结果\n3.刷新页面 API\n重新加载整个页面平台游戏页面\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"reload\"\n}),'*');\n4.游戏内调起平台登陆 /SNS 绑定界面 API\n玩家在游戏中点击登陆或 SNS绑定按钮，打开平台登陆 /SNS 绑定界面。\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"cp_login\" ,\n\"data\":{\n// or 'sns'附加功能（选接） 5\n\"type\":\"login\"\n}\n}),'*');\n参数\nvalue description required?\nlogin 登陆 Y es\nsns sns 绑定 Y es\n可以结合 获取用户绑定 SNS账号信息 ，只对未绑定的玩家提示查询用户 IM绑定 API 1\n查询用户 IM绑定 API\n文档简介\n本文 API用于查询 G123游戏平台用户是否绑定 IM平台。\n调用地址\n环境 API Host\n测试 https://broadcast-api.stg.g123.jp\n正式 https://broadcast-api.g123.jp\n验证获取\n登记 IP白名单\n在 Publisher 系统的“ G123接入” ->“消息推送”页面底部登记调用服务器的 IP地址。\n获取认证 T oken\n在 Publisher 系统的“ G123接入” ->“消息推送”页面获取 T oken，并将其放入请求头的 Au-\nthorization: Basic {token} 进行认证。\n注意：正式环境和测试环境的 token是不同的\n图 1: publisher-button查询用户 IM绑定 API 2\n请求示例"
    },
    {
        "data": "获取认证 T oken\n在 Publisher 系统的“ G123接入” ->“消息推送”页面获取 T oken，并将其放入请求头的 Au-\nthorization: Basic {token} 进行认证。\n注意：正式环境和测试环境的 token是不同的\n图 1: publisher-button查询用户 IM绑定 API 2\n请求示例\ncurl -X POST \"https://broadcast-api.g123.jp/external/api/v1/cp/users/im-bind\" \\\n-H \"Authorization: Basic {token}\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n\"ctw_ids\": [\"1234567890\", \"1234567891\"]\n}'\n请求头\n> POST /external/api/v1/cp/users/im-bind\n> Content-Type: application/json\n> Authorization ：Basic `{token}`\n请求体\n{\n\"ctw_ids\" :[\"1234567890\" ,\"1234567891\" ]\n}\n字段说明\n字段名 类型 描述 是否必须\nctw_ids array 用户的 CTW ID 列表，一次最多不超过 100个 是\n返回示例\n{\n\"data\" : {\n\"1234567890\" : true ,\n\"1234567891\" : false查询用户 IM绑定 API 3\n}\n}\n字段说明\n字段名 类型 描述\ndata object 用户的绑定信息\nctw_id object 用户的 CTW ID\nctw_id 绑定信息说明\n字段名 描述\ntrue 已绑定\nfalse 未绑定\nhttp code 说明\ncode 描述\n200 成功\n400 请求参数错误\n401 验证失败\n403 IP 验证失败\n429 数量超出限制\n500 服务器错误礼包接口 1\nimport Callout from “nextra-theme-docs/callout ”; import GiftSequenceDia-\ngram from “./assets/new-gift-sequence-diagram.svg ”;\n礼包接口\n时序图"
    },
    {
        "data": "400 请求参数错误\n401 验证失败\n403 IP 验证失败\n429 数量超出限制\n500 服务器错误礼包接口 1\nimport Callout from “nextra-theme-docs/callout ”; import GiftSequenceDia-\ngram from “./assets/new-gift-sequence-diagram.svg ”;\n礼包接口\n时序图\n流程简介\n1.游戏事先将游戏道具资源 API和Popup API 录入Publisher 中，并在 平台礼包系统 中\n确认道具和礼包内容\n2.平台根据游戏用户达到的条件调用游戏提供的 popup API ,并在请求中传入礼包模版 /礼包\nID/用户信息等 参数\n3.游戏根据请求中的 礼包模版 确定给用户的弹出的 弹窗UI\n4.游戏根据请求中的礼包 ID，调用平台的 gift API 获取礼包信息 ,并将信息放入弹窗 UI中\n的相应位置\n5.游戏根据请求中的玩家信息，给指定玩家弹出 2,3步组成的礼包供用户购买或者领取 (免费礼\n包)\n6.用户购买或者领取礼包，付费礼包购买时参考 支付接口\n礼包的测试周期：从平台发起 popup请求开始\n1.配置道具资源 API\nCP在Publisher-G123 接入-礼包中配置道具资源 API，可以手动或者定时触发道具资源同步，\n之后在G123礼包管理系统确认内容。\n1.1 API 验证\n本API通过Basic认证方式，Token 可在Publisher 工具-G123 接入-礼包获取，G123请\n求API时会携带如下验证信息， 请 CP侧进行验证： *Authorization :Basic {Token}礼包接口 2\n1.2道具资源 API说明\n•配置系统：Publisher-G123 接入-礼包\n•调用方法：GET\n•请求方：G123\n•响应方：CP\n•说明：G123平台获取游戏内有效的道具、资源列表\n•校验：验证是否为合法 Token\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 道具列表\ndata\n所有字段必传。\n编\n号 字段名 类型取值\n（例） 描述"
    },
    {
        "data": "•响应方：CP\n•说明：G123平台获取游戏内有效的道具、资源列表\n•校验：验证是否为合法 Token\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 道具列表\ndata\n所有字段必传。\n编\n号 字段名 类型取值\n（例） 描述\n1 itemId string I06000007 游戏内道具/资源ID\n2 name string LOCK\n碎片游戏内道具/资源名称\n3 i18nKey string L_I06000007 道具/资源表示名字的多语言 key\n4 detailI18nKeystring L_I060000071 道具/资源的描述信息的多语言 key\n5 iconUrl string https://ctwbox.g123.jp/?link_id=xxxxx 道具/资源Icon ctw-box link\n6 value float 200 道具原始价格\n7 typeId string 001 物品分类的类别 ID礼包接口 3\n编\n号 字段名 类型取值\n（例） 描述\n8 typeName string 车辆升\n阶道具物品分类的类别名字\n9 isStoreSupported bool true 是否属于配置道具商城\n10 isAiSupportedbool true 是否支持配置 AI礼包(如果道具属于联名道具或\n者需要严格管理投放数量，请传 false)\n11 attributes json object ：\n详见响\n应样例道具/资源附加信息\nattributes\nattributes 运营礼包，道具商城所需支持信息其中 store_category :根据游戏类型设置的\n定制化目录,方便玩家选择所需道具\n编号 字段名 类型 取值（例） 描述\n1storeDisplayPrice int null 默认空值，如果\nis_store_supported=false,\n这里请设置为空值。由平台后期处理\n2storeCategory string “” 道具的贩卖目录 key值,默认设为\n空字符,平台运营根据需要补值 ,取\n值例: charac-\nter_up/character_skill"
    },
    {
        "data": "编号 字段名 类型 取值（例） 描述\n1storeDisplayPrice int null 默认空值，如果\nis_store_supported=false,\n这里请设置为空值。由平台后期处理\n2storeCategory string “” 道具的贩卖目录 key值,默认设为\n空字符,平台运营根据需要补值 ,取\n值例: charac-\nter_up/character_skill\n3setQuantity int 1 道具贩卖的打包的最小单位个数。例\n如:碎片100个才有意义,该值最\n小单位为100\n4purchaseLimit int 0 道具贩卖的个数限制 , 0 = No\nlimit\n5sellMinCp int 100 可供贩卖的最低性价比 ,取值如:\n100, 150, 表示意思: 100%,\n150%礼包接口 4\n编号 字段名 类型 取值（例） 描述\n6sellMaxCp int 500 可供贩卖的最高性价比 ,取值如:\n300, 500, 表示意思: 300%,\n500%\n7rarity string 绿色 道具稀有度，使用颜色表示稀有度：\n灰色/绿色/蓝色/紫色/橙色/红\n色/金色/彩色\n点击查看:请求响应样例\n•请求样例\ncurl https://goodgame.jp/gift/item \\\n-H\"Accept: application/json\" \\\n-H\"Authorization: Basic {Token}\"\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":[\n{\n\"itemId\" :\"11111\",\n\"name\":\"稀有碎片\",\n\"i18nKey\" :\"L_111111\" ,\n\"detailI18nKey\" :\"L_11111111\" ,\n\"iconUrl\" :\"https://ctwbox.g123.jp/cdn/icon/138392\" ,\n\"value\":9999.0,\n\"typeId\" :\"111\",\n\"typeName\" :\"升级素材\",\n\"isStoreSupported\" :true,\n\"isAiSupported\" :false,\n\"attributes\" :{礼包接口 5\n\"storeDisplayPrice\" :9999,"
    },
    {
        "data": "\"value\":9999.0,\n\"typeId\" :\"111\",\n\"typeName\" :\"升级素材\",\n\"isStoreSupported\" :true,\n\"isAiSupported\" :false,\n\"attributes\" :{礼包接口 5\n\"storeDisplayPrice\" :9999,\n\"storeCategory\" :\"character_up\" ,\n\"setQuantity\" :100,\n\"purchaseLimit\" :0,\n\"sellMinCp\" :100,\n\"sellMaxCp\" :500,\n\"rarity\" :\"绿色\",\n}\n}\n]\n}\n1.3 G123 礼包管理系统确认\nG123礼包管理系统入口如下： -测试环境-正式环境-请用平台统一发行的登陆用户名和密码。\n2.配置 Popup API\nCP在Publisher-G123 接入-礼包中配置PopupAPI ， 基于生成的 {API Host}/gift/popup\n实现在游戏内 Popup 礼包功能\n•配置系统：Publisher-G123 接入-礼包\n•调用方法：POST\n•请求方：G123\n•响应方：CP\n•说明：G123平台调用Popup API 推送礼包\n•校验：平台自动配置 IP白名单调用\nRequest\n调用popup API 传递信息参数：礼包接口 6\nParameter Description Type RequiredExample\npopup_id 用于校验使用者是否能够购买该礼\n包，g123生成String Yes 6f9cf1a3-\n3103-\n4f95-\na148-\n0e2e5659d8a5\nctwid 平台用户id,以G开头8位数String Yes G12QWASD\ngame_user_id CP侧记录用户 id String No 1234567\ngame_server_id 游戏服id String Yes s01\nrole.id 用户在游戏服上的 id String Yes 30000077\ngift.id 推送的礼包 id String Yes 50005001\ntemplate_id 礼包弹窗展示模版 id，参考模板定\n义String Yes 1\nResponse\nHTTPCode 返回204即成功。\n用例\n点击查看: Request Body"
    },
    {
        "data": "role.id 用户在游戏服上的 id String Yes 30000077\ngift.id 推送的礼包 id String Yes 50005001\ntemplate_id 礼包弹窗展示模版 id，参考模板定\n义String Yes 1\nResponse\nHTTPCode 返回204即成功。\n用例\n点击查看: Request Body\n{\n\"popup_id\" :\"xxxxxxx\" ,\n\"ctwid\":\"GXXXXXXX\" ,\n\"game_user_id\" :\"1234567\" ,\n\"game_server_id\" :\"s01\",\n\"role\":{\n\"id\":\"xxxxxxx\"\n},\n\"gift\":{\n\"id\":\"xxxxx\"礼包接口 7\n},\n\"template_id\" :\"1\"\n}\n```\n#### Response (Success)\nHTTP Code: 204 No Content\n#### Response (Failed)\nHTTP Code: 417 { “reason ”:“xxxxx”}\n*弹出礼包时用户不在线： Failed response 。下次用户上线时弹出\n</details>\n## 3.调用gift API 获取礼包信息 {#gift-api}\n<Callout>\nPublic API 的文档链接：\n- [测试环境 ](https://gift.stg.g123.jp/api/docs)\n- [正式环境 ](https://gift.g123.jp/api/docs)\n</Callout>\nTarget API\n- Gifts V2 ：获取礼包信息\n###环境参数\n|系统|环境| API Host |\n| ---- | ---- | ---------------------- |礼包接口 8\n|礼包|测试| https://gift.stg.g123.jp |\n|礼包|正式| https://gift.g123.jp |\n### 3获取单个礼包信息\n#### Endpoint\n**GET** `{API Host}/api/v2/gifts/{id}`\n#### Token\n<Callout>"
    },
    {
        "data": "| ---- | ---- | ---------------------- |礼包接口 8\n|礼包|测试| https://gift.stg.g123.jp |\n|礼包|正式| https://gift.g123.jp |\n### 3获取单个礼包信息\n#### Endpoint\n**GET** `{API Host}/api/v2/gifts/{id}`\n#### Token\n<Callout>\n`token` 可在[Publisher 工具-G123接入-礼包](https://publisher.g123.jp/access_tool?tab=giftPackInfo) 获取\n</Callout>\n##### Request\n| Parameter | Description |Type | Required | Example |\n| ------------------------- | --------------------------------------|----------- | ---------- | --------- |\n| `id` |礼包的标识字符串 | String | Yes | string |\n| `token` |礼包的获取认证 token | String | Yes | string |\n| `app_id` |平台定义的 appId（联系平台获取） | String | Yes | vividarmy |\n##### Response {#gift-info}\n| Parameter | Description |Type | Required | Example |\n| ------------------------- | --------------------------------------|----------- | ---------- | --------- |\n| `id` |礼包的标识字符串 | String | Yes | string |\n| `vipPoints` |购买礼包后可获得的 vip点数，用于游戏内累充 | Integer | Yes | 0 |\n| `amountToDiamond` |此礼包付费但是购买失败后给玩家补单的钻石数量 | Integer | No | 0 |"
    },
    {
        "data": "| `id` |礼包的标识字符串 | String | Yes | string |\n| `vipPoints` |购买礼包后可获得的 vip点数，用于游戏内累充 | Integer | Yes | 0 |\n| `amountToDiamond` |此礼包付费但是购买失败后给玩家补单的钻石数量 | Integer | No | 0 |\n| `price` |礼包的定价 | Integer | Yes | 0 |\n| `priceValueRatio` |礼包性价比 | Integer | No | 0 |\n| `duration` |弹出时长 （秒） | Integer | No | 0 |\n| `purchaseLimitAmount` |礼包限购数量 | Integer | No | 0 |\n| `isAISupported` |是否支持 AI | Bool, true or false | Yes | true |\n| `items` |礼包内包含的物品 \\{item id: item quantity, item id: item quantity\\} | Dict | Yes | \\{ <br />\"4\": 1880, <br />\"11019\": 30, <br />\"80613\": 1\\} |\n| `platformCreative` |背景图片 enabled: true/false (exist then true else false) | Dict | No | \\{<br />\"enabled\": true,\"background\": \"https://platform-ik.stg.g123.jp/auxin/gift-creative/queensblade/banner_BG01_007.png?tr=f-webp\"<br />\\} <br /> 或者<br /> \\{<br />\"enabled\": false <br />}礼包接口 9\n####用例\n<details>\n<summary> 点击查看 : Request Example</summary>\n```bash\ncurl -X 'GET' \\"
    },
    {
        "data": "####用例\n<details>\n<summary> 点击查看 : Request Example</summary>\n```bash\ncurl -X 'GET' \\\n'https://gift.stg.g123.jp/api/v1/gifts/50005003?app_id=tenseikenja' \\\n-H 'accept: application/json' \\\n-H 'Authorization: Bearer JWT'\n点击查看: Response Example\n{\n\"id\":\"50005003\" ,\n\"vipPoints\" :1280,\n\"amountToDiamond\" :1280,\n\"price\":1280,\n\"priceValueRatio\" :1000,\n\"duration\" :86400,\n\"purchaseLimitAmount\" :1,\n\"isAISupported\" : true,\n\"platformCreative\" :{\n\"enabled\" :true,\n\"background\" :\"https://ctwbox-static.stg.g123.jp/preview/4e9c2ca44ccbbcf06000ec13c56a4a48a100742df9cf639f85b04d6a.png\"\n},\n\"items\":{\n\"4\":1880,\n\"11019\":30,\n\"80613\":1}\n}礼包接口 10\n4.礼包弹窗展示需求\n根据平台调用 popup API 时传入的template_id ，展示相应的 礼包UI给游戏内用户\n4.1模版 ID定义\ntemplate_id Description Example Use Cases\n1~99 普通礼包 1 玩家定制礼包，关键章节事件驱\n动礼包，推荐礼包，爆弹礼包，\n等级礼包等\n100~199 补偿礼包 100 免费领取。向玩家表达歉意的补\n偿（维护，系统 bug等影响玩\n家体验时） ，对玩家反馈的谢礼\n等\n200~299 商城礼包 200 用户在平台商城购买道具成功\n后，平台调用游戏内弹窗发放的\n“免费”礼包\n4.2普通礼包（付费礼包）详细需求\n模板 UI示例\n礼包接口 11\n详细需求 普通礼包展示元素 -￿背景 UI：由PM和游戏设计决定，不同的 template_id 可用"
    },
    {
        "data": "偿（维护，系统 bug等影响玩\n家体验时） ，对玩家反馈的谢礼\n等\n200~299 商城礼包 200 用户在平台商城购买道具成功\n后，平台调用游戏内弹窗发放的\n“免费”礼包\n4.2普通礼包（付费礼包）详细需求\n模板 UI示例\n礼包接口 11\n详细需求 普通礼包展示元素 -￿背景 UI：由PM和游戏设计决定，不同的 template_id 可用\n不同的背景 UI供平台调用 -￿道具展示： 最大可支持 5种道具-￿价格 /性价比 /倒计时： 价格作\n为按钮，性价比展示礼包的折扣信息，倒计时一般设置为 86400 秒-￿多个礼包 T ab：用户在某个\nsession 中可能会弹多个礼包，游戏内设置的礼包入口再进入后，通过 Tab切换礼包\n弹出逻辑-平台发送popup 请求时，弹出。例外情况：用户不在线 (下次登录弹出 )，游戏场景不适\n合弹出（延后弹出） 。 -礼包内容有错时不弹出。 -礼包入口 ：礼包弹出后，用户未购买时，提供入口方\n便后继购买；购买后或者礼包过期后关闭入口。 -未购买且未失效的礼包只对用户弹一次，同一礼包 ID\n用户已购买或者已失效的情况下允许再次被调用后弹出。例外情况：平台主动发起 popup 弹出请求。\n打点需求-请在以下事件 g_payrequest, g_payend 以及psp中提供准确的礼包 id，以方便\n数据追踪-创建PSP订单时，请将item.name 名请传（お得ギフト /特惠禮包/Value Pack\n/\u0000\u0000\u0000\u0000）, item.id 请传礼包id\n4.3补偿 /商城礼包详细需求\n模板 UI\n详细需求|礼包类型|补偿礼包|商城礼包| |————-|————–|——-| |模版ID | 100 |\n200 | | 支付接口|无|无| |背景UI |下载链接|下载链接| |道具展示|道具数量不设限制\n(至少支持50个)，通过左右滑动进行浏览 |同左| |领取按钮|支持点击弹窗的任何地方均可领取。\n|同左| |多个礼包Tab |通过Tab切换礼包|同左| |游戏内入口 |无|无| |弹出逻辑|平\n台发送popup 请求时弹出。用户不在线，下次登录后弹出，有效时间 24小时。|平台发送popup\n请求时弹出。用户未领取时，下次登录时弹出。 | |累充统计|无|根据礼包信息 中vipPoints 的值\n计入游戏内的累充活动 |礼包接口 12"
    },
    {
        "data": "|同左| |多个礼包Tab |通过Tab切换礼包|同左| |游戏内入口 |无|无| |弹出逻辑|平\n台发送popup 请求时弹出。用户不在线，下次登录后弹出，有效时间 24小时。|平台发送popup\n请求时弹出。用户未领取时，下次登录时弹出。 | |累充统计|无|根据礼包信息 中vipPoints 的值\n计入游戏内的累充活动 |礼包接口 12\n注意事项-商城礼包未领取或是未失效的情况下，不能重复弹出。 -商城礼包已领取或是已失效的情况\n下，平台再次调用 Popup API 可弹出该礼包 -安全防范层面，平台配置 IP白名单调用 Popup\nAPI消息推送 API 1\n消息推送 API\n文档简介\n本 API用于向 G123游戏平台用户发送定制消息，支持文字、图片、视频等多种消息类型。适用于\n推送通知、提醒、活动信息等场景。\n核心功能\n•多消息类型支持： 支持文字、图片、视频等多种消息类型的推送。\n•高效的消息发送： 支持一次性发送多条消息，且每条消息均可定制化。\n通过阅读本 API文档，您将了解如何正确地使用消息推送 API，包括请求格式、参数说明、返回值\n等详细信息。\n注意：用户收关 IM通知的功能需要各游戏增加到控制面板上\n调用地址\n环境 API Host\n测试 https://broadcast-api.stg.g123.jp\n正式 https://broadcast-api.g123.jp\n验证获取\n登记 IP白名单\n在 Publisher 系统的“ G123接入” ->“消息推送”页面底部登记调用服务器的 IP地址。消息推送 API 2\n获取认证 T oken\n在 Publisher 系统的“ G123接入” ->“消息推送”页面获取 T oken，并将其放入请求头的 Au-\nthorization: Basic {token} 进行认证。\n注意：正式环境和测试环境的 token是不同的\n图 1: publisher-button\nx-idempotency-key\n用 uuid，防止重试时给用户不停发重复消息，确保幂等性\n消息推送\n请求示例\ncurl -X POST \\\nhttps://broadcast-api.g123.jp/external/api/v1/cp/messages/push \\"
    },
    {
        "data": "注意：正式环境和测试环境的 token是不同的\n图 1: publisher-button\nx-idempotency-key\n用 uuid，防止重试时给用户不停发重复消息，确保幂等性\n消息推送\n请求示例\ncurl -X POST \\\nhttps://broadcast-api.g123.jp/external/api/v1/cp/messages/push \\\n-H 'Authorization: Basic {token}' \\\n-H 'x-idempotency-key: {uuid}' \\\n-H 'Content-Type: application/json' \\\n-d '{\n\"app_id\": \"gamedemo\",\n\"user_list\": [\n{\n\"ctw_id\": \"G1XS9999\",\n\"external_user_id\": \"123456789\"\n},\n{\n\"ctw_id\": \"G1XS9998\",消息推送 API 3\n\"external_user_id\": \"123456788\"\n},\n{\n\"ctw_id\": \"G1XS9997\",\n\"external_user_id\": \"123456787\"\n}\n],\n\"event\": \"test\",\n\"language\": \"zh-CN\",\n\"messages\": [\n{\n\"content\": \"hello world\",\n\"content_type\": \"text\"\n}\n]\n}'\n请求头\n> POST /external/api/v1/cp/messages/push HTTP/1.1\n> Content-Type: application/json\n> x-idempotency-key `{uuid}`\n> Authorization ：Basic `{token}`\n请求体\n{\n\"app_id\": \"gamedemo\",\n\"user_list\": [\n{\n\"ctw_id\": \"G1XS9999\",\n\"external_user_id\": \"123456789\"\n}\n],消息推送 API 4\n\"event\": \"test\",\n\"language\": \"zh-CN\",\n\"messages\": [\n{\n\"content\": \"hello world\",\n\"content_type\": \"text\"\n}"
    },
    {
        "data": "\"user_list\": [\n{\n\"ctw_id\": \"G1XS9999\",\n\"external_user_id\": \"123456789\"\n}\n],消息推送 API 4\n\"event\": \"test\",\n\"language\": \"zh-CN\",\n\"messages\": [\n{\n\"content\": \"hello world\",\n\"content_type\": \"text\"\n}\n]\n}\n字段说明\n字段名 类型 描述 是否必须\napp_id string 应用 id 是\nuser_list array 用户信息列表，批量发\n送一次最多 100个用\n户，超过了接口会返回\n对应的 http code\n错误码是\nevent string 事件名称，记录游戏是\n在什么事件上发的\npush否\nlanguage string 语言，如： zh-CN 否\nmessages array 推送的消息列表，一次\n最多推送 3条，超过\n了接口会返回对应的\nhttp code 错误码是\nuser_list 字段说明消息推送 API 5\n字段名 类型 描述 是否必须\nctw_id string g123 平台发行的用户唯一 id是\nexternal_user_id string CP 那边的用户唯一 id 否\nmessages 字段说明\n字段名 类型 描述 是否必须\ncontent string 消息内容 是\ncontent_type string 消息类型，目前支持 text、image、video 是\nlanguage 字段说明\n语言代码 语言名称\nja 日语\nen 英语\nzh-TW 繁体中文\nes 西班牙语\nfr 法语\nde 德语\nko 韩语\nit 意大利语\nid 印度尼西亚语\npt 葡萄牙语\ntl 菲律宾语\nvi 越南语\nnl 荷兰语\n返回示例\n{消息推送 API 6\n\"message\": \"ok\"\n}\n字段说明\n字段名 类型 描述\nhttp code int 返回码， 200表示为成功，其他为失败\nmessage string 返回信息\nhttp code 说明\ncode 描述\n200 成功\n400 请求参数错误\n401 验证失败\n403 IP 验证失败\n409 uuid 重复，频率超出限制\n413 文件大小超出限制\n429 messages 数量超出限制\n500 服务器错误"
    },
    {
        "data": "}\n字段说明\n字段名 类型 描述\nhttp code int 返回码， 200表示为成功，其他为失败\nmessage string 返回信息\nhttp code 说明\ncode 描述\n200 成功\n400 请求参数错误\n401 验证失败\n403 IP 验证失败\n409 uuid 重复，频率超出限制\n413 文件大小超出限制\n429 messages 数量超出限制\n500 服务器错误\nmessages 推送消息示例\n当前支持的推送消息类型有： text、image、video，分别对应消息类型为：“ text”,“image”,\n“video”\n推送文字\n文字长度限制为 1000字符消息推送 API 7\n{\n\"content\": \"hello world\",\n\"content_type\": \"text\"\n}\n推送图片\n支持的图片类型有 png、jpg、jpeg、gif文件大小限制为 5MB，超过 5MB会返回对应的 http\ncode错误码\n{\n\"content\": \"https://example.com/image.png\",\n\"content_type\": \"image\"\n}\n推送视频\n支持的视频类型有 mp4、mov文件大小限制为 50MB，超过 50MB 会返回对应的 http code\n错误码\n{\n\"content\": \"https://example.com/video.mp4\",\n\"content_type\": \"video\"\n}\n组合发送消息\n组合发送消息，一次最多推送 3条，超过 3条会返回对应的 http code 错误码。 “‘ {“mes-\nsages”: [ {“content ”:“hello world ”,“content_type ”:“text”}, {“content ”\n:“https://example.com/image.png ”,“content_type ”:“image”}, {“content ”\n:“https://example.com/video.mp4 ”,“content_type ”:“video”} ] }1.翻译接口 1\nimport Callout from “nextra-theme-docs/callout ”;\n1.翻译接口\n编号 平台接口 /文档 说明\n1接口 -上传中文原文 后端必接"
    },
    {
        "data": ":“https://example.com/video.mp4 ”,“content_type ”:“video”} ] }1.翻译接口 1\nimport Callout from “nextra-theme-docs/callout ”;\n1.翻译接口\n编号 平台接口 /文档 说明\n1接口 -上传中文原文 后端必接\n1.1整体流程\n图 1: translation workflow\n1.1.1 业务流程 游戏源码需要适配 i18n(internationalization) 、分离出文本内容。\n1.1.2 接入步骤1.翻译接口 2\n1.提供字体（可选） ，如欲使用专有字体，请先将字体提供给 G123开发人员。若无需求可忽略此\n步骤。\n2.上传中文原文 ，通过 CP用翻译工具 UI上传，或调用 上传中文原文接口 ，CP将需要翻译的\n内容发给 G123平台，进行翻译。\nCP用翻译工具的用户名和密码请联系平台获取。\n同一文件内容如果有变化可以多次上传，但文件名请保持保持一致。平台翻译工具以 文件名 /key做\n为该词条在系统内的唯一 ID。强烈建议使用有意义的文档名，例如： weapen.json ，item.json\n等。\n图 2: translation workflow\n3.查看翻译任务 ，上传成功后，可以在 CP用翻译工具 任务界面查看任务。\n4.点击请求翻译 ，确认该翻译任务文本无误后，点击【请求翻译】 、设定翻译语言后，确认发送。\n5.等待接收提醒 ，当翻译任务完成时，钉钉群会发送通知信息。\n6.下载翻译文本 ，平台推送过的翻译文本可随时在 CP用翻译工具 的文本总览界面，或者各任务的\n详情界面里下载。\n目录结构解释\n/版本号 /g123/i18n/ 语言 /1.翻译接口 3\n---fonts/\n---texts/\n1.2接口—上传中文原文\n请求方式\n请求方： CP，响应方： G123\n正式环境【 POST】https://api.g123.jp/api/cp/v1/text-file/{appId}\ncurl -X 'POST' \\\n'https://api.stg.g123.jp/api/cp/v1/text-file/{appId}' \\\n-H 'accept: application/json' \\"
    },
    {
        "data": "1.2接口—上传中文原文\n请求方式\n请求方： CP，响应方： G123\n正式环境【 POST】https://api.g123.jp/api/cp/v1/text-file/{appId}\ncurl -X 'POST' \\\n'https://api.stg.g123.jp/api/cp/v1/text-file/{appId}' \\\n-H 'accept: application/json' \\\n-H 'Authorization: AUTHORIZATION_TOKEN' \\\n-H 'Content-Type: multipart/form-data' \\\n-F 'file=@file_path.json;type=application/json'\n入参说明 Request\nheader 参数\n字段名称 字段类型说\n明是否必\n传 备注\nContent-\nTypemultipart/form-\ndataY es\nAuthorization string Y es 在 Publisher 后台获取 AUTHO-\nRIZA TION_TOKEN\nquery 参数（占位符）\n字段名称 字段类型 说明 是否必传 备注\nappId string Y es appId ，联系平台获取\nbody参数1.翻译接口 4\n字段名称 字段类型 说明 是否必传 备注\nfile Y es 文件的格式，参考下面 json格式要求\njson格式要求\n• Key-V alue 要求 :\n–单层非嵌套\n–中文原文\n–字符串类型 (123 -> “123”)\n•文件名要求 :\n–Key的命名不要加语言 code后缀。\n–请用英数字加下划线的组合（例： sourcelang_g123_1 ）\n•单个文件大小 :小于 2.0MB\njson文件格式示例\n{\n\"menu_aution_01\" : \"个人拍卖 \",\n\"menu_boss_01\" : \"狩猎领主 \",\n\"menu_boss_02\" : \"狩猎领主 \",\n\"menu_shot_box_01\" : \"狩猎宝箱 \",\n\"menu_shop_box_02\" : \"狩猎宝箱 \",\n\"menu_battle_union_01\" :\"公会战 \",\n\"menu_battle_personal_02\" :\"个人战 \","
    },
    {
        "data": "\"menu_boss_01\" : \"狩猎领主 \",\n\"menu_boss_02\" : \"狩猎领主 \",\n\"menu_shot_box_01\" : \"狩猎宝箱 \",\n\"menu_shop_box_02\" : \"狩猎宝箱 \",\n\"menu_battle_union_01\" :\"公会战 \",\n\"menu_battle_personal_02\" :\"个人战 \",\n\"menu_union_01\" : \"公会争霸 \",\n\"menu_union_o2\" : \"公会争霸 \",\n\"menu_mine_light_01\" :\"光源矿脉 \",\n\"menu_mine_light_02\" :\"光源矿脉 \"\n}\n1.3多语言资源 CDN\n加速游戏开发与发版过程、减少人为因素影响等。1.翻译接口 5\n1.3.1 机制平台将翻译完成的多语言资源、自动同步到游戏客户端的 S3桶的特定版本路径 下、玩\n家最长 5分钟后（或立即刷新游戏界面）即可看到最新的多语言资源内容。需要游戏客户端支持动态加\n载资源。 参考游戏\n1.3.2 范围翻译工具支持的资源类型： -多语言文本： json命名一致路径区分语言。 -多语言字\n体：使用全量多语言文本做压缩优化。\n变量取值 -{environment} : staging | production -{env} : stg\n| pro\n图 3: workflow\n1.3.3 流程 文本\n• CP上传需要翻译的中文内容\n–翻译工具内每个语言的文本不做版本区分、每次翻译任务的推送、都会直接反馈到各语言\n文本上。\n•平台翻译完成 T ask里的所有语言\n•平台翻译人员点击“同期至测试环境”所有语言文本同步到游戏客户端（ S3）\n–支持平台翻译人员触发测试版（提前正式版一个版本）更新。\n–正式环境的发版仍然由 CP方控制。\n∗正式环境客户端创建新版本时（只能选择测试环境的未发布版本） 、后台自动从测试\n环境 g123文件夹同步文本资源。\n∗后台文本资源同步完成前、 Publisher 客户端发版功能不可用。 （速度很快、基本\n无感）\n–支持平台翻译人员触发线上版的更新、实时修复线上翻译问题。1.翻译接口 6\n• S3的上传路径如下、各语言的文件名称一致。（即 CP方推送来的中文文本的文件名）"
    },
    {
        "data": "∗正式环境客户端创建新版本时（只能选择测试环境的未发布版本） 、后台自动从测试\n环境 g123文件夹同步文本资源。\n∗后台文本资源同步完成前、 Publisher 客户端发版功能不可用。 （速度很快、基本\n无感）\n–支持平台翻译人员触发线上版的更新、实时修复线上翻译问题。1.翻译接口 6\n• S3的上传路径如下、各语言的文件名称一致。（即 CP方推送来的中文文本的文件名）\ns3://staging-legolas-gamedemo-statics/1.0.0/g123/i18n/en/texts/en.json\ns3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/en/texts/{filename}.json\ns3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/ja/texts/{filename}.json\ns3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/ko/texts/{filename}.json\ns3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/zh-TW/texts/{filename}.json\n•客户端内请使用相对路径访问特定资源 g123/i18n/en/texts/en.json\n• H5入口切到版本 {ver} 后、 以上资源对应的公网链接如下 https://gamedemo.stg.g123-cpp.com/{ver}/g123/i18n/en/texts/en.json\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/en/texts/{filename}.json\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/ja/texts/{filename}.json\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/ko/texts/{filename}.json"
    },
    {
        "data": "https://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/ja/texts/{filename}.json\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/ko/texts/{filename}.json\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/zh-TW/texts/{filename}.json\n•建议游戏客户端支持 gz文件解压、加速资源下载。\n字体\n后台自动化压缩、无需人工介入与 Review 。\n•时机：工具内触发上传语言文本资源至游戏客户端 S3桶内时。\n•行为：使用该语言文本对大字体文件进行压缩（去掉不使用文本的字体） 、并上传压缩后的字体资\n源至客户端 S3桶。\n•版本：跟随文本资源的版本。\n• S3的上传路径如下、 各语言的文件名一致。 （即 CP上传的字体文件名。 若使用平台提供字体、 请\n在翻译工具内选择、 文件名统一为： fonts.ttf ）s3://staging-legolas-gamedemo-statics/1.0.0/g123/i18n/en/fonts/en.ttf\ns3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/en/fonts/{filename}.ttf\ns3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/ja/fonts/{filename}.ttf\ns3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/ko/fonts/{filename}.ttf\ns3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/zh-TW/fonts/{filename}.ttf\n•客户端内请使用相对路径访问特定资源 g123/i18n/en/fonts/en.ttf"
    },
    {
        "data": "s3://{environment}-legolas-{appid}-statics/{ver}/g123/i18n/zh-TW/fonts/{filename}.ttf\n•客户端内请使用相对路径访问特定资源 g123/i18n/en/fonts/en.ttf\n• H5入口切到版本 {ver} 后、 以上资源对应的公网链接如下 https://gamedemo.stg.g123-cpp.com/{ver}/g123/i18n/en/fonts/en.ttf\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/en/fonts/{filename}.ttf1.翻译接口 7\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/ja/fonts/{filename}.ttf\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/ko/fonts/{filename}.ttf\nhttps://{appid}.{env}.g123-cpp.com/{ver}/g123/i18n/zh-TW/fonts/{filename}.ttf\n•聊天对话，玩家名称等请用系统默认字体，不要使用翻译同步过来的字体，避免出现字体缺失导\n致的样式问题。\n注\n图 4: workflow\n1.4翻译工具可供下载的 Language\n根据游戏各语言的翻译进度，必要时请和游戏 PM确认。 |语言 |Language| | —- |——– | |日\n语| ja | | 英语 | en | | 繁体中文 | zh-TW | | 西班牙语 | es | | 法语 | fr | | 德语 | de | |\n韩语 | ko | | 意大利语 | it | | 印度尼西亚语 | id | | 葡萄牙语 | pt | | 菲律宾语 | tl | | 越南语\n| vi | | 荷兰语 | nl |\n注:平台会根据市场情况酌情新增语言支持，语言参数采用的标准为： ISO 639-1活动 1\nimport Callout from “nextra-theme-docs/callout ”;\n活动"
    },
    {
        "data": "韩语 | ko | | 意大利语 | it | | 印度尼西亚语 | id | | 葡萄牙语 | pt | | 菲律宾语 | tl | | 越南语\n| vi | | 荷兰语 | nl |\n注:平台会根据市场情况酌情新增语言支持，语言参数采用的标准为： ISO 639-1活动 1\nimport Callout from “nextra-theme-docs/callout ”;\n活动\n游戏本地化运营数据支持 ,分析运营活动的礼包销量。 CP提供平台指定的活动数据格式，可通过以下\n两种方式上传： -Publisher 界面-接入平台API\n上传时机\n•新的活动数据更新时\n•新礼包上线\n• 9AM JST 之前，自动上传\n文件内容\n游戏内所有涉及玩家付费的内容，例： 1.钻石/点券充值2.月卡/无限卡3.首充礼包/每日礼包4.\n通行证/战令5.活动礼包/限时礼包\n文件结构与命名规范\n•文件格式：csv\n•涵盖三类文件：活动信息、礼包信息和道具信息\n活动信息\n•命名： event_meta_{ “YYYYMMDD ”}.csv活动 2\ncolumns format required desc\ncategory string Yes 活动分类，\n集结活动\n数据进行\n效果分析\n用。标记：\n优先在列\n表中选择，\n如需新增\n请自行添\n加\nevent_type string Yes 活动类型\n（主题，日\n常等）例：\n节日礼包\nevent_id string Yes 活动id\n（dis-\ntinct\nkey）表\n内必须唯\n一\nstart_time string(YYYY-MM-DD) Yes 活动起始\n时间*常\n驻活动等\n请填写\n1900-01-\n01\nend_time string(YYYY-MM-DD) Yes 活动结束\n时间*常\n驻活动等\n请填写\n2100-01-\n01活动 3\ncolumns format required desc\nevent_subject string Yes 游戏中展\n示的活动\n标题\ndays string Yes 持续天数\ntheme_type string Yes 主题框架，\n指活动是\n否按照某\n可复用框\n架来设计\n例：7日\n活动若无，\n则默认值\n0\ntheme_id string Yes 主题框架\nID若无，\n则填默认\n值0"
    },
    {
        "data": "01活动 3\ncolumns format required desc\nevent_subject string Yes 游戏中展\n示的活动\n标题\ndays string Yes 持续天数\ntheme_type string Yes 主题框架，\n指活动是\n否按照某\n可复用框\n架来设计\n例：7日\n活动若无，\n则默认值\n0\ntheme_id string Yes 主题框架\nID若无，\n则填默认\n值0\nposition_id string Yes 排序ID，\n指活动资\n源位优先\n级排序若\n无，则默认\n值0\nnotes string Yes 活动主要\n投放物品\n例：英雄\n名，皮肤\n名，稀有道\n具名等\ncategory 列表活动 4\ncategory desc sample\n特权·基金·战令·周卡 月卡、通行证等 月卡、永久卡、剧情战令\n主题活动 每月主题活动 情人节活动、夏日活动\n货币充值 游戏内充值货币的购买 6元钻石、648元水晶\n新人活动 游戏前期超高性价比礼包 1元礼包、破冰礼包、 10元限购礼\n包\n常驻活动 周期性更新或不限购的常驻礼包 每日礼包、基础经验礼包\n限时活动 普通限时活动 限定英雄碎片礼包\nVIP活动 针对推送给不同消费档的礼包活\n动限定英雄碎片礼包\n礼包信息\n•命名： event_gift_{ “YYYYMMDD ”}.csv\ncolumns format required desc\nevent_id string Yes 活动ID,对\n应活动信息 中\n的\nevent_id\ngift_id string Yes 礼包ID*\n需和支付中的\n商品代码\nitem.code\n保持一致\ngift_name string Yes 礼包名称\nprice string Yes 价格\ncurrency string Yes 币种活动 5\n道具信息\n•命名： gift_pack_{ “YYYYMMDD ”}.csv\ncolumns format required desc\ngift_id string Yes 礼包ID,\n对应礼包\n信息中的\ngift_id\ngift_name string Yes 礼包名称,\n对应礼包\n信息中的\ngift_name\nitem_id string Yes 物品ID\nitem_name string Yes 物品名称"
    },
    {
        "data": "columns format required desc\ngift_id string Yes 礼包ID,\n对应礼包\n信息中的\ngift_id\ngift_name string Yes 礼包名称,\n对应礼包\n信息中的\ngift_name\nitem_id string Yes 物品ID\nitem_name string Yes 物品名称\nquantity string Yes 物品数量\n文件关联说明\n•活动与礼包关联： 活动信息 文件中的 event_id 与礼包信息 文件中的 event_id 相匹配，\n表明该礼包属于特定活动。\n•礼包与道具关联： 礼包信息 文件中的 gift_id 与道具信息 文件中的 gift_id 相匹配，用\n于识别礼包包含的具体道具。\n参考：自动化上传\n•脚本自动化，请使用我们提供的 AP批量上传活动文件：\nPUT https://access-tool.g123.jp/cp/api/v1/games/{appId}/activity\nCP验证\n• Authorization :Basic {Token}活动 6\n•其中 Token 在Publisher 获取\n请求参数 JSON\nrequest\n字段 类型 必传 描述\ndata [activity] true 活动数据列表\nvalidContent bool false 是否校验活动数据内容\nactivity\n字段 类型 必传 描述\nname string true 活动数据文件名\ncontent [byte] true 活动数据二进制\n返回参数 JSON\nresponse\n字段 类型 描述\nresult [activityResult] 每个活动数据的上传结果\nactivityResult\n字段 类型 描述\nsuccess bool 是否上传成功\nerrorType string 错误类型代码\nmessage string 错误描述\npayload [string] 错误描述关键值活动 7\n•Request Example\n点击查看: Request Example\njson curl -X 'PUT' \\ 'https://access-tool.stg.g123.jp/cp/api/v1/games/testapp/activity'"
    },
    {
        "data": "errorType string 错误类型代码\nmessage string 错误描述\npayload [string] 错误描述关键值活动 7\n•Request Example\n点击查看: Request Example\njson curl -X 'PUT' \\ 'https://access-tool.stg.g123.jp/cp/api/v1/games/testapp/activity'\n\\ -H 'accept: application/json' \\ -H\n'Authorization: Basic {Token}' \\ -H 'Content-Type:\napplication/json' \\ -d '{ \"data\": ["
    },
    {
        "data": "\\ -H 'accept: application/json' \\ -H\n'Authorization: Basic {Token}' \\ -H 'Content-Type:\napplication/json' \\ -d '{ \"data\": [\n{ \"content\": [101,118,101,110,116,95,105,100,44,101,118,101,110,116,95,116,121,112,101,44,115,116,97,114,116,95,116,105,109,101,44,101,110,100,95,116,105,109,101,44,100,97,121,115,44,101,118,101,110,116,95,115,117,98,106,101,99,116,44,116,104,101,109,101,95,116,121,112,101,44,116,104,101,109,101,95,105,100,44,112,111,115,105,116,105,111,110,95,105,100,44,110,111,116,101,115,10,52,49,50,49,44,229,145,168,228,184,137,45,229,133,145,230,141,162,229,149,134,229,186,151,44,50,48,50,51,45,48,56,45,48,50,32,48,48,58,48,48,58,48,48,44,50,48,50,51,45,48,56,45,49,48,32,48,48,58,48,48,58,48,48,44,56,44,55,46,48,53,228,184,187,233,162,152,230,180,187,229,138,168,44,109,103,99,100,100,122,115,110,122,116,104,100,50,51,95,48,56,95,48,50,48,49,44,52,49,50,56,44,52,44,231,167,152,229,174,157,10],\n\"name\": \"event_meta_20230823.csv\" } ],\n\"validContent\": true }'\n•Response Example"
    },
    {
        "data": "\"name\": \"event_meta_20230823.csv\" } ],\n\"validContent\": true }'\n•Response Example\n点击查看: Response Example\njson [ { \"success\": true,\n\"errorType\": \"\", \"message\": \"\", \"payload\":\n[] } ]8.数据属性 1\n8.数据属性\n基础属性\n游戏服\n游戏服开服时间，以及合服信息\ncolumns format value required desc\nid string 原游戏服id Yes\nbegin_time unix time int(10) 开服时间 Yes\nstate integer 是否合服，0：没有，\n1:合服Yes\nworld_id string 合服后id Yes\n道具\n道具的meta配置表。\n请按照各游戏即有的配置表直接同步过来\n例：异世界配置表\ncolumns format （default ）value required （default ）\nid 物品ID\ntime 生效时间\nautoUse 进包自动使用\nmagic 使用魔法属性\npar 使用魔法属性\n参数\nquality 品质\nname 物品名称\ndesc 物品描述8.数据属性 2\ncolumns format （default ）value required （default ）\ndesc1 物品来源\ntype 类型\ntypeTwo 子类型\ncanUse 能否使用\npanelId 使用弹出面板\ncomposeNeed 合成所需数量\nhuodongId 所属活动\nindex 排序\nredpoint 是否显示红点\nrepetItem 重复获得\nhero 武将ID\ncomposeNeed2 兑换所需数量\ntab 合成页签\n礼包\n礼包配置表，按各游戏的礼包配置表直接同步信息\n例：异世界礼包配置表\ncolumns value\npid 平台id\nzoneid 手机系统类型\ngoodsId 商品id\ngoodsId1 商品编号\ngold 充值金额日元\nyuanbao 充值元宝\nvipExp 获得VIP经验\nname 商品名称\ndesc 商品描述\ngiftcost1 价值18.数据属性 3\ncolumns value\ngiftcost2 价值2"
    },
    {
        "data": "例：异世界礼包配置表\ncolumns value\npid 平台id\nzoneid 手机系统类型\ngoodsId 商品id\ngoodsId1 商品编号\ngold 充值金额日元\nyuanbao 充值元宝\nvipExp 获得VIP经验\nname 商品名称\ndesc 商品描述\ngiftcost1 价值18.数据属性 3\ncolumns value\ngiftcost2 价值2\nimgName 商品图片\ntype 商品类型\nparam 商品参数\nitemlist 充值获得道具\nlinkId 关联ID\nnode 活动节点\nlibaoType 礼包类型\nfirstRecharge 是否算首充\ncostitem 消耗道具\ntrigger 是否触发运营活动\nneedShow 是否在充值列表展示 (0=显示，1=不显示）\ndesc2 页面展示描述\nsortNum 显示顺序（最小的在第一条）\ngold2 开服特惠价格\nisFourfold 首充送几倍元宝（ 0不加倍，3是三倍）\ndesc3 三倍页面展示描述\nratio 折扣比例\n礼包道具的中日文名称对应信息（ Optional ）\n*如果有的话需要同步。\n用户属性\n基本属性\n根据各游戏的相关用户信息做同步，所需要获取的信息：对用户在游戏里的一些有重要影响的信息，比\n如：用户的 demographic 信息，用户在游戏里的使用信息等。\n例：异世界8.数据属性 4\nColumn Format ValueRequired （If exist then\nYes)\nuid string 用户游戏唯一\n标示idYes\nname string 用户昵称 Yes\nsex string 用户注册性别 Yes\nctwid string g123 平台\nidYes\nserver_id string 游戏服id Yes\nreg_time Unix\ntime注册时间 Yes\nlevel string 玩家级别 Yes\nvip_level string 玩家vip级\n别Yes\nvip_exp string 玩家vip经\n验Yes\nlast_login_time Unix\ntime上次登录时间 Yes\nlast_online_time Unix\ntime上次在线时间 Yes\nlogin_streak integer 连续登录天数 Yes"
    },
    {
        "data": "time注册时间 Yes\nlevel string 玩家级别 Yes\nvip_level string 玩家vip级\n别Yes\nvip_exp string 玩家vip经\n验Yes\nlast_login_time Unix\ntime上次登录时间 Yes\nlast_online_time Unix\ntime上次在线时间 Yes\nlogin_streak integer 连续登录天数 Yes\ndevice_id string 设备唯一标示\n符Yes\nmoney integer 金币 Yes\nfood integer 粮食 Yes\nintelligence integer 魔力 Yes\ngold integer 元宝 Yes\nexp integer 等级经验 Yes\nenergy integer 美女精力 Yes\npower integer 战力 Yes\nmarkDays integer 签到总天数 Yes\nyearCardDays integer 年卡天数 Yes\nmonthCardDays integer 月卡天数 Yes8.数据属性 5\nColumn Format ValueRequired （If exist then\nYes)\nrechargeGear integer 首充状态 Yes\ntoday_online_time integer 今天在线时间 Yes\n行为属性\n打点事件 event_type: - ‘g_view ’:浏览事件-‘g_click ’:点击事件-‘g_obtain ’:道\n具获得-‘g_consumption ’:消耗事件\nformat ：v2\ncolumns format value required desc\nevent_type string event type: ‘g_view ’,\n‘g_click ’\nversion string 打点版本号 Yes\nuid string 用户游戏唯一标示 id Yes\nserver_id string 用户所在游戏服 id Yes\nctwid integer g123 平台生成id Yes\ntimestamp unix\ntime事件发生时间 Yes\nitem string item 相关字段 Yes\nrole string 用户相关字段 Yes"
    },
    {
        "data": "version string 打点版本号 Yes\nuid string 用户游戏唯一标示 id Yes\nserver_id string 用户所在游戏服 id Yes\nctwid integer g123 平台生成id Yes\ntimestamp unix\ntime事件发生时间 Yes\nitem string item 相关字段 Yes\nrole string 用户相关字段 Yes\ncustom_parameter string 自定义字段 No 针对埋点对象所\n需传值的自定义\n项\n::: item 字段:::\nitem\nid string 商品id Yes\ntype string 商品类型 Yes8.数据属性 6\nitem\nname string 商品名 Yes\ncount string 商品总量 Yes\nprice string 商品价格 Yes\nbalance string 商品剩余量 Yes\ndesc string 商品描述 Yes\ncontent string 商品内容 Yes\nreferer string 商品的上一跳转名称 Yes\npayment_type string 付费方式，各种虚拟货币 Yes\ncustom string item 中的其他内容 No\n::: role 字段:::\nrole\nid string 商品\nidYes\nlevel string 商品名Yes\nexp string 商品价\n格Yes\nvip_level string 商品总\n量Yes\nvip_exp string 商品内\n容Yes\nvistual_balance string 虚拟货\n币内容Yes“virtual_balance ”: {“diamond ”: 1234,\n“gold”: 567000 }\ncustom string role\n中的其\n他内容No\n::: custom_parameter: 保留字段，存放自定义项 :::\n例：JSON Format8.数据属性 7\nV ersion Requests v1 V1 api\n{\n\"schema\" :\"g_obtain/1-0-0\" ,\n\"type\" :\"g_obtain\" ,\n\"uuid\" :\"\" ,\n\"ctwid\" :\"G8Z0V61R\" ,\n\"appid\" :\"vividarmy\" ,"
    },
    {
        "data": "::: custom_parameter: 保留字段，存放自定义项 :::\n例：JSON Format8.数据属性 7\nV ersion Requests v1 V1 api\n{\n\"schema\" :\"g_obtain/1-0-0\" ,\n\"type\" :\"g_obtain\" ,\n\"uuid\" :\"\" ,\n\"ctwid\" :\"G8Z0V61R\" ,\n\"appid\" :\"vividarmy\" ,\n\"time\" :\"1601258400416\" ,\n\"plt_url\" :\"\",\n\"app_url\" :\"\",\n\"page\" :{\n\"browser_id\" :\"\" ,\n\"url\" :\"\" ,\n\"client_ip\" :\"153.232.108.190\" ,\n\"network_connection\" :\"\",\n\"network_information\" :\"\" ,\n\"referer\" :\"\" ,\n\"user_agent\" :\"\"\n},\n\"payload\" :{\n\"game_server_id\" :\"444\",\n\"game_user_id\" :\"263155351996\",\n\"role_id\" :\"263155351996\",\n\"role_level\" :73,\n\"role_exp\" :9.413059144099768e53,\n\"role_custom\" :\"{\\\"talent\\\":1201002,\\\"reg_server_id\\\":\\\"444\\\"}\",\n\"role_vip_level\" :9,\n\"role_vip_exp\" :19097,\n\"role_power\" :8.456929943728848e56,\n\"virtual_balance1\" :9097,\n\"virtual_balance2\" :0,\n\"virtual_balance3\" :0,\n\"item_id\" :\"\",8.数据属性 8\n\"item_type\" :\"item\",\n\"item_name\" :\"钻石 \",\n\"item_count\" :5,\n\"item_balance\" :9102,\n\"item_desc\" :\"free\",\n\"item_content\" :\"\",\n\"item_referer\" :\"\"\n}\n}\nV1 cp 侧\n{\n\"action\" : \"g_login\" ,\n\"data\" : {"
    },
    {
        "data": "\"item_type\" :\"item\",\n\"item_name\" :\"钻石 \",\n\"item_count\" :5,\n\"item_balance\" :9102,\n\"item_desc\" :\"free\",\n\"item_content\" :\"\",\n\"item_referer\" :\"\"\n}\n}\nV1 cp 侧\n{\n\"action\" : \"g_login\" ,\n\"data\" : {\n\"game_server_id\" :\"\",\n\"game_user_id\" :\"\",\n\"role_id\" :\"\" ,\n\"role_custom\" :\"\",\n\"role_level\" :\"\" ,\n\"role_exp\" :\"\" ,\n\"role_vip_level\" :\"\",\n\"role_vip_exp\" :\"\",\n\"role_power\" :\"\" ,\n\"virtual_balance1\" :\"\",\n\"virtual_balance2\" :\"\",\n\"virtual_balance3\" :\"\",\n\"item_id\" :\"\" ,\n\"item_type\" :\"\" ,\n\"item_name\" :\"\" ,\n\"item_count\" :\"\" ,\n\"item_balance\" :\"\",\n\"item_desc\" :\"\" ,\n\"item_content\" :\"\",8.数据属性 9\n\"item_referer\" :\"\"\n}\n}\nV ersion request v2 V2 api\n{\n\"schema\" :\"g_obtain/2-0-0\" ,\n\"type\" :\"g_obtain\" ,\n\"uuid\" :\"\" ,\n\"ctwid\" :\"G8Z0V61R\" ,\n\"appid\" :\"vividarmy\" ,\n\"time\" :\"1601258400416\" ,\n\"plt_url\" :\"\",\n\"app_url\" :\"\",\n\"page\" :{\n\"browser_id\" :\"\" ,\n\"url\" :\"\" ,\n\"client_ip\" :\"153.232.108.190\" ,\n\"network_connection\" :\"\",\n\"network_information\" :\"\" ,\n\"referer\" :\"\" ,\n\"user_agent\" :\"\"\n},\n\"payload\" :{\n\"game_server_id\" :\"444\","
    },
    {
        "data": "\"browser_id\" :\"\" ,\n\"url\" :\"\" ,\n\"client_ip\" :\"153.232.108.190\" ,\n\"network_connection\" :\"\",\n\"network_information\" :\"\" ,\n\"referer\" :\"\" ,\n\"user_agent\" :\"\"\n},\n\"payload\" :{\n\"game_server_id\" :\"444\",\n\"game_user_id\" :\"263155351996\",\n\"role\" :{\n\"id\" :\"\" ,\n\"level\" :\"\" ,\n\"exp\" :\"\" ,\n\"vip_level\" :\"\",\n\"vip_exp\" :\"\",\n\"power\" :\"\" ,8.数据属性 10\n\"virtual_balance\" : {\n\"diamond\" : 1234 ,\n\"gold\" :567000\n},\n\"custom\" : {\n\"power\" :\"\",\n\"food\" :\"\",\n\"intelligence\" :\"\",\n\"energy\" :\"\",\n\"own_items\" :\"\"\n}\n},\n\"item\" :{\n\"id\" :\"\",\n\"type\" :\"\",\n\"name\" :\"\",\n\"count\" :\"\",\n\"balance\" :\"\",\n\"desc\" :\"\",\n\"content\" :\"\",\n\"referer\" :\"\",\n\"payment_type\" : \"\" ,\n\"custom\" : {}\n},\n\"custom\" :{\n\"device_id\" :\"\"\n}\n}\n}\nV2 cp 侧\n{\n\"version\" :\"v2\" ,8.数据属性 11\n\"action\" : \"g_login\" ,\n\"data\" : {\n\"game_server_id\" :\"\",\n\"game_user_id\" :\"\",\n\"role\" :{\n\"id\" :\"\" ,\n\"level\" :\"\" ,\n\"exp\" :\"\" ,\n\"vip_level\" :\"\",\n\"vip_exp\" :\"\",\n\"virtual_balance\" : {\n\"diamond\" : 1234 ,\n\"gold\" :567000\n},\n\"custom\" : {\n\"power\" :\"\",\n\"food\" :\"\",\n\"intelligence\" :\"\",\n\"energy\" :\"\","
    },
    {
        "data": "\"id\" :\"\" ,\n\"level\" :\"\" ,\n\"exp\" :\"\" ,\n\"vip_level\" :\"\",\n\"vip_exp\" :\"\",\n\"virtual_balance\" : {\n\"diamond\" : 1234 ,\n\"gold\" :567000\n},\n\"custom\" : {\n\"power\" :\"\",\n\"food\" :\"\",\n\"intelligence\" :\"\",\n\"energy\" :\"\",\n\"own_items\" :\"\",\n}\n},\n\"item\" :{\n\"id\" :\"\" ,\n\"type\" :\"\" ,\n\"name\" :\"\" ,\n\"count\" :\"\" ,\n\"price\" :\"\" ,\n\"balance\" :\"\",\n\"desc\" :\"\" ,\n\"content\" :\"\",\n\"referer\" :\"\",\n\"payment_type\" : \"\" ,8.数据属性 12\n\"custom\" : {}\n},\n\"custom_parameter\" :{\n\"device_id\" :\"\"\n}\n}\n}\n|\n礼包购买 psp，追加item_id 和item_type\nhttps://developers.g123.jp/payment.html#_2-1-%E5%88%9B%E5%BB%BA%E5%85%A8%E5%B1%80%E8%AE%A4%E8%AF%81-\ntoken\nitem_id 是在这个items的code字段\nitem_type 是放在custom 字段\n同步方式\n文件同步\nCP可以自动每天同步数据到我们指定的 s3 path\n•游戏服开合服信息（全量）\n•道具配置表（全量）\n•礼包配置表（全量）\n•用户持有道具信息表（异世界）\n•用户持有英雄信息表（异世界）\n数据库访问（添加访问权限）\n•用户属性表\n•用户extra表（异世界）8.数据属性 13\n打点事件\n用户浏览，点击，获得，消耗道具 /礼包事件打点\n•浏览，点击礼包信息\n•获得，消耗道具信息\n•购买礼包信息\n例：#### 异世界文件同步（ @Chin 给CP S3 路径和目录 format ，Today CP 开始放\n数据到指定 S3路径）-道具配置表（全量） -礼包配置表（全量）数据库访问（添加访问权限） – CP"
    },
    {
        "data": "•用户属性表\n•用户extra表（异世界）8.数据属性 13\n打点事件\n用户浏览，点击，获得，消耗道具 /礼包事件打点\n•浏览，点击礼包信息\n•获得，消耗道具信息\n•购买礼包信息\n例：#### 异世界文件同步（ @Chin 给CP S3 路径和目录 format ，Today CP 开始放\n数据到指定 S3路径）-道具配置表（全量） -礼包配置表（全量）数据库访问（添加访问权限） – CP\n给我们权限（ Today ）-游戏服开合服信息（全量） -用户持有道具信息表（异世界） -用户持有英雄\n信息表（异世界） -用户属性表 -用户extra表打点事件 - @wang 同CP开始沟通具体内容\n百花\n•游戏服开合服信息（全量）提供 CP，S3文件路径@Chin- チン\n•道具配置表（全量）\n•礼包配置表（全量）麻烦 CP把用户信息相应的表结构和样本数据发给我们看一下。例：\n•用户持有道具信息表\n•用户持有英雄信息表\n•用户属性表\n•用户extra表打点事件\n•@wang 同CP开始沟通具体内容\n八男\n•游戏服开合服信息（全量）提供 CP，S3文件路径@Chin- チン\n•道具配置表（全量）\n•礼包配置表（全量）麻烦 CP把用户信息相应的表结构和样本数据发给我们看一下。例：\n•用户持有道具信息表\n•用户持有英雄信息表\n•用户属性表\n•用户extra表打点事件\n•@wang 同CP开始沟通具体内容8.数据属性 14\n同步频率\n•Daily同步\n业务属性\n礼包推荐\n道具推荐\n道具组合礼包\n新手礼包国际化对应 1\nimport Callout from “nextra-theme-docs/callout ”; import GlobalLoginDi-\ngram from “./assets/globalization-login.svg ”;\n国际化对应\n1.国际化参数\n1.1平台支持的语言和币种\n语言 Language\n日语 ja\n英语 en\n韩语 ko\n繁体中文 zh-TW\n西班牙语 es\n法语 fr\n德语 de\n意大利语 it\n印度尼西亚语 id\n葡萄牙语 pt\n菲律宾语 tl\n越南语 vi\n荷兰语 nl\n注:平台会根据市场情况酌情新增语言支持，语言参数采用的标准为： ISO 639-1\ncurrency 币种符号（商品价格展示用）\nUSD $\nAUD A$"
    },
    {
        "data": "1.1平台支持的语言和币种\n语言 Language\n日语 ja\n英语 en\n韩语 ko\n繁体中文 zh-TW\n西班牙语 es\n法语 fr\n德语 de\n意大利语 it\n印度尼西亚语 id\n葡萄牙语 pt\n菲律宾语 tl\n越南语 vi\n荷兰语 nl\n注:平台会根据市场情况酌情新增语言支持，语言参数采用的标准为： ISO 639-1\ncurrency 币种符号（商品价格展示用）\nUSD $\nAUD A$\nCAD CA$\nGBP £国际化对应 2\ncurrency 币种符号（商品价格展示用）\nJPY ¥\nEUR €\nCHF CHF\nCZK CZK\nDKK DKK\nHKD HK$\nHUF HUF\nNOK NOK\nNZD NZ$\nPLN PLN\nSEK SEK\nSGD SGD\nTWD NT$\nTHB ฿\nPHP ₱\nMXN MX$\nILS ￿\nRUB ￿\nKR W ₩\nVND ₫\nIDR Rp\nCLP CLP\nMYR MR Y\nBRL R$\nAED AED\nBDT BDT\nPEN PEN\nRON RON\nSAR SAR\nINR ￿\nISK ISK\nBGN ￿￿国际化对应 3\ncurrency 币种符号（商品价格展示用）\nARS ARS\nMOP MOP\n固游戏内在做活动广告时，不要把金额文字信息加到图片中，而是单独拿出来做成按钮。累充金额的活动\n也改成累充 point的形式。\n活动图片多语言展示用例\n用户所在地澳大利亚，平台识别币种 currency=AUD ，使用货币符号 A$，不管如何切换语言，币\n种始终不变。\n图 1: currency\n累计充值奖励用例\n2.多语言字体下载\n在开发多语言版本游戏时，如果没有安装下载对应语言的字体，会造成日语等其他语言的文字无法正常\n显示等问题 字体下载链接国际化对应 4\n图 2: cumulative_charge国际化对应 5\n3.游戏内实时聊天翻译接口\n3.1游戏内实时聊天翻译功能（参考其他游戏）\n•聊天频道的每一条句子提供一个翻译按钮\n•用户点击后在句子下方展示翻译结果\n注意：翻译的目标译文为当前游戏语言，如图中所示，当前游戏语言为日语，世界聊天频道中其他非日语\n的句子点击翻译按钮后会被翻译成日语，日语句子点击按钮后还是原句。国际化对应 6\n国际化对应 7\n国际化对应 8\n3.2接口文档"
    },
    {
        "data": "3.游戏内实时聊天翻译接口\n3.1游戏内实时聊天翻译功能（参考其他游戏）\n•聊天频道的每一条句子提供一个翻译按钮\n•用户点击后在句子下方展示翻译结果\n注意：翻译的目标译文为当前游戏语言，如图中所示，当前游戏语言为日语，世界聊天频道中其他非日语\n的句子点击翻译按钮后会被翻译成日语，日语句子点击按钮后还是原句。国际化对应 6\n国际化对应 7\n国际化对应 8\n3.2接口文档\n平台游戏目前使用的是 OpenAI API 实现上图的实时翻译功能。\n如果游戏内需要实现该功能，请在 Publisher 工具上获取 OpenAI 的 Secret，并按照以下接入\n流程进行接入。\n接口 Schema 本接口使用 Basic认证，接入方请在 Access tool 中获取 secret 值。\n获取到 secret 后请按照 Basic auth (appId:secret) 的方式拼接 Authorization header ，\n如下：\ngoodgame:SEC7asfjksdasodfuasldkf3r23h45k23j4g\n使用 base64 encode 后生成字符串 > Z29vZGdhbWU6U0VDN2F zZmprc2Rhc29kZn Vhc2xka2Y zcjIzaDQ1azIzajRn\n将 token 拼接到 Authorization 中\n-H \"Authorization: Basic Z29vZGdhbWU6U0VDN2FzZmprc2Rhc29kZnVhc2xka2YzcjIzaDQ1azIzajRn\"\n•地址\n环境 Endpoint\nstaging / production https://forge-translation-\napi.g123.jp/api/cp/v1/translate\n•请求参数【 JSON】\n编号 字段名 类型 必传 描述\n1 sourceT ext string true 需要翻译的原文\n2 toLanguage string true 目标语言\n•响应参数【 JSON】\n编号 字段名 类型 必传 描述\n1 translation string true 翻译后的文本国际化对应 9\n•请求样例\ncurl -X 'POST' \\"
    },
    {
        "data": "•请求参数【 JSON】\n编号 字段名 类型 必传 描述\n1 sourceT ext string true 需要翻译的原文\n2 toLanguage string true 目标语言\n•响应参数【 JSON】\n编号 字段名 类型 必传 描述\n1 translation string true 翻译后的文本国际化对应 9\n•请求样例\ncurl -X 'POST' \\\n'https://forge-translation-api.g123.jp/api/cp/v1/translate' \\\n-H \"Authorization: Basic Z29vZGdhbWU6U0VDN2FzZmprc2Rhc29kZnVhc2xka2YzcjIzaDQ1azIzajRn\" \\\n-d '{\n\"sourceText\" : \"How is it going?\" ,\n\"toLanguage\" : \"ja\"\n}'\n•响应样例\n{\n\"translation\" : \"お元気ですか？ \"\n}\n特殊情况 平台会对参数进行校验，在参数错误的情况下会统一返回 400错误如：\n{\n\"message\" : \"language: uz not supported by G123 chat translation\"\n}\nResponse code: 400 (Bad Request); Time: 4ms (4 ms); Content length: 66 bytes (66 B)\n在 Auth相关校验失败时会返回\n{\n\"message\" : \"Unauthorized\"\n}\nResponse code: 401 (Unauthorized); Time: 4ms (4 ms); Content length: 26 bytes (26 B)\n在翻译内容违反平台内容政策时，会按照目标语言返回\n{\n\"translation\" : \"翻译失败，违反内容政策 \"\n}国际化对应 10\nResponse code: 202 (Accepted); Time: 419ms (419 ms);5.客服接口 1\nimport Callout from ‘nextra-theme-docs/callout ’\n5.客服接口\n游戏内通过接入此 API调起 G123平台提供的客服系统\n5.1前端上报玩家关键信息 API"
    },
    {
        "data": "}国际化对应 10\nResponse code: 202 (Accepted); Time: 419ms (419 ms);5.客服接口 1\nimport Callout from ‘nextra-theme-docs/callout ’\n5.客服接口\n游戏内通过接入此 API调起 G123平台提供的客服系统\n5.1前端上报玩家关键信息 API\n此 API主要用于，向平台客服系统传入，玩家当前游戏内的信息。接入 客服 API前，必须要接入此\nAPI。通常在游戏登录成功时调用此方法即可。\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"inform\" ,\n\"data\":{\n\"role_id\" :\"U-123-ABC\" ,\n\"role_name\" :\"我是角色名 \",\n\"game_server\" :\"S101\",\n\"tags\":['VIP2','tag2','tag3','tag4']\n}\n}),'*');\n参数\nparameter value required?\nrole_id 玩家在游戏内的唯一 uid Y es\nrole_name 玩家在游戏内的角色名 Y es\ngame_server 玩家当前的游戏服 Y es\ntags 玩家的关键信息 (VIP等级信息为必须 ，\n其他信息请在对接群中与 PM沟通 )，数\n量没有上限，只允许英文数字字母，有多个\ntag时请用英文” ,“号隔开Y es5.客服接口 2\n5.2客服 API\n玩家点击游戏内的客服按钮时调用此方法，必须实现 前端上报玩家关键信息 api\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"support\"\n}),'*');5.客服接口 1\n5.客服接口\n准备\n完成数据接口 :g_register 事件和 g_login 事件\n方法\n当玩家点击游戏内的”客服”按钮时，触发方法以打开平台的客服窗口。\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"support\"\n}),'*');11.活动平台 1\n11.活动平台\n11.1礼物发送方式\nAPI调用"
    },
    {
        "data": "5.客服接口\n准备\n完成数据接口 :g_register 事件和 g_login 事件\n方法\n当玩家点击游戏内的”客服”按钮时，触发方法以打开平台的客服窗口。\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"support\"\n}),'*');11.活动平台 1\n11.活动平台\n11.1礼物发送方式\nAPI调用\n直接通过 API调用发放活动礼物， CP需要提供规定 API 1. 平台将请求体用 base64 编码后放在\npayload 字段 2.使用登录文档中平台发行的 appSecret 做为密钥， 通过 HMAC_SHA256\n算法生成签名，签名放在 signature 字段 3. CP 收到请求后，用 appSecret 作为密钥，\nHMAC_SHA256 的方式加密 payload 与 signature 比对 4.如果签名不正确，返回状态\n码 403 F orbidden 5. 签名正确时，继续游戏里礼物发送\n平台方签名处理\njson = {\n\"uid\": \"xxxxx\",\n\"server_id\": \"xxxx\",\n\"gift_code\": \"xxxxx\"\n}\npayload = base64(json)\nsignature = hmac_sha256(payload, appSecret)\n调用方式 Request Body | property | description | | –|–| | payload | 请求体 json\n的 base64 编码 | | signature | 平台签名 |\nPayload Json | property | description | | –|–| | uid | 游戏用户 ID | | server_id\n|游戏服务器 ID | | gift_code | 礼包码 |\nResponse | http_code | description | | –|–| | 200 | 发送成功 | | 400 | Json 参数\n问题 | | 401 | 没有找到用户 | | 403 | 签名验证失败 |\n网络调用可能会有波动的情况，存在礼包发给了用户但是平台没有收到 200的 Response 。如果限"
    },
    {
        "data": "|游戏服务器 ID | | gift_code | 礼包码 |\nResponse | http_code | description | | –|–| | 200 | 发送成功 | | 400 | Json 参数\n问题 | | 401 | 没有找到用户 | | 403 | 签名验证失败 |\n网络调用可能会有波动的情况，存在礼包发给了用户但是平台没有收到 200的 Response 。如果限\n制用户礼包只能领取一次，多次调用不给用户发送礼包但是依然需要返回 200\ncurl -X POST \\11.活动平台 2\n{gift_url} \\\n-H 'Content-Type: application/json' \\\n-d '{\n\"payload\": payload,\n\"signature\": signature\n}'\nCP方需要验证 signature 后才对 payload 进行处理\n//伪代码\nexpired = hmac_sha256(body.payload, appSecret);\nif (signature != expired) return false;\njson = decode_base64(body.payload);\n//后续处理\nprocess(json)9.服务器间事件上报 1\n9.服务器间事件上报\n说明\n服务器端事件目前主要用于含有奖励的活动（如：升到指定级别发送 PayPay 红包） ，以及成果报酬\n型广告（如：通过第三方积分网站进入游戏，升到指定级别向用户发放第三方积分） 。因此需要游戏服务\n器和平台服务器间通讯以确保数据可靠性，防止作弊。\n9.1升级 (level_up)\nCP对应流程\n1.当用户达到升级时 , CP游戏服务器向平台服务器发送事件，平台返回响应消息\n2. CP游戏服务器将收到的响应信息推送至游戏前端 ,前端将该信息通过 win-\ndow.top.postMessage 发送到平台主窗口。\n注:游戏服务器端要确保用户达到指定等级\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp\n此外，该流程使用登录流程的 appId 和 appSecret ，参见账号接口\n9.2创建事件"
    },
    {
        "data": "dow.top.postMessage 发送到平台主窗口。\n注:游戏服务器端要确保用户达到指定等级\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp\n此外，该流程使用登录流程的 appId 和 appSecret ，参见账号接口\n9.2创建事件\nPOST /api/v1/cp/game_event/level_up9.服务器间事件上报 2\nRequest Header 使用 Basic认证方式发送 appId 和 appSecret\nRequest header Description\nContent-Type application/json\nAuthorization Basic base64( ‘𝑎𝑝𝑝𝐼 𝑑 ∶ appSecret ’)\nRequest Body\nRequest Body F ormat V alue Required\nuid string 用户游戏唯一标示 id Y es\nserver_id string 用户所在游戏服 id Y es\nctwid string g123 平台生成 id Y es\ntimestamp long 事件发生时间 (UNIX 时间单位 :ms) Y es\nlevel integer 用户级别 Y es\ndata object 数据系统用 Y es\n::: data 字段 :::\ncolumns format value required desc\ngame_user_id string CP 数据库玩家账号 Y es 游戏数据库分配\n的账号唯一标识\nrole object 用户相关字段 Y es 玩家属性信息\ncustom object 自定义字段 Y es 针对埋点对象所\n需传值的自定义\n项，目前必传项\n为 physi-\ncal_server\n（如该 uid触发\n事件所在物理服\n务器的域名信\n息） 。9.服务器间事件上报 3\nResponse Body 状态码 : 200消息内容： JSON 格式的返回数据\n注:返回的数据格式可能会在正式版本发布时有所变动，请在 1.2前端事件触发这一步中，将返回数\n据全部通过 postMessage 提交\n示例\ncurl -i -X POST \\"
    },
    {
        "data": "项，目前必传项\n为 physi-\ncal_server\n（如该 uid触发\n事件所在物理服\n务器的域名信\n息） 。9.服务器间事件上报 3\nResponse Body 状态码 : 200消息内容： JSON 格式的返回数据\n注:返回的数据格式可能会在正式版本发布时有所变动，请在 1.2前端事件触发这一步中，将返回数\n据全部通过 postMessage 提交\n示例\ncurl -i -X POST \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization:Basic $(echo -n $APP_ID:$APP_SECRET | openssl base64 -A)\" \\\n-d \\\n'{\n\"uid\": \"123\",\n\"game_server_id\": \"s73\",\n\"ctwid\": \"GIL6T4CO\",\n\"timestamp\": 1605076260715,\n\"level\": 10,\n\"data\": {\n\"game_user_id\":\"1234567\",\n\"role\": {\n\"id\":\"3444382\",\n\"exp\":\"1\",\n\"vip_level\":\"0\",\n\"vip_exp\":\"0\",\n\"virtual_balance\": {\n\"diamond\": \"1234\",\n\"gold\": \"567000\"\n},\n\"custom\": {\n\"reg_server_id\": \"1\" // server id where g_register occurred\n}\n},\n\"custom\":{\n\"device_id\": \"\",9.服务器间事件上报 4\n\"physical_server\": \"$SERVER_HOST|$SERVER_IP\"\n}\n}\n}' \\\n'https://h5.stg.g123.jp/api/v1/cp/game_event/level_up'\nOUTPUT:\nHTTP/1.1 200 OK\nvary: accept-encoding\ncontent-type: application/json;charset=UTF-8\ntransfer-encoding: chunked\ndate: Wed, 11 Nov 2020 07:53:51 GMT\nconnection: close"
    },
    {
        "data": "OUTPUT:\nHTTP/1.1 200 OK\nvary: accept-encoding\ncontent-type: application/json;charset=UTF-8\ntransfer-encoding: chunked\ndate: Wed, 11 Nov 2020 07:53:51 GMT\nconnection: close\n{\"action\":\"game_event_created\",\"id\":\"1\",\"token\":\"fdda6c9f-5745-4adc-9541-c3827d654dfa\"}\n注:返回的数据格式可能会在正式版本发布时有所变动\n9.3前端事件触发\n将平台服务器的返回的消息，在前端通过 window.top.postMessage 传递到平台\nwindow.top.postMessage(responseData, '*');支付接口 1\nimport Callout from ‘nextra-theme-docs/callout ’; import PaymentSequence-\nDiagram from ‘./assets/new-payment-sequence-diagram.svg ’;\n支付接口\n时序图\n流程\n1.登录Publisher 工具获得支付 clientId 与 clientSecret ，并设置 接收支付\nIPN 通知 URL\n2.创建全局认证 :通过（POST: /api/cp/token ）向平台请求 全局认证token\n3.创建订单:获取平台订单号 (orderNo)\n4.启动支付窗口 :游戏前端调启平台支付窗口 (前端API)\n5.玩家支付\n6.接收&处理IPN:游戏服务器、确认、处理 IPN并发货\n7.上报发货状态到平台 :游戏服务器向平台上报发货结果\nDemo 演示\n环境参数\n系统 环境 API Host\n支付 测试 https://psp.stg.g123.jp\n支付 正式 https://psp.g123.jp\n从安全性上考虑， 所有的平台支付 API调用都应在游戏 服务器后端 上完成。\n1.创建全局认证 token\n通过此API可以得到用于进行其他 API调用的全局 token。创建的多个 token 在有效期内可同\n时使用，但需注意避免频繁创建新的 token。支付接口 2"
    },
    {
        "data": "支付 测试 https://psp.stg.g123.jp\n支付 正式 https://psp.g123.jp\n从安全性上考虑， 所有的平台支付 API调用都应在游戏 服务器后端 上完成。\n1.创建全局认证 token\n通过此API可以得到用于进行其他 API调用的全局 token。创建的多个 token 在有效期内可同\n时使用，但需注意避免频繁创建新的 token。支付接口 2\nEndpoint\nPOST {API Host}/api/cp/token\nRequest Header\nRequest header Description\nContent-Type application/json\nRequest Body\nRequest\nBody Property Description\ngrant_type client_credentials 默认值不需要修改\nclient_id your clientId 从Publisher 获取\nclient_secretyour\nclientSecret从Publisher 获取\nResponse\nResponse Description\naccess_token Access token; 请避免频繁创建新 token;在失效前5分钟左右创建即可\ntoken_type Bearer\nexpires_inExpire time(in seconds)\ncreated_at The token created time (Unix timestamp in milliseconds); 即失效\n时间点= created_at + expires_in*1000\n用例\nRequest\ncurl -X POST \\\n{API Host}/api/cp/token \\支付接口 3\n-H 'Content-Type: application/json' \\\n-H 'cache-control: no-cache' \\\n-d '{\n\"grant_type\": \"client_credentials\",\n\"client_id\": \"testapp_cL9-ckoA2\",\n\"client_secret\": \"Wqrl1bHFRoF07LdYIIZ71A9pClsDlcrC\"\n}'\nResponse\n{"
    },
    {
        "data": "-H 'cache-control: no-cache' \\\n-d '{\n\"grant_type\": \"client_credentials\",\n\"client_id\": \"testapp_cL9-ckoA2\",\n\"client_secret\": \"Wqrl1bHFRoF07LdYIIZ71A9pClsDlcrC\"\n}'\nResponse\n{\n\"access_token\" : \"K4RVtZjt1tXPSAWnADhZhZsMJ3l1fiI8\" ,\n\"token_type\" :\"Bearer\" ,\n\"expires_in\" :86400 ,\n\"created_at\" :1547972209599\n}\n2.创建订单\n通过此API在G123支付平台上创建订单，并获取平台返回的订单号。同一个订单号在前端只能激\n一次支付窗口。\n防止金额被篡改方法 (非常重要 ￿ )\n1.防止金额在浏览器端被篡改 :\n1. (商品 Code, 币种 ) → 金额的对应关系保存在游戏服务器端。\n2.前端只发送商品 Code到游戏服务器，不可以直接发送金额。\n3.在游戏服务器上找到金额后拼装，创建订单请求后，由服务器端发送到平台支付 API。\n2.防止币种被篡改:请使用通过 平台账号接口 获取到的币种支付接口 4\nEndpoint\nPOST {API Host}/api/cp/orders\nRequest Header\nRequest header Description\nContent-Type application/json\nAuthorization Bearer ${ {accessToken} }\nRequest Body\nRequest Body Description Mandatory\nversion 3.3 YES\nitems item array, json 结构参照下表 YES\ncustom custom json, json 结构参照下表 YES\nitem\nKey Value Limitation&Description Default Mandatory\ncode 商品代码（游戏内商品标识码） 64 byte N/A YES\nname 商品名称 64 byte N/A YES\namt 商品价格 0.01 {‘<=’} amt { ‘<=’}\n200000N/A YES"
    },
    {
        "data": "custom custom json, json 结构参照下表 YES\nitem\nKey Value Limitation&Description Default Mandatory\ncode 商品代码（游戏内商品标识码） 64 byte N/A YES\nname 商品名称 64 byte N/A YES\namt 商品价格 0.01 {‘<=’} amt { ‘<=’}\n200000N/A YES\ncurrency 币种 使用平台2.账号接口获取的币种码 N/A YES\ndesc 商品简介 64 byte EmptyNO\nqty 商品数量（虚拟电子产品必须为\n1）qty {‘>=’} 1 1 NO\ntaxamt 税额（可以把税额含入 amt\n之中，并把此值赋 0）taxamt { ‘>=’} 0 0 NO\nurl 商品URL 255 byte EmptyNO支付接口 5\n-多币种价格为非实时汇率换算 ,请在此获取 平台多币种价目对照表 -币种仅由用户所在国家 /地区决\n定，与语言无关\ncustom\nKey Value Description Type Mandatory\ngame_server_id 游戏服务器 StringYES\nitem_type 道具类型\n(pass/fund/item/gift)游戏内没有定义可传空\n字符StringYES\nrole_id 角色ID StringYES\nrole_level 角色等级 StringYES\nrole_vip_level 角色VIP等级 StringYES\nreason 充值原因,活动等 游戏内没有定义可传空\n字符StringYES\nvirtual_currency_amount 获得虚拟币数量 游戏内没有定义可传” 0”StringYES\nnotify_url 订单通知的回调地址 ￿ 需要事先登记 ￿ StringYES\nctwid G123 ID g123平台发行的用户\n唯一idStringYES\n尽量上传所有字段，若无法获取某字段值则忽略，但不要上传空值。\nnotify_url 需要在事先平台 Publisher 工具（G123接入>支付）里进行配置\nResponse\nResponse Description\norderNo 订单号.\ntoken 订单Token.\n用例\nRequest支付接口 6"
    },
    {
        "data": "ctwid G123 ID g123平台发行的用户\n唯一idStringYES\n尽量上传所有字段，若无法获取某字段值则忽略，但不要上传空值。\nnotify_url 需要在事先平台 Publisher 工具（G123接入>支付）里进行配置\nResponse\nResponse Description\norderNo 订单号.\ntoken 订单Token.\n用例\nRequest支付接口 6\ncurl -X POST \\\n{API Host}/api/cp/orders \\\n-H 'Authorization: Bearer K4RVtZjt1tXPSAWnADhZhZsMJ3l1fiI8' \\\n-H 'Content-Type: application/json' \\\n-H 'cache-control: no-cache' \\\n-d '{\n\"version\": \"3.3\",\n\"items\": [\n{\n\"code\": \"special_bag\",\n\"name\": \"Some Item\",\n\"desc\": \"Some desc\",\n\"amt\": 1050,\n\"currency\": \"JPY\",\n\"qty\": 1,\n\"taxamt\": 0,\n\"url\": \"\"\n}\n],\n\"custom\": {\n\"user\": {\n\"id\": \"user234\",\n\"desc\": \" 聖闘士星矢 \"\n},\n\"game_server_id\": \"osaka_1\",\n\"item_type\": \"gift\",\n\"role_id\": \"as\",\n\"role_level\": \"150\",\n\"role_vip_level\": \"3\",\n\"reason\": \" 新年活动 \",\n\"virtual_currency_amount\": \"12\",\n\"notify_url\": \"https://www.cpgame.com/ipn/receiver\", // 请事先登记 ￿ \n\"ctwid\": \"G12345678\"支付接口 7\n}\n}'\nResponse\n{\n\"orderNo\" : \"0241901200002606\" ,\n\"token\" : \"52de3219-2efb-4a98-b175-c9b19e0be5f9\"\n}\n订单格式校验"
    },
    {
        "data": "\"notify_url\": \"https://www.cpgame.com/ipn/receiver\", // 请事先登记 ￿ \n\"ctwid\": \"G12345678\"支付接口 7\n}\n}'\nResponse\n{\n\"orderNo\" : \"0241901200002606\" ,\n\"token\" : \"52de3219-2efb-4a98-b175-c9b19e0be5f9\"\n}\n订单格式校验\n平台使用JSON Schema 对订单的格式进行校验，格式错误时会返回 invalid_request 错误。\n可以通过在线校验工具对要发送的内容进行校验。具体方法如下\n1.打开工具:https://www.jsonschemavalidator.net\n2.将下面的JSON Schema 贴入左侧的文本框\n3.将要发送的 Request Body (JSON) 内容贴入 右侧的文本框\n4.校验工具的下方会显示校验结果\n请拷贝此JSON Schema, 贴入上述校验工具\n{\n\"additionalProperties\" :false ,\n\"type\" : \"object\" ,\n\"properties\" :{\n\"version\" :{\n\"type\" : \"string\" ,\n\"enum\" : [\"3.3\" ]\n},\n\"custom\" : {\n\"type\" : \"object\" ,\n\"additionalProperties\" : true ,\n\"properties\" : {\n\"game_server_id\" :{支付接口 8\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 64\n},\n\"item_type\" : {\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 64\n},\n\"role_id\" : {\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 64\n},\n\"role_level\" : {\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 8\n},\n\"role_vip_level\" :{\n\"type\" : \"string\" ,\n\"minLength\" : 1,"
    },
    {
        "data": "\"role_id\" : {\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 64\n},\n\"role_level\" : {\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 8\n},\n\"role_vip_level\" :{\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 8\n},\n\"reason\" : {\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 64\n},\n\"virtual_currency_amount\" :{\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 64支付接口 9\n},\n\"notify_url\" : {\n\"type\" : \"string\" ,\n\"minLength\" : 1,\n\"maxLength\" : 255\n},\n\"ctwid\" : {\n\"type\" : \"string\" ,\n\"minLength\" : 7,\n\"maxLength\" : 10\n}\n},\n\"required\" : [\n\"game_server_id\" ,\n\"item_type\" ,\n\"role_id\" ,\n\"role_level\" ,\n\"role_vip_level\" ,\n\"reason\" ,\n\"virtual_currency_amount\" ,\n\"notify_url\" ,\n\"ctwid\"\n]\n},\n\"items\" : {\n\"type\" : \"array\" ,\n\"minItems\" : 1,\n\"items\" :{\n\"type\" :\"object\" ,\n\"additionalProperties\" :false ,\n\"properties\" : {\n\"code\" : {\n\"type\" : \"string\" ,支付接口 10\n\"minLength\" :1,\n\"maxLength\" :64\n},\n\"name\" : {\n\"type\" : \"string\" ,\n\"minLength\" :1,\n\"maxLength\" :64\n},\n\"desc\" : {\n\"type\" : \"string\" ,"
    },
    {
        "data": "\"properties\" : {\n\"code\" : {\n\"type\" : \"string\" ,支付接口 10\n\"minLength\" :1,\n\"maxLength\" :64\n},\n\"name\" : {\n\"type\" : \"string\" ,\n\"minLength\" :1,\n\"maxLength\" :64\n},\n\"desc\" : {\n\"type\" : \"string\" ,\n\"maxLength\" :64,\n\"default\" : \"\"\n},\n\"amt\" : {\n\"type\" : \"number\" ,\n\"minimum\" : 0.01 ,\n\"maximum\" : 1000000\n},\n\"currency\" : {\n\"type\" : \"string\" ,\n\"minLength\" :3,\n\"maxLength\" :3\n},\n\"qty\" : {\n\"type\" : \"number\" ,\n\"minimum\" : 1,\n\"default\" : 1\n},\n\"taxamt\" : {\n\"type\" : \"number\" ,\n\"minimum\" : 0,\n\"default\" : 0\n},支付接口 11\n\"url\" : {\n\"type\" : \"string\" ,\n\"maxLength\" :255 ,\n\"default\" : \"\"\n}\n},\n\"required\" : [\"code\" ,\"name\" ,\"amt\" ,\"currency\" ]\n}\n}\n},\n\"required\" : [\"version\" ,\"items\" ,\"custom\" ]\n}\n图1:json schema validation支付接口 12\n3.启动支付窗口\n获取订单号（ orderNo ）后，游戏前端通过调用 激活支付窗口 API启动平台支付窗口。如：\n//传 JSON object （不是字符串） ，无需序列化\n<script >\nwindow .CpSdk .sendPayment ({\n\"orderNo\" : \"0241901200002606\" ,\n\"token\" :\"52de3219-2efb-4a98-b175-c9b19e0be5f9\"\n});\n</ script >\n4.模拟用户支付 (测试环境 )\n只需测任意一种支付方式：\n•amazon pay:\n测试账号密码\ng123@gmail.com"
    },
    {
        "data": "window .CpSdk .sendPayment ({\n\"orderNo\" : \"0241901200002606\" ,\n\"token\" :\"52de3219-2efb-4a98-b175-c9b19e0be5f9\"\n});\n</ script >\n4.模拟用户支付 (测试环境 )\n只需测任意一种支付方式：\n•amazon pay:\n测试账号密码\ng123@gmail.com\n1234zxcv\n图2:test3\n•クレジットカード (信用卡):\nCard Type: JCB支付接口 13\nCard Number: 3569990010095841\nExpiration Date: 03/2030\nCVV: 737\nCard Type: Visa\nCard Number: 4166676667666746\nExpiration Date: 03/2030\nCVV: 737\nCard Number: 4035501000000008\nExpiration Date: 03/2030\nCVV: 737\nCard Type: Mastercard\nCard Number: 2222400010000008\nExpiration Date: 03/2030\nCVV: 737\nCard Number: 5555444433331111\nExpiration Date: 03/2030\nCVV: 737\nCard Type: American Express(Amex)\nCard Number: 370000000000002\nExpiration Date: 03/2030\nCVV: 7373\n其 他Adyen 的 测 试 卡 号 : https://docs.adyen.com/development-\nresources/testing/test-card-numbers/\n•PayPal:\n测试账号密码\ngame-cp@g123.jp\n12345678支付接口 14\n图3:test2支付接口 15\n•Paidy:\n测试账号密码\n电话： 08000000001\n验证码： 8888\n支付成功邮箱： successful.payment@paidy.com\n支付失败邮箱： rejected.payment@paidy.com\n图4:test3\n•PayPay:\n测试账号密码"
    },
    {
        "data": "测试账号密码\ngame-cp@g123.jp\n12345678支付接口 14\n图3:test2支付接口 15\n•Paidy:\n测试账号密码\n电话： 08000000001\n验证码： 8888\n支付成功邮箱： successful.payment@paidy.com\n支付失败邮箱： rejected.payment@paidy.com\n图4:test3\n•PayPay:\n测试账号密码\n电话： 09025177804\n密码： Y7RFsPPT82\n验证码： 1234 or 1111支付接口 16\n图5:test3支付接口 17\n5.接收 &处理 IPN(Instant Payment Notification)\n发送放： G123 平台\n接收方： CP\nRequest Header\nRequest header Description\nContent-Type application/json\nRequest Body\nRequest Body Description Mandatory\norderNo 订单号 YES\n平台在支付成功时发送 IPN到notify_url ,游戏服务器接收到 IPN消息后，应进行如下操作 :\n1.立即返回Response, 状态码为 200 OK 或 204 No Content 。若未返回 200或\n204，平台视为发送失败，并触发重试机制（共 5次） 。平台会定期检查没有被正确接收的消息，\n并进行重试。\n2.游戏服务器通过调用 查询订单详细信息 来确认订单状态 :状态为 shipped 时，进行发货 ,并\n在发货后 通知G123平台支付状态 。其他状态时，不可发货，也无需上报给平台。\n6.订单详细信息查询 API\n游戏服务器在收到平台通知之后，方可调用此接口，禁止作为轮询使用。\nEndpoint\nGET {API Host}/api/cp/orders/:orderNo\nRequest Header支付接口 18\nRequest header Description\nContent-Type application/json\nAuthorization Bearer ${ {accessToken} }\nRequest Parameters\nParameters Description\norderNo 订单号\nResponse"
    },
    {
        "data": "Request Header支付接口 18\nRequest header Description\nContent-Type application/json\nAuthorization Bearer ${ {accessToken} }\nRequest Parameters\nParameters Description\norderNo 订单号\nResponse\nResponse Description\norderNo 订单号\nappCode 游戏Code\nstatus 订单状态:（shipped: 待发货/delivered: 已发货）\nuserId 用户ID\npaymentCode 支付方式\nretryCount 重复支付次数（失败下用户可以选择重试）\ncustom 创建订单时，游戏提供参数\nerror 错误信息\ncreatedAt 订单创建时间\nupdatedAt 订单更新时间\nitems 创建订单时，游戏提供参数， Array 类型\n用例\nRequest\ncurl -X GET \\\n{API Host}/api/cp/orders/0241901200002606 \\\n-H 'Authorization: Bearer K4RVtZjt1tXPSAWnADhZhZsMJ3l1fiI8' \\支付接口 19\n-H 'Content-Type: application/json' \\\n-H 'cache-control: no-cache'\nResponse\n{\n\"orderNo\" : \"0241901200002606\" ,\n\"appCode\" : \"testapp\" ,\n\"status\" : \"created\" ,\n\"userId\" : null ,\n\"paymentCode\" : null ,\n\"retryCount\" :0,\n\"custom\" : \"{ \\\"user \\\" :{\\\"id \\\" :\\\" user234 \\\" ,\\\" desc \\\" :\\\"聖闘士星矢 \\\"}, \\\"serverId \\\":\\\" osaka_1 \\\"}\",\n\"error\" : null ,\n\"createdAt\" :\"2019-01-20T08:26:43.000Z\" ,\n\"updatedAt\" :\"2019-01-20T08:26:43.000Z\" ,\n\"items\" : [\n{"
    },
    {
        "data": "\"error\" : null ,\n\"createdAt\" :\"2019-01-20T08:26:43.000Z\" ,\n\"updatedAt\" :\"2019-01-20T08:26:43.000Z\" ,\n\"items\" : [\n{\n\"code\" : \"special_bag\" ,\n\"name\" : \"Some Item\" ,\n\"desc\" : \"Some desc\" ,\n\"amt\" : 100 ,\n\"qty\" : 1,\n\"taxamt\" :0,\n\"url\" : \"\",\n\"createdAt\" : \"2019-01-20T08:26:43.000Z\" ,\n\"updatedAt\" : \"2019-01-20T08:26:43.000Z\"\n}\n]\n}\n7.通知平台订单的发货成功状态\n请务必确认 购买的物品交付给玩家之后 ，或确保玩家一定能收到物品之后 再上报G123平台发货成功支付接口 20\n确实存在错误，导致发货失败时（如写入数据库时报错） ，无需上报给平台。特殊情况的处理参见 常见问\n题\n•调用方:CP\n•提供方:G123\nEndpoint\nPOST {API Host}/api/cp/orders/:orderNo/deliver\nRequest Header\nRequest header Description\nAuthorization Bearer ${ {accessToken} }\nRequest Parameters\nParameters Description\norderNo 订单号\n用例\nRequest\ncurl -X POST \\\n{API Host}/api/cp/orders/ 订单号 /deliver \\\n-H 'Authorization: Bearer K4RVtZjt1tXPSAWnADhZhZsMJ3l1fiI8' \\\n-H 'Content-Type: application/json' \\\n-H 'cache-control: no-cache'\n8.调用 G123 支付平台 API 时的错误 Response支付接口 21\nstatusCode error messagedescription\n400 Bad\nRe-\nquestaccess_denied token 错误\n400 Bad\nRe-"
    },
    {
        "data": "-H 'Content-Type: application/json' \\\n-H 'cache-control: no-cache'\n8.调用 G123 支付平台 API 时的错误 Response支付接口 21\nstatusCode error messagedescription\n400 Bad\nRe-\nquestaccess_denied token 错误\n400 Bad\nRe-\nquestexpired_tokentoken 过期\n400 Bad\nRe-\nquestinvalid_request 非法请求，请检查参数； 1. JSON 格式是否正确？ json validator 验\n证2. notify_url 参数是否已登记到 Publisher[ 接收支付IPN通\n知URL]？\n9.常见问题\n1.限购商品被多次购买\n•问题描述 ：\n因国外在线支付特性，用户下单到最终支付成功可能间隔较长时间，因此有可能出现“限量商品被\n多次购买”的问题。游戏收到平台发货通知时，无法向用户发放多次购买的物品。\n•解决方案 ：\n限购商品在用户购买时让用户 明确知道是限购商品 。出现多次购买的情况，发放 等额钻石补偿 ，\n并向平台上报发货成功 。\n2.物品发给玩家后，再次收到发货通知\n•问题描述 ：\n由于网络等原因，向平台上报发货状态时，可能平台没有收到发货状态。这种情况下，平台会不\n断重试向游戏服务器发送发货通知。\n•解决方案:支付接口 22\n每次收到发货通知后，检查是否已经发货成功，若已经发货成功，不发货，直接调用 通知平台订\n单的发货成功状态 接口，再次 向平台上报发货成功 。\n3.用户不在线，无法收货（仅限部分游戏）\n•问题描述\n部分游戏由于架构的原因，用户不在线时，无法收货。\n•解决方案\n参考快递的做法，并非只有直接交给用户才算投递成功，将物品放入用户的邮箱中也是投递成功\n的一种方式。\n因此，收到发货通知后，将订单支付成功的状态存入数据库，并 确保用户下次登录能够收到物品\n时，即可 向平台上报发货成功 。\n此外，目前已知有些游戏会将支付成功结果暂存在 Redis 等临时存储中，并设置超时时间，比\n如一个小时，造成用户在一小时内不登录游戏，就无法收货的情况。这种情况下， 必须更改架构 ，\n确保用户下次登录一定能够收到物品。9.切换到正式环境 1"
    },
    {
        "data": "的一种方式。\n因此，收到发货通知后，将订单支付成功的状态存入数据库，并 确保用户下次登录能够收到物品\n时，即可 向平台上报发货成功 。\n此外，目前已知有些游戏会将支付成功结果暂存在 Redis 等临时存储中，并设置超时时间，比\n如一个小时，造成用户在一小时内不登录游戏，就无法收货的情况。这种情况下， 必须更改架构 ，\n确保用户下次登录一定能够收到物品。9.切换到正式环境 1\nimport Callout from ‘nextra-theme-docs/callout ’\n9.切换到正式环境\n9.1账号接口参数切换\n请注意\n需要更换的参数有 API host ，以及 app_secret\nAPI host\n测试环境 https://h5.stg.g123.jp\n正式环境 https://h5.g123.jp\nGET :https://h5.g123.jp/api/v1/user?appId={\"{app_id}\"}&appSecret={\"{app_secret}\"}&code={\"{access_code}\"}\n9.2支付接口参数切换\n请注意\n需要更换的参数有请求 token 用的 client ID 与client Secret ，以及 3.支付流程 的各个 API\nhost，请注意不要遗漏 3.3启动支付窗口 中的 API host 。\nAPI host\n测试环境 https://psp.stg.g123.jp\n正式环境 https://psp.g123.jp\n9.3广告创角转化 post message 参数切换9.切换到正式环境 2\npostMessage 参数\n测试环境 https://h5.stg.g123.jp\n正式环境 https://h5.g123.jp\n完成切换后游戏的正式入口地址为 https://h5.g123.jp/game/{app_id}常见问题 1\n常见问题\n1.游戏账号丢失 A:系统默认发放的 guest 账号信息保存在浏览器缓存中，若清除了缓存和\ncookie 则账号信息会丢失。可以通过在游戏内将账号绑定 SNS社交账号（ twiiter 、LINE 等）\n来避免账号丢失。\n2.获取 userId 时出错的常见原因\n1. code过期，请重新加载页面从游戏入口中获取新的 code"
    },
    {
        "data": "常见问题\n1.游戏账号丢失 A:系统默认发放的 guest 账号信息保存在浏览器缓存中，若清除了缓存和\ncookie 则账号信息会丢失。可以通过在游戏内将账号绑定 SNS社交账号（ twiiter 、LINE 等）\n来避免账号丢失。\n2.获取 userId 时出错的常见原因\n1. code过期，请重新加载页面从游戏入口中获取新的 code\n2. API Host 选取错误，请注意区分测试环境与正式环境 ,点此查询\n3.调用 API地址书写错误\n4. appId 与 appSecret 参数错误\n3.对接过程中出现异常错误 请首先尝试连接 VPN验证是否为网络问题。\n4.平台游戏要适配的屏幕分辨率、主要是哪几种？ 需要在主流 PC和Mobile 的浏览器上适配。\n可以参考这里各个设备的 Viewport 值 https://blisk.io/devices\n5.游戏系统运维部署方面是怎样安排的？ 请使用平台的 Publisher 工具进行游戏的部署等操作。\n系统组件与应用程序的监控与日志可以在 Grafana Cloud 内确认。\n6.国际化对应的时候，游戏获取到平台传来的币种后，具体商品的价格如何转换 ?商品的价格不需\n要转换，运营负责人会提供不同的币种下的商品价目表。参考： 国际化文档\n7.平台支持的浏览器版本有哪些？ 平台使用开源的 浏览器代码编译级别 来保证绝大多数浏览器的兼\n容（部分过旧版本的浏览器访问游戏可能会出错） ,当前平台设置的规则是\n> 1% in JP,\n> 1%,not IE 11\n当前对应的浏览器范围是： and_chr 103 、chrome 103 、chrome 102 、chrome 101 、edge\n103、edge 102 、edge 101 、firefox 101 、ios_saf 15.5 、ios_saf 15.4 、ios_saf 14.5-\n14.8、safari 15.5 、samsung 17.0为平台活动提供的事件触发 1\n为平台活动提供的事件触发\n平台会在某些时候需要获取游戏内的事件，并根据事件开展活动。为防止作弊，需要 CP和平台进行 服\n务器间的通讯协作。\n1.level_up 事件\nCP对应流程\n1.创建事件：当用户每次升级时 , CP游戏服务器向平台服务器发送事件，平台返回响应消息"
    },
    {
        "data": "14.8、safari 15.5 、samsung 17.0为平台活动提供的事件触发 1\n为平台活动提供的事件触发\n平台会在某些时候需要获取游戏内的事件，并根据事件开展活动。为防止作弊，需要 CP和平台进行 服\n务器间的通讯协作。\n1.level_up 事件\nCP对应流程\n1.创建事件：当用户每次升级时 , CP游戏服务器向平台服务器发送事件，平台返回响应消息\n2.触发事件： CP游戏服务器将收到的响应消息推送至游戏前端 ,前端再将该信息通过 win-\ndow.top.postMessage 发送到平台主窗口完成触发。\n注:游戏服务器端 要确保用户确实升级\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp\n此外， 该流程使用登录流程的 appId 和appSecret ， 参见 https://developers.g123.jp/login.html#_1-\n%E7%99%BB%E5%BD%95\n1.1创建事件\nPOST /api/v1/cp/game_event/level_up\nRequest Header 使用 Basic认证方式发送 appId 和 appSecret为平台活动提供的事件触发 2\nRequest header Description\nContent-Type application/json\nAuthorization Basic base64( ‘𝑎𝑝𝑝𝐼 𝑑 ∶ appSecret ’)\nRequest Body\nRequest Body F ormat V alue Required\nuid string 用户游戏唯一标示 id Y es\nserver_id string 用户所在游戏服 id Y es\nctwid string g123 平台生成 id Y es\ntimestamp long 事件发生时间 (UNIX 时间单位 :ms) Y es\nlevel integer 用户级别 Y es\nResponse Body 状态码 : 200消息内容： JSON 格式的返回数据\n注:返回的数据格式可能会在正式版本发布时有所变动，请在 1.2前端事件触发这一步中，将返回数\n据全部通过 postMessage 提交\n示例"
    },
    {
        "data": "timestamp long 事件发生时间 (UNIX 时间单位 :ms) Y es\nlevel integer 用户级别 Y es\nResponse Body 状态码 : 200消息内容： JSON 格式的返回数据\n注:返回的数据格式可能会在正式版本发布时有所变动，请在 1.2前端事件触发这一步中，将返回数\n据全部通过 postMessage 提交\n示例\ncurl -i -X POST \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization:Basic $(echo -n $APP_ID:$APP_SECRET | openssl base64 -A)\" \\\n-d \\\n'{\n\"uid\": \"123\",\n\"server_id\": \"s73\",\n\"ctwid\": \"GIL6T4CO\",\n\"timestamp\": 1605076260715,\n\"level\": 10\n}' \\\n'https://h5.stg.g123.jp/api/v1/cp/game_event/level_up'为平台活动提供的事件触发 3\nOUTPUT:\nHTTP/1.1 200 OK\nvary: accept-encoding\ncontent-type: application/json;charset=UTF-8\ntransfer-encoding: chunked\ndate: Wed, 11 Nov 2020 07:53:51 GMT\nconnection: close\n{\"action\":\"game_event_created\",\"id\":\"1\",\"token\":\"fdda6c9f-5745-4adc-9541-c3827d654dfa\"}\n注:返回的数据格式今后可能会发生变更，请将平台返回的完整消息传递到前端进行触发\n1.2前端事件触发\n将平台服务器的返回的消息，在前端通过 window.top.postMessage 传递到平台\nwindow.top.postMessage(responseData, '*');CP需要提供的接口 1\nimport Callout from ‘nextra-theme-docs/callout ’\nCP需要提供的接口\n游戏玩家角色查询接口\n•调用方式： HTTP POST"
    },
    {
        "data": "1.2前端事件触发\n将平台服务器的返回的消息，在前端通过 window.top.postMessage 传递到平台\nwindow.top.postMessage(responseData, '*');CP需要提供的接口 1\nimport Callout from ‘nextra-theme-docs/callout ’\nCP需要提供的接口\n游戏玩家角色查询接口\n•调用方式： HTTP POST\n•使用场景：平台查询玩家在游戏中每个区服的角色信息\n注意： -安全策略：接口需增加 IP白名单\nRequest Body\n参数 示例 签名 说明\nappID ceruhor 是 G123平台发行的的\nappID\nCTWID G123ABC 是 玩家在 G123平台的\nID\nserver 1 是 游戏区服编号，如该字段\n为空，则需返回改玩家在\n游戏内所有区服的角色信\n息\ntime 1571192005377 是 服务端时间戳 13位 [毫\n秒]\nsign\n‘9397176eabd8c494946df910d98a41f2 ’否 签名规则\nResponse\n{\n\"code\" : 200 ,\n\"message\" : \"success\" ,CP需要提供的接口 2\n\"data\" :[\n{\n\"server\" : 1, //游戏区服，如单个区服有多个角色，需以多个数据返回\n\"roleName\" : \"アイウエオ \", //角色名称\n\"roleId\" : 12 , //角色 id\n\"level\" : 13 , //等级\n\"vipLevel\" : 1 // vip等级\n},\n{\n\"server\" : 10 , //游戏区服\n\"roleName\" : \"剑仙 2\", //角色名称\n\"roleId\" : 13 , //角色 id\n\"level\" : 5, //等级\n\"vipLevel\" : 10 // vip等级\n},\n{\n\"server\" : 218 , //游戏区服\n\"roleName\" : \"剑仙 2\", //角色名称\n\"roleId\" : 14 , //角色 id\n\"level\" : 170 , //等级\n\"vipLevel\" : 13 // vip等级\n}\n]\n}\n异常\n{\n\"code\" : 401 ,\n\"message\" :\"params error\" //参数错误"
    },
    {
        "data": "},\n{\n\"server\" : 218 , //游戏区服\n\"roleName\" : \"剑仙 2\", //角色名称\n\"roleId\" : 14 , //角色 id\n\"level\" : 170 , //等级\n\"vipLevel\" : 13 // vip等级\n}\n]\n}\n异常\n{\n\"code\" : 401 ,\n\"message\" :\"params error\" //参数错误\n}CP需要提供的接口 3\n签名规则\n将属于签名的参数列表，按照参数名称字母先后顺序排序 : key1=value1 …. keyN=valueN 。\nvalueN 需过滤特殊字符，使用 php:rawurldecode 等进行解密说明： + php 的 rawur-\nlencode 和 urlencode 区别是在空格加密不一样， rawurlencode:%20 urlencode:+ +\nphp的 rawurlencode 和 js的 encodeURIComponent 遵循的是国际标准备忘录 RFC\n3986，理论上可互通 + js的 base64 库\n•将分配的得到的密钥（ callbackKey ）接到参数字符串尾部进行 md5加密（ UTF8 编码）\n•格式是： md5(key1=value1key2=value2 …callbackKey)\n<?php\n$data =array (\n\"appId\" => $appId ,\n\"CTWID\" => $money ,\n\"server\" => $server ,\n\"time\" => $time ,\n\"xxxx\" => $xxxx ,\n$sign =generateSign( $data , $callbackKey );\n/**\n*签名算法\n*/\nfunction generateSign( $data ,$callbackKey ='' )\n{\nif (empty ($data ))\nreturn '' ;\nksort ($data );\n$str = \"\" ;\nforeach ($data as $k => $v)\n$str .= sprintf (\"%s=%s\" , $k ,$v);\nreturn md5 (sprintf (\"%s%s\" ,$str ,$callbackKey ));CP需要提供的接口 4\n}数据接口 1"
    },
    {
        "data": "{\nif (empty ($data ))\nreturn '' ;\nksort ($data );\n$str = \"\" ;\nforeach ($data as $k => $v)\n$str .= sprintf (\"%s=%s\" , $k ,$v);\nreturn md5 (sprintf (\"%s%s\" ,$str ,$callbackKey ));CP需要提供的接口 4\n}数据接口 1\nimport Callout from ‘nextra-theme-docs/callout ’\n数据接口\nG123平台有完善的数据体系，通过获取游戏内的打点数据反应运营活动的效果，需要 CP配合做数\n据上报数据上报分为 两部分：1.浏览器主窗口数据上报 2.服务器间事件上报 -请务必在上线前将下\n列数据上报给平台！ ！ ！ 若没完成所有事件上报 ,将无法再平台上线后进行推广 。\nCP校验方法： 1. Publisher 平台 ->调试工具\n1.浏览器主窗口数据上报\n游戏前端需要将下面指定的日志数据，通过向浏览器主窗口 postMessage ，上报到平台。\n1.1参数\nParameter F ormat Required V alue Example\nversion string Y es v2 请指定版本为” v2”\naction string Y es g_init ( 其他类型参照 事件类型 ）用例\ndata json Y es 参照事件内容 用例\n1.2事件类型action\n下列类型的日志、请与平台数据开发人员确认埋点位置后、接入：\n值 名称 调用条件\ng_init 游戏初始化开始 游戏初始化代码开始执行时上报\ng_register 注册游戏事件 游戏生涯首次接收到平台 ID时上报，用户生涯仅一次。数据接口 2\n值 名称 调用条件\ng_createrole 广告用创角事件 新玩家进入游戏后 第一次点击事件 时上报，如： 1.第一\n次游戏有开屏动画的情况下，玩家 点击屏幕（下一\n步）或点击“跳过” （ skip）时打点 2.第一次\n游戏需要用户手动创角的情况下，玩家 点击“创建角\n色”时打点 3.新手教程中玩家 根据引导进行第\n一次点击 时打点如同时存在上述情况，请以玩家最先\n遇到的情况为准注：用户生涯 仅一次（老用户换服无需上\n报）"
    },
    {
        "data": "次游戏有开屏动画的情况下，玩家 点击屏幕（下一\n步）或点击“跳过” （ skip）时打点 2.第一次\n游戏需要用户手动创角的情况下，玩家 点击“创建角\n色”时打点 3.新手教程中玩家 根据引导进行第\n一次点击 时打点如同时存在上述情况，请以玩家最先\n遇到的情况为准注：用户生涯 仅一次（老用户换服无需上\n报）\ng_login 登录游戏事件 老玩家登录游戏时上报\ng_payrequest 发起支付事件 前端所有用戶点击了会触发”调起支付”的地方\ng_payend 支付事件结束 当玩家经由付款并发货完成时触发\ng_milestone 完成里程碑事件 玩家在进行如下行为时上报： 1.玩家完成主线任务 2.\n玩家挑战关卡（成功 /失败）具体案例\ng_click 点击对象事件 玩家在游戏内点击某埋点对象时 e.g.玩家点击游戏内功\n能 (如强化、突破、购买礼包 )\n触发逻辑线 -【游戏启动】按时间线触发 g_init →g_register -【新玩家】按时间线触发\ng_register →g_createrole →g_logout (新玩家注册时不要触发 g_login ) -【老\n玩家】按时间线触发 g_login →g_logout (老玩家登录以及换服时不要触发 g_register\n和 g_createrole )\n事件细节说明 -【新 /老玩家】其他事件 g_milestone 平台的运营会根据自己的需求、提要求自\n定义埋点、请届时配合对应。 -【新 /老玩家】其他事件 g_click 玩家最终点击礼包购买按钮之前 (包\n含点击礼包购买按钮 )， 所产生的全部图标点击事件。 -例1：点击主屏幕某礼包 /活动按钮 (g_click\nid:活动 id desc: 留空 ) ->引导至礼包浏览页面 ->点击某礼包的购买按钮 (g_click id: 活动\nid desc: 礼包 id) -例2：点击主屏幕商店按钮 (g_click id: 商店 id desc: 礼包 id) -> 引\n导至某个礼包分页 ->点击某礼包的购买按钮 (g_click id: 商店 id desc: 礼包 id) -【新 /老\n玩家】其他事件 g_click 玩家点击强化、突破等消耗道具的功能时，道具不足导致失败时上报打点。"
    },
    {
        "data": "id desc: 礼包 id) -例2：点击主屏幕商店按钮 (g_click id: 商店 id desc: 礼包 id) -> 引\n导至某个礼包分页 ->点击某礼包的购买按钮 (g_click id: 商店 id desc: 礼包 id) -【新 /老\n玩家】其他事件 g_click 玩家点击强化、突破等消耗道具的功能时，道具不足导致失败时上报打点。\n-例 1：点击强化按钮 ->提示强化失败，原因缺失道具 ->上报点击事件 (g_click id: 功能 id\ndesc:缺失道具 :数量 )数据接口 3\n-请注意： g_register 与 g_createrole 事件玩家生涯只能触发一次，换服后不要重复触发。\n1.3事件内容data\n::: data 字段 :::\ncolumns format description required 注\ngame_server_id string 游戏区服 id Y es 游戏服 ID,例：\n日本 12服，则\n该值为 12,如\n无区服则默认为\n1。始终取玩家\n当前的游戏服，\n例如合服后取新\n服 ID\ngame_user_id string CP 数据库玩家账号 Y es 游戏数据库分配\n的账号唯一标识\nitem object item 相关字段 Y es 道具相关信息\n(仅支付相关事\n件)\nrole object 用户相关字段 Y es 玩家属性信息\ncustom object 自定义字段 Y es 针对埋点对象所\n需传值的自定义\n项\n::: item 字段 :::数据接口 4\ncolumn format description required 注\nid string 商品 id Y es 埋点\n对象\nID，\n只允\n许字\n母\n(let-\nter)、\n数字\n(num-\nber)、\n-\n(dash)\n或\n_(un-\nder-\nline).\ng_tutorial\n时必\n传\ntype string 商品类型 Y es menu/tab/button/gift/gacha/card/item\n等，\n根据\n具体\n事件\n区分，\n默认\n为空\nname string 商品名 Y es 默认\n为空\ncount string 商品总量 Y es 默认\n为空数据接口 5\ncolumn format description required 注"
    },
    {
        "data": "g_tutorial\n时必\n传\ntype string 商品类型 Y es menu/tab/button/gift/gacha/card/item\n等，\n根据\n具体\n事件\n区分，\n默认\n为空\nname string 商品名 Y es 默认\n为空\ncount string 商品总量 Y es 默认\n为空数据接口 5\ncolumn format description required 注\nprice string 商品价格 Y es 默认\n为空\nbalance string 商品剩余量 Y es 默认\n为空\ndesc string 商品描述 Y es g_tutorial\n事件\n时不\n能为\n空数据接口 6\ncolumn format description required 注\ncontent string 商品内容 Y es 商品\n包含\n的 {\n“{子\n对象\n的\nID}”\n} /\n{“{子\n对象\n的数\n量}”\n}，多\n个子\n对象\n时前\n述组\n合以\n逗号\n(,)\n分\n隔， 如\nIDa/2,IDb/1 。\n默认\n数量\n请传\n1。\nreferer string 商品的上一跳转名称 Y es 默认\n为空\npayment_type string 付费方式，各种虚拟货币 Y es 默认\n为空数据接口 7\ncolumn format description required 注\ncustom object item中的其他内容 Y es 默认\n为空\n::: role 字段 :::\ncolumn format description required 注\nid string 角色 id Y es 角色在当\n前区服的\n用户角色\nid\nname string 角色姓名 Y es 角色在当\n前区服的\n用户角色\n姓名\nlevel string 角色等级 Y es\nexp string 角色经验值 Y es\nvip_level string 角色 VIP等级 Y es\nvip_exp string 角色 VIP经验 Y es\nvirtual_balance string 游戏内通货 Y es 例： “ vir-\ntual_balance ”\n: {\n“dia-\nmond”\n: 1234,\n“gold”:\n567000\n},根据\n游戏内货\n币名称填\n写数据接口 8"
    },
    {
        "data": "vip_level string 角色 VIP等级 Y es\nvip_exp string 角色 VIP经验 Y es\nvirtual_balance string 游戏内通货 Y es 例： “ vir-\ntual_balance ”\n: {\n“dia-\nmond”\n: 1234,\n“gold”:\n567000\n},根据\n游戏内货\n币名称填\n写数据接口 8\ncolumn format description required 注\ncustom object role中的其他内容 Y es 必传\nreg_server_id ,\n描述如下\n请注意： role.custom 中必带的一个栏位是 reg_server_id | column | format | value\n| required| | —— -|—— - |——— |——– | | reg_server_id | string | 合服或换服玩家的\n初始注册区服号 ,无此行为的玩家默认为当前注册区服号 | Y es|\n1.4用例\n用例 1：g_init 游戏初始化成功事件 点击查看 : g_init\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_init\" ,\n\"data\" : {\n\"custom\" :{\n\"message\" : \"initGame\"\n}\n}\n}),'*');\n用例 2：g_register 用户登录事件 点击查看 : g_register\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_register\" ,\n\"data\" : {\n\"game_server_id\" :\"1\" ,//current serverid\n\"game_user_id\" :\"1234567\" ,\n\"role\" :{数据接口 9\n\"id\" :\"3444382\" ,\n\"name\" :\"G123太郎 \",\n\"level\" :\"1\" ,\n\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,"
    },
    {
        "data": "\"game_user_id\" :\"1234567\" ,\n\"role\" :{数据接口 9\n\"id\" :\"3444382\" ,\n\"name\" :\"G123太郎 \",\n\"level\" :\"1\" ,\n\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"custom\" :{\n//保留字段\n}\n}\n}),'*');\n用例 3：g_createrole 用户创角事件 点击查看 : g_createrole\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_createrole\" ,\n\"data\" : {\n\"game_server_id\" :\"1\" ,//current serverid\n\"game_user_id\" :\"1234567\" ,//Unique useridforyourgame\n\"role\" :{\n\"id\" :\"3444382\" ,//Unique roleidfortheserver\n\"name\" :\"G123太郎 \",\n\"level\" :\"1\" ,\n\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,数据接口 10\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"custom\" :{\n//保留字段\n}\n}\n}),'*');\n用例 4：g_login 用户登录事件 点击查看 : g_login\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_login\" ,\n\"data\" : {"
    },
    {
        "data": "}\n},\n\"custom\" :{\n//保留字段\n}\n}\n}),'*');\n用例 4：g_login 用户登录事件 点击查看 : g_login\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_login\" ,\n\"data\" : {\n\"game_server_id\" :\"1\" ,//current serverid\n\"game_user_id\" :\"1234567\" ,\n\"role\" :{\n\"id\" :\"3444382\" ,\n\"name\" :\"G123太郎 \",\n\"level\" :\"1\" ,\n\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},数据接口 11\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"custom\" :{\n//保留字段\n}\n}\n}),'*');\n用例 5：g_payrequest 用户发起支付事件 点击查看 : g_payrequest\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_payrequest\" ,\n\"data\" : {\n\"game_server_id\" :\"1\" ,//current serverid\n\"game_user_id\" :\"1234567\" ,\n\"role\" :{\n\"id\" :\"3444382\" ,\n\"name\" :\"G123太郎 \",\n\"level\" :\"1\" ,\n\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"item\" :{数据接口 12"
    },
    {
        "data": "\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"item\" :{数据接口 12\n\"id\" :\"\" ,\n\"type\" :\"\" ,\n\"name\" :\"\" ,\n\"count\" :\"\" ,\n\"price\" :\"\" ,\n\"balance\" :\"\",\n\"desc\" :\"\" ,\n\"content\" :\"\",\n\"referer\" :\"\",\n\"payment_type\" : \"\" ,\n\"custom\" : {}\n},\n\"custom\" :{\n//保留字段\n}\n}\n}),'*');\n用例 6：g_payend 用户支付结束事件 点击查看 : g_payend\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_payend\" ,\n\"data\" : {\n\"game_server_id\" :\"1\" ,//current serverid\n\"game_user_id\" :\"1234567\" ,\n\"role\" :{\n\"id\" :\"3444382\" ,\n\"name\" :\"G123太郎 \",\n\"level\" :\"1\" ,\n\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {数据接口 13\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"item\" :{\n\"id\" :\"\" ,\n\"type\" :\"\" ,\n\"name\" :\"\" ,\n\"count\" :\"\" ,\n\"price\" :\"\" ,\n\"balance\" :\"\",\n\"desc\" :\"\" ,\n\"content\" :\"\",\n\"referer\" :\"\",\n\"payment_type\" : \"\" ,"
    },
    {
        "data": "}\n},\n\"item\" :{\n\"id\" :\"\" ,\n\"type\" :\"\" ,\n\"name\" :\"\" ,\n\"count\" :\"\" ,\n\"price\" :\"\" ,\n\"balance\" :\"\",\n\"desc\" :\"\" ,\n\"content\" :\"\",\n\"referer\" :\"\",\n\"payment_type\" : \"\" ,\n\"custom\" : {}\n},\n\"custom\" :{\n\"order_no\" :\"01232343434343434\" //ordernogenerated byg123\n}\n}\n}),'*');\n用例 7：g_milestone 用户完成里程碑事件 milestone 的格式必需遵循下面规范\n{\"milestone\" :{ \"name\" :\"英文描述 :对应章节 \"}\n例 1：当用户完成任务时\n{\"milestone\" :{ \"name\" :\"completeTask:1\" }\n例 2：当用户挑战章节关卡 成功时数据接口 14\n{\"milestone\" :{ \"name\" :\"MapProgress:1-1\" }\n例 3：当用户挑战章节关卡 失败时\n{\"milestone\" :{ \"name\" :\"MapFailed:1-1\" }\n点击查看 : g_milestone\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_milestone\" ,\n\"data\" : {\n\"game_server_id\" :\"1\" ,//current serverid\n\"game_user_id\" :\"1234567\" ,\n\"role\" :{\n\"id\" :\"3444382\" ,\n\"name\" :\"G123太郎 \",\n\"level\" :\"1\" ,\n\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"custom\" :{"
    },
    {
        "data": "\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"custom\" :{\n\"milestone\" :{\"name\" :\"MapProgress:1-1\" }//e.g.通过章节 1-1\n}\n}\n}),'*');数据接口 15\n用例 8：g_click 用户点击事件 点击查看 : g_click\nwindow.top.postMessage(JSON.stringify( {\n\"version\" :\"v2\" ,\n\"action\" : \"g_click\" ,\n\"data\" : {\n\"game_server_id\" :\"1\" ,//current serverid\n\"game_user_id\" :\"1234567\" ,\n\"role\" :{\n\"id\" :\"3444382\" ,\n\"name\" :\"G123太郎 \",\n\"level\" :\"1\" ,\n\"exp\" :\"1\" ,\n\"vip_level\" :\"0\" ,\n\"vip_exp\" :\"0\" ,\n\"virtual_balance\" : {\n\"diamond\" :\"1234\" ,\n\"gold\" :\"567000\"\n},\n\"custom\" : {\n\"reg_server_id\" : \"1\"//serveridwhereg_register occurred\n}\n},\n\"custom\" :{\n\"click\" :{\n\"desc\" :\"200005:1|20006:1\" ,//缺失道具 _1:数量|缺失道具 _2:数量\n\"id\":\"13\" ,//点击的对象 id\n\"name\" :\"qianghua\" //点击的对象名称\n}\n}\n}\n}),'*');数据接口 16\n1.5测试\n•前提：账号，支付对接完成\n•登录游戏测试环境： https//h5.stg.g123.jp/game/{appId} ， 使用平台提供的 数\n据校验工具 自查无误后，请通知平台方验收\n1.5.1 数据校验工具概览"
    },
    {
        "data": "\"id\":\"13\" ,//点击的对象 id\n\"name\" :\"qianghua\" //点击的对象名称\n}\n}\n}\n}),'*');数据接口 16\n1.5测试\n•前提：账号，支付对接完成\n•登录游戏测试环境： https//h5.stg.g123.jp/game/{appId} ， 使用平台提供的 数\n据校验工具 自查无误后，请通知平台方验收\n1.5.1 数据校验工具概览\n• Debugging Result: 当前游戏账号下打点校验情况总览\n• Event Details: 当前所选中的打点事件详细视图显示\n–Event Payload View: 显示打点事件类型及 payload 内容\n–Event V alidation Result: 是否通过打点校验，若有问题则展示错误原因，其中细\n分为三个分项 :\n∗Schema V alidation Result: 验证当前打点事件的 payload 是否符合\nschema 验证条件\n∗Logic Flow V alidation Result: 验证当前打点事件是否存在逻辑错误，即\n对于特定事件类型，不多发，不漏发，且与其他关联事件的触发时间先后顺序是否无\n误\n∗Property Mismatch V alidation Result: 验证当前事件流的 game相\n关打点事件 (g_xxx) 打点与支付相关打点事件 (p_xxx) 中， 同一 property\n的值是否一致\n• Timeline: 按打点事件触发时间顺序排列， 顶端为最新发生的事件。 黑色代表打点正确， 红色代\n表打点错误\n数据接口 17\n1.5.2 所支持的打点类型\n•游戏相关事件 (g_xxx): g_register, g_createrole, g_login, g_payrequest,\n…etc.\n•支付相关事件 (p_xxx): p_payinit, p_paystart, p_paysucceed, …etc.\n-工具中出现的平台触发的事件（ p_xxx ）,来源于游戏的前后端打点，或来源于 CP接入平台接口\n（账号，支付）时上传的数据，故 p_xxx 事件有报错时，请根据工具中 Timeline 的事件名描述找\n到相关事件的源头，进行确认和修改"
    },
    {
        "data": "…etc.\n•支付相关事件 (p_xxx): p_payinit, p_paystart, p_paysucceed, …etc.\n-工具中出现的平台触发的事件（ p_xxx ）,来源于游戏的前后端打点，或来源于 CP接入平台接口\n（账号，支付）时上传的数据，故 p_xxx 事件有报错时，请根据工具中 Timeline 的事件名描述找\n到相关事件的源头，进行确认和修改\n1.5.3 CP 方自查方法 CP方技术人员若定位到 Timeline 中有问题埋点， 可以在 Timeline\n上点击对应的事件，并在 Event V alidation Result 中查看问题点\nSchema V alidation Result Issue 例:点击 p_paysucceed 事件，发现错误为\nmust have required property 'game_user_id' ,经检查 payload 发现缺失该\nproperty\nLogic Flow V alidation Result Issue 例:点击 g_register 事件，发现错误为\ng_register 事件前必须有 g_init事件 ,经检查 Timeline 发现， g_init 事件缺失数据接口 18\nProperty Mismatch V alidation Result Issue 例：点击 p_paysucceed\n事件，发现错误为 game_server_id 与 g_levelup 事件中的值不一致 ,由\n上面 1的举例可知 g_levelup( 来源服务器端 level_up 打点 )缺失 game_server_id\nproperty ， 因 此 必 然 与 p_paysucceed 事 件 中 的 game_server_id 值 不 一 致\n数据接口 19\n2.服务器间事件上报\n服务器端事件目前主要用于含有奖励的活动（如：升到指定级别发送 PayPay 红包） ，以及成果报酬\n型广告（如：通过第三方积分网站进入游戏，升到指定级别向用户发放第三方积分） 。因此需要游戏服务\n器和平台服务器间通讯以确保数据可靠性，防止作弊。\n2.1升级 (level_up)\n当用户达到升级时 , CP游戏服务器向平台服务器发送事件，平台返回响应消息\n环境参数\n系统 环境 API Host"
    },
    {
        "data": "服务器端事件目前主要用于含有奖励的活动（如：升到指定级别发送 PayPay 红包） ，以及成果报酬\n型广告（如：通过第三方积分网站进入游戏，升到指定级别向用户发放第三方积分） 。因此需要游戏服务\n器和平台服务器间通讯以确保数据可靠性，防止作弊。\n2.1升级 (level_up)\n当用户达到升级时 , CP游戏服务器向平台服务器发送事件，平台返回响应消息\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp\n此外，该流程使用登录流程的 appId 和 appSecret ，参见账号接口\nEndpoint POST {API Host}/api/v1/cp/game_event/level_up\nRequest Header 使用 Basic认证方式发送 appId 和 appSecret\nRequest header Description\nContent-Type application/json\nAuthorization Basic base64( ‘𝑎𝑝𝑝𝐼 𝑑 ∶ appSecret ’)\nRequest Body数据接口 20\nRequest\nBody F ormat V alue Required\ngame_server_id string 用户所在游戏服 id Y es\nctwid string g123 平台生成 id Y es\ntimestamp long 事件发生时间 (UNIX 时间单位 :ms) Y es\nlevel integer 用户级别 Y es\ndata object 数据系统用 Y es\n::: data 字段 :::\ncolumns format value required 注\ngame_server_id string 游戏区服 id Y es 游戏服 ID,例：\n日本 12服，则\n该值为 12,如\n无区服则默认为\n1。始终取玩家\n当前的游戏服，\n例如合服后取新\n服 ID\ngame_user_id string CP 数据库玩家账号 Y es 游戏数据库分配\n的账号唯一标识\nrole object 用户相关字段 Y es 玩家属性信息\ncustom object 自定义字段 Y es 针对埋点对象所\n需传值的自定义\n项，目前必传项"
    },
    {
        "data": "日本 12服，则\n该值为 12,如\n无区服则默认为\n1。始终取玩家\n当前的游戏服，\n例如合服后取新\n服 ID\ngame_user_id string CP 数据库玩家账号 Y es 游戏数据库分配\n的账号唯一标识\nrole object 用户相关字段 Y es 玩家属性信息\ncustom object 自定义字段 Y es 针对埋点对象所\n需传值的自定义\n项，目前必传项\n为 physi-\ncal_server\n（如该 uid触发\n事件所在物理服\n务器的域名信\n息） 。数据接口 21\nRequest 示例点击查看 : Request Example\ncurl -i -X POST \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization:Basic $(echo -n $APP_ID:$APP_SECRET | openssl base64 -A)\" \\\n-d \\\n'{\n\"game_server_id\": \"1\",\n\"ctwid\": \"GIL6T4CO\",\n\"timestamp\": 1605076260715,\n\"level\": 10,\n\"data\": {\n\"game_server_id\": \"1\",\n\"game_user_id\":\"1234567\",\n\"role\": {\n\"id\":\"3444382\",\n\"name\":\"G123 太郎 \",\n\"exp\":\"1\",\n\"vip_level\":\"0\",\n\"vip_exp\":\"0\",\n\"virtual_balance\": {\n\"diamond\": \"1234\",\n\"gold\": \"567000\"\n},\n\"custom\": {\n\"reg_server_id\": \"1\" // server id where g_register occurred\n}\n},\n\"custom\":{\n\"device_id\": \"\",\n\"physical_server\": \"$SERVER_HOST|$SERVER_IP\"\n}\n}\n}' \\数据接口 22\n'https://h5.stg.g123.jp/api/v1/cp/game_event/level_up'\nResponse Body\n•状态码 : 200\n•消息内容： JSON 格式的返回数据7. GM 接口 [选接 ] 1"
    },
    {
        "data": "\"device_id\": \"\",\n\"physical_server\": \"$SERVER_HOST|$SERVER_IP\"\n}\n}\n}' \\数据接口 22\n'https://h5.stg.g123.jp/api/v1/cp/game_event/level_up'\nResponse Body\n•状态码 : 200\n•消息内容： JSON 格式的返回数据7. GM 接口 [选接 ] 1\n7. GM 接口 [选接 ]\n本文档作为 G123 GM 工具接入说明首页，概述了接入 GM工具， CP所需要提供的 API类\n型和实现规范。接入前登入 Publisher 工具–>[G123 接入 ]–>[GM 工具 ]查看 API类型。\n7.1涉及的系统\n接入流程： CP确认接入文档– >实现 API–>在Publisher 工具填写 API–>GM 工具测试\n7.1.1 公告邮件 API\n•功能：该 API允许发送各种类型的邮件，包括全服邮件、个人邮件、公告板和跑马灯消息。\n•模块：\n–全服邮件：处理向所有玩家发送全服邮件的功能。\n–个人邮件：管理向个别玩家发送个人邮件的功能。\n–公告板：方便在公告板上发布和检索消息。\n–跑马灯：控制导航页上滚动消息的显示。\n7.1.2 玩家管理 API\n•功能：该 API提供了管理与玩家相关数据的功能。\n•模块：\n–玩家检索：根据条件搜索特定玩家。\n–玩家详情查询：获取特定玩家的详细信息。\n–玩家重命名：运营更改玩家游戏内名称。\n–玩家日志查询：提供玩家活动日志的访问，用于审计目的。\n–玩家数据导入：向游戏测试服导入玩家数据。\n–玩家数据导出：从游戏正式 /测试服导出玩家数据进行分析或备份。\n7.1.3 常用数据 API\n•功能：该 API提供常用游戏数据的访问。7. GM 接口 [选接 ] 2\n•模块：\n–游戏区服排行榜数据查询：提供检索游戏服务器排行榜数据的功能。\n–游戏服务器数据查询：获取与游戏服务器相关的各种信息。\n–游戏活动结算数据查询：方便检索与游戏活动结算相关的数据。\n–公会数据查询：允许查询和管理公会相关数据。\n–公会重命名：支持更改公会名称。\n–玩家封禁查询：提供玩家封禁信息的访问，用于执行封禁操作。\n–玩家封禁操作：处理与玩家封禁相关的操作。\n–拉取道具资源列表：获取可用道具资源的列表。"
    },
    {
        "data": "–游戏服务器数据查询：获取与游戏服务器相关的各种信息。\n–游戏活动结算数据查询：方便检索与游戏活动结算相关的数据。\n–公会数据查询：允许查询和管理公会相关数据。\n–公会重命名：支持更改公会名称。\n–玩家封禁查询：提供玩家封禁信息的访问，用于执行封禁操作。\n–玩家封禁操作：处理与玩家封禁相关的操作。\n–拉取道具资源列表：获取可用道具资源的列表。\n–拉取 AI礼包条件：方便检索 AI礼包条件。\n7.1.4 高级功能 API\n•功能：该 API提供特定任务的高级功能。\n•模块：\n–充值补单 /养号：处理充值补偿或账号维护。\n–拉取充值礼包：获取游戏内当前的充值礼包类型。\n7.1.5 CP 接入签名规则\n•本系统交互均通过 Basic 认证方式，gmSecret 由Publisher 工具生成，开发需谨慎保\n存，并针对所有接口请求进行 Authorization 验证。\nAuthorization 生成规则 在Publisher 工具–>[GM 工具 ]–>[GM 工具凭证 ]中生成\nsecret 后，使用Base64 方式 encode 字符串$appId:$gmSecret ，例如：\ngmSecret :=\"SECIsY26ho7VV9avWx9DSSeX4DEeeFNmULG\"\nappId:=\"goodgame\"\n//所以 goodgame 的 Authorization 应该是 \"Basic Z29vZGdhbWU6U0VDSXNZMjZobzdWVjlhdld4OURTU2VYNERFZWVGTm1VTEc=\"\nauthorization :=fmt.Sprintf(\"Basic %s\" ,base64.StdEncoding .EncodeToString ([]byte(appId+\":\"+gmSecret )))\n•以下将提供一下常见的实现方式，请按照自己业务需求，框架逻辑实现对应的校验中间件。对于\n已经实现旧版 Auth方式想要改为 Basic认证的 CP用户，请联系平台对应。7. GM 接口 [选接 ] 3\nGo\nimport(\n\"crypto/hmac\"\n\"crypto/sha256\"\n\"encoding/base64\"\n\"fmt\"\n\"net/url\"\n)\nconstmyGmSecret =\"Replace with your App ID\""
    },
    {
        "data": "已经实现旧版 Auth方式想要改为 Basic认证的 CP用户，请联系平台对应。7. GM 接口 [选接 ] 3\nGo\nimport(\n\"crypto/hmac\"\n\"crypto/sha256\"\n\"encoding/base64\"\n\"fmt\"\n\"net/url\"\n)\nconstmyGmSecret =\"Replace with your App ID\"\nconstmyAppId =\"Replace with your GM Secret\"\nfuncBasicAuthMiddleWare ()gin.HandlerFunc {\nreturn func(c*gin.Context){\nreqAppId ,reqSecret ,ok:=c.Request.BasicAuth ()\nif!ok{\nunAuthorized (c)\nc.Abort()\nreturn\n}\nifreqAppId !=myAppId |reqSecret !=myGmSecret {\nunAuthorized (c)\nc.Abort()\nreturn\n}\n}\n}\nfuncunAuthorized (c*gin.Context){\ntypeResp struct{\nStatus int`json:\"status\"`\nMessage string`json:\"message\"`\n}7. GM 接口 [选接 ] 4\nc.JSON(http.StatusUnauthorized ,Resp{Message:\"Unauthorized request\" })\n}\nPython\nfrombase64 importb64decode\nfromfastapi importFastAPI, HTTPException, Request\napp=FastAPI()\nappId=\"Replace with your App ID\"\ngmSecret =\"Replace with your GM Secret\"\n@app.middleware (\"http\")\nasync defauth_middleware(request: Request, call_next):\nauth=request.headers.get( 'Authorization' )\nif notauth:"
    },
    {
        "data": "gmSecret =\"Replace with your GM Secret\"\n@app.middleware (\"http\")\nasync defauth_middleware(request: Request, call_next):\nauth=request.headers.get( 'Authorization' )\nif notauth:\nraiseHTTPException(status_code =401, detail =\"Unauthorized request\" )\n# The Authorization header is in the format: Basic base64encoded(username:password)\n# We need to decode the base64 string and split the username and password\nencoded_credentials =auth.split( ' ')[1] # Removes \"Basic \" to isolate the base64 encoded part\ndecoded_credentials =b64decode(encoded_credentials).decode( 'utf-8')\nusername, password =decoded_credentials.split( ':')\nifusername !=appId orpassword !=gmSecret:\nraiseHTTPException(status_code =401, detail =\"Unauthorized request\" )\nresponse =awaitcall_next(request)\nreturnresponse\nJava\nimport org.springframework .http.HttpStatus ;\nimport org.springframework .stereotype .Component ;7. GM 接口 [选接 ] 5\nimport org.springframework .web.servlet.HandlerInterceptor ;"
    },
    {
        "data": "returnresponse\nJava\nimport org.springframework .http.HttpStatus ;\nimport org.springframework .stereotype .Component ;7. GM 接口 [选接 ] 5\nimport org.springframework .web.servlet.HandlerInterceptor ;\nimport javax.servlet.http.HttpServletRequest ;\nimport javax.servlet.http.HttpServletResponse ;\nimport java.util.Base64;\nimport java.util.StringTokenizer ;\n@Component\npublic classBasicAuthInterceptor implements HandlerInterceptor {\nprivate staticfinalStringAUTHORIZATION_HEADER_KEY =\"Authorization\" ;\nprivate staticfinalStringAUTHORIZATION_HEADER_PREFIX =\"Basic \" ;\nprivate staticfinalStringmyAppId =\"Replace with your App ID\" ;\nprivate staticfinalStringmyGmSecret =\"Replace with your GM Secret\" ;\n@Override\npublicboolean preHandle (HttpServletRequest request ,HttpServletResponse response ,Objecthandler) throwsException {\nStringauthCredentials =request.getHeader (AUTHORIZATION_HEADER_KEY );\nif(!isUserAuthenticated (authCredentials )){\nresponse .setStatus (HttpStatus .UNAUTHORIZED .value());"
    },
    {
        "data": "StringauthCredentials =request.getHeader (AUTHORIZATION_HEADER_KEY );\nif(!isUserAuthenticated (authCredentials )){\nresponse .setStatus (HttpStatus .UNAUTHORIZED .value());\nresponse .setContentType (\"application/json\" );\nresponse .getWriter ().write(\"{\\\"message\\\":\\\"Unauthorized request \\\"}\");\nreturn false;\n}\nreturn true;\n}\nprivate boolean isUserAuthenticated (StringauthCredentials ){\nif(null==authCredentials ){\nreturn false;\n}\nStringencodedCredentials =authCredentials .replaceFirst (AUTHORIZATION_HEADER_PREFIX ,\"\");\nStringdecodedCredentials = newString(Base64.getDecoder ().decode(encodedCredentials ));\nStringTokenizer tokenizer = newStringTokenizer (decodedCredentials ,\":\");7. GM 接口 [选接 ] 6\nStringappId=tokenizer .nextToken ();\nStringgmSecret =tokenizer .nextToken ();\nreturnmyAppId.equals(appId)&&myGmSecret .equals(gmSecret );\n}\n}\nGM Secret 获取登陆 Publisher 工具–>GM 工具获取密钥。\n图 1: gm-secret\n接入时按照以下参数进行测试\n编\n号 字段名 测试值\n1 gmSecret SEC1xXvCkfR1qVhZ2GNWRt2Jk5E5R8hpdEv\n2 appId goodgame"
    },
    {
        "data": "}\n}\nGM Secret 获取登陆 Publisher 工具–>GM 工具获取密钥。\n图 1: gm-secret\n接入时按照以下参数进行测试\n编\n号 字段名 测试值\n1 gmSecret SEC1xXvCkfR1qVhZ2GNWRt2Jk5E5R8hpdEv\n2 appId goodgame\n3 Authorization Basic\nZ29vZGdhbWU6U0VDMXhY dkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=\n7.1.6 平台请求头定义\n•依据 CP接入需求以及降低接入时所填写的 W ebhook 地址数量的期望，我们仅提供以下两\n种 HTTP 方法的填写\n1.平台获取数据 -平台将所有需要从 CP服务器获取数据的接口请求定义为 GET 请求，该请求\n体主要包含 queryType 枚举，如：\n在拉取游戏内道具资源时7. GM 接口 [选接 ] 7\n编号 枚举类型 枚举名\n1 queryType assets\n•按照特定 CP的需求，我们会把 queryType 拼接在 header 中，命名为\nX-Gm-QueryType ，参照拉取道具资源列表\n2.平台创建 /修改游戏内资源 -平台将所有需要在 CP服务器内创建 /修改的请求定义为 POST\n请求，该请求体主要包含操作类型 action 枚举和模板类型 template 枚举，如：\n创建游戏内全服邮件时\n编号 枚举类型 枚举名\n1 action publish\n2 template server_mail\n•按照特定 CP的需求，我们会把 action 拼接在 header 中，命名为 X-Gm-Action ，\n参照全服邮件\n•按照特定 CP的需求，我们会把 template 拼接在 header 中，命名为\nX-Gm-Template ，参照全服邮件\n7.2公告邮件系统\n协议说明\n•本文档意图说明接入 G123 GM 工具内的公告邮件系统所需提供的操作类型。\n•实现了对应接口后，请将 W ebhook 地址填入 Publisher 工具–>[GM 工具 ]–>[公告邮\n件 API]模块。\naction 操作类型枚举\n编号 枚举 含义\n1 publish 发布全服邮件 /个人邮件 /公告板 /跑马灯"
    },
    {
        "data": "X-Gm-Template ，参照全服邮件\n7.2公告邮件系统\n协议说明\n•本文档意图说明接入 G123 GM 工具内的公告邮件系统所需提供的操作类型。\n•实现了对应接口后，请将 W ebhook 地址填入 Publisher 工具–>[GM 工具 ]–>[公告邮\n件 API]模块。\naction 操作类型枚举\n编号 枚举 含义\n1 publish 发布全服邮件 /个人邮件 /公告板 /跑马灯\n2 offline 下线全服邮件 /公告板 /跑马灯7. GM 接口 [选接 ] 8\ntemplate 告知模板类型\n编号 枚举 含义\n1 server_mail 全服邮件\n2 player_mail 个人邮件\n3 bulletin 游戏内公告板\n4 news_ticker 游戏跑马灯\n请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型\n2 template string true 告知模板类型\n3 data json false 具体请求\nHTTP 状态码\nHTTP 状态码 含义\n200 - OK 操作成功\n400 - Bad Request 错误请求，参数不合法或其他原因\n401 - Unauthorized 鉴权失败，未附 API key 或其他原因\n402 - Request F ailed 参数合法但其他原因请求失败\n403 - F orbidden 无权操作资源\n404 - Not F ound 该资源不可达\n409 - Conflict 资源状态与当前请求冲突\n500～504 - Server Errors 服务器内部错误\n7.2.1 全服邮件\n全服邮件发送操作\n•调用方法： POST\n•请求方： G1237. GM 接口 [选接 ] 9\n•响应方： CP\n•说明：向游戏内指定服务器内符合条件的玩家发送邮件。\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型\n2 template string true 告知模板类型，固定传 server_mail\n3 richT extType string true 富文本语法枚举，需要 CP实现校验\n逻辑防止显示错误\n4 data json true 发布告知 json\ndata"
    },
    {
        "data": "•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型\n2 template string true 告知模板类型，固定传 server_mail\n3 richT extType string true 富文本语法枚举，需要 CP实现校验\n逻辑防止显示错误\n4 data json true 发布告知 json\ndata\n编号 字段名 类型 必传 描述\n1 id int true G123 生成的告知唯一 ID\n2 serverIds array true 服务器 ID列表，为空时发送给全服\n玩家\n3 startTime int false 发送时间 13位时间戳\n4 endTime int false 结束时间 13位时间戳\n5 levelMin int false 最小等级\n6 levelMax int false 最大等级\n7 registeredBefore int false 创角时刻小于此时间戳，即玩家创角\n时间在此时间之前\n8 registeredAfter int false 创角时刻大于此时间戳，即玩家创角\n时间在此时间之后\n9 extends json false cp 自定义字段，默认为空\n10 mail array true 邮件内容\n11 assets array false 邮件附件\nmail7. GM 接口 [选接 ] 10\n编\n号 字段名 类型 必传 描述\n1 language string true 参考语言枚举\n2 header string true 邮件标题\n3 content string true 邮件内容\n4 bannerLink string false 背景图片链接\nassets\n编号 字段名 类型 必传 描述\n1 itemId string true 道具 /资源 ID\n2 num int true 道具 /资源数量\n•请求样例\ncurl--location --request POST'https://goodgame.jp/api' \\\n--header 'Accept: application/json' \\\n--header 'Content-Type: application/json' \\"
    },
    {
        "data": "1 itemId string true 道具 /资源 ID\n2 num int true 道具 /资源数量\n•请求样例\ncurl--location --request POST'https://goodgame.jp/api' \\\n--header 'Accept: application/json' \\\n--header 'Content-Type: application/json' \\\n--header 'X-Gm-Action: publish' \\\n--header 'X-Gm-Template: server_mail' \\\n--header 'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n--data-raw '{\n\"action\":\"publish\",\n\"template\":\"server_mail\",\n\"richTextType\":\"BBCode\",\n\"data\":{\n\"id\":10005,\n\"serverIds\":[\n1380420001,\n1380420002\n],\n\"startTime\":1646390400000,\n\"endTime\":1646736000000,7. GM 接口 [选接 ] 11\n\"levelMin\":0,\n\"levelMax\":60,\n\"registeredBefore\":1646390400000,\n\"mail\":[\n{\n\"language\":\"en\",\n\"header\":\"Welcome to Seirei Server!\",\n\"content\":\"Fight for glory in a magical realm on this server.\",\n\"bannerLink\":\"https://example.com/seirei_bg.jpg\"\n},\n{\n\"language\":\"ja\",\n\"header\":\"Seirei サーバーへようこそ！ \",\n\"content\":\" このサーバーで魔法の世界で栄光を戦いましょう。 \",\n\"bannerLink\":\"https://example.com/seirei_bg.jpg\"\n}\n],\n\"assets\":[\n{"
    },
    {
        "data": "},\n{\n\"language\":\"ja\",\n\"header\":\"Seirei サーバーへようこそ！ \",\n\"content\":\" このサーバーで魔法の世界で栄光を戦いましょう。 \",\n\"bannerLink\":\"https://example.com/seirei_bg.jpg\"\n}\n],\n\"assets\":[\n{\n\"itemId\":\"copper\",\n\"num\":1000\n},\n{\n\"itemId\":\"10005\",\n\"num\":1000\n}\n]\n}\n}'\n•响应样例\n{\n\"status\" :0,7. GM 接口 [选接 ] 12\n\"message\" :\"发布成功\"\n}\n全服邮件下线操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：将指定 ID的全服邮件进行下线操作。\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型，固定传 offline\n2 template string true 告知模板类型\n3 data intArray true 告知 ID列表\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl--location --request POST'https://goodgame.jp/api' \\\n--header 'Accept: application/json' \\\n--header 'Content-Type: application/json' \\\n--header 'X-Gm-Action: offline' \\\n--header 'X-Gm-Template: server_mail' \\\n--header 'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n--data-raw '{\n\"action\": \"offline\",\n\"template\": \"server_mail\",7. GM 接口 [选接 ] 13\n\"data\": [10005, 100006]"
    },
    {
        "data": "--header 'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n--data-raw '{\n\"action\": \"offline\",\n\"template\": \"server_mail\",7. GM 接口 [选接 ] 13\n\"data\": [10005, 100006]\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"下线成功\"\n}\n7.2.2 个人邮件\n个人邮件发送操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：指定玩家 ID向部分玩家发送邮件，此处 PlayerId 为能索引到该玩家角色的唯一 ID\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型\n2 template string true 告知模板类型，固定传 player_mail\n3 richT extType string true 富文本语法枚举，需要 CP实现校验\n逻辑防止显示错误\n4 data json true 发布告知 json\ndata\n编号 字段名 类型 必传 描述\n1 id int true G123 生成的告知唯一 ID\n2 playerIds array true 玩家 ID列表，仅玩家邮件必传\n3 sendTime int false 发送时间 13位时间戳7. GM 接口 [选接 ] 14\n编号 字段名 类型 必传 描述\n4 extends json false cp 自定义字段，默认为空\n5 mail array true 邮件内容\n6 assets array false 邮件附件\nmail\n编\n号 字段名 类型 必传 描述\n1 language string true 参考语言枚举\n2 header string true 邮件标题\n3 content string true 邮件内容\n4 bannerLink string false 背景图片链接\nassets\n编号 字段名 类型 必传 描述\n1 itemId string true 道具 /资源 ID\n2 num int true 道具 /资源数量"
    },
    {
        "data": "1 language string true 参考语言枚举\n2 header string true 邮件标题\n3 content string true 邮件内容\n4 bannerLink string false 背景图片链接\nassets\n编号 字段名 类型 必传 描述\n1 itemId string true 道具 /资源 ID\n2 num int true 道具 /资源数量\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int true 响应状态码\n2 message string true 响应信息，用户可自定义\n•请求样例\ncurl--location --request POST'https://goodgame.jp/api' \\\n--header 'Accept: application/json' \\\n--header 'Content-Type: application/json' \\\n--header 'X-Gm-Action: publish' \\7. GM 接口 [选接 ] 15\n--header 'X-Gm-Template: player_mail' \\\n--header \"Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=\" \\\n--data-raw '{\n\"action\": \"publish\",\n\"template\": \"player_mail\",\n\"richTextType\":\"BBCode\",\n\"data\": {\n\"id\": 10005,\n\"playerIds\": [\n\"123\",\n\"456\",\n\"789\"\n],\n\"sendTime\": 1646304000000,\n\"mail\": [\n{\n\"language\": \"en\",\n\"header\": \"Welcome to Seirei!\",\n\"content\": \"Fight for glory in a magical realm.\",\n\"bannerLink\": \"https://example.com/seirei_bg.jpg\"\n},\n{\n\"language\": \"ja\",\n\"header\": \"Seirei へようこそ！ \","
    },
    {
        "data": "\"language\": \"en\",\n\"header\": \"Welcome to Seirei!\",\n\"content\": \"Fight for glory in a magical realm.\",\n\"bannerLink\": \"https://example.com/seirei_bg.jpg\"\n},\n{\n\"language\": \"ja\",\n\"header\": \"Seirei へようこそ！ \",\n\"content\": \" 魔法の世界で栄光を戦いましょう。 \",\n\"bannerLink\": \"https://example.com/seirei_bg.jpg\"\n}\n],\n\"assets\": [\n{\n\"itemId\": \"copper\",\n\"num\": 1000\n},7. GM 接口 [选接 ] 16\n{\n\"itemId\": \"10005\",\n\"num\": 1000\n}\n]\n}\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"发布成功\"\n}\n7.2.3 公告板\n公告板发送操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：向游戏内指定服务器内符合条件的玩家展示公告板。\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型 publish/edit\n2 template string true 告知模板类型，固定传 bulletin\n3 richT extType string true 富文本语法枚举，需要 CP实现校验\n逻辑防止显示错误\n4 data json true 发布告知 json\ndata7. GM 接口 [选接 ] 17\n编号 字段名 类型 必传 描述\n1 id int true G123 生成的告知唯一 ID\n2 serverIds array true 为空时默认展现给全服玩家\n3 startTime int true 开始时间 13位时间戳\n4 endTime int true 结束时间 13位时间戳\n5 levelMin int false 玩家最小等级\n6 levelMax int false 玩家最大等级\n7 extends json false cp 自定义字段，默认为空"
    },
    {
        "data": "2 serverIds array true 为空时默认展现给全服玩家\n3 startTime int true 开始时间 13位时间戳\n4 endTime int true 结束时间 13位时间戳\n5 levelMin int false 玩家最小等级\n6 levelMax int false 玩家最大等级\n7 extends json false cp 自定义字段，默认为空\n8 bulletin array true 公告板内容\n9 assets array false 公告板附件\nbulletin\n编\n号 字段名 类型 必传 描述\n1 language string true 参考语言枚举\n2 header string true 公告板标题\n3 content string true 公告板内容\n4 tag string false 公告板标签\n5 bannerLink string false 背景图片\nassets\n编号 字段名 类型 必传 描述\n1 itemId string true 道具 /资源 ID\n2 num int true 道具 /资源数量\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义7. GM 接口 [选接 ] 18\n编号 字段名 类型 必传 描述\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl-X'POST'\\\n'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'Content-Type: application/json' \\\n-H'X-Gm-Action: publish' \\\n-H'X-Gm-Template: bulletin' \\\n-H\"Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=\" \\\n-d'{\n\"action\": \"publish\",\n\"template\": \"bulletin\",\n\"richTextType\":\"BBCode\",\n\"data\": {\n\"id\": 12345,\n\"serverIds\": ["
    },
    {
        "data": "-H\"Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=\" \\\n-d'{\n\"action\": \"publish\",\n\"template\": \"bulletin\",\n\"richTextType\":\"BBCode\",\n\"data\": {\n\"id\": 12345,\n\"serverIds\": [\n1380420001,\n1380420002\n],\n\"startTime\": 1677734473000,\n\"endTime\": 1677734473000,\n\"levelMin\": 10,\n\"levelMax\": 100,\n\"bulletin\": [\n{\n\"language\": \"en\",\n\"header\": \"New Game Event Launch in Seirei!\",\n\"content\": \"Join us for an exciting new game event in Seirei, featuring exclusive rewards and challenges!\",\n\"tag\":\"Event\",\n\"bannerLink\": \"https://example.com/seirei_event_en.png\"7. GM 接口 [选接 ] 19\n},\n{\n\"language\": \"ja\",\n\"header\": \"Seirei 新しいイベントの開催！ \",\n\"content\": \"Seirei で新しいエキサイティングなゲームイベントに参加し、独占的な報酬とチャレンジを楽しもう！ \",\n\"tag\":\" イベント\",\n\"bannerLink\": \"https://example.com/seirei_event_ja.png\"\n}\n]\n}\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"发布成功\"\n}\n公告板下线操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：将指定 ID的公告板进行下线操作。\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型，固定传 offline"
    },
    {
        "data": "}\n]\n}\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"发布成功\"\n}\n公告板下线操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：将指定 ID的公告板进行下线操作。\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型，固定传 offline\n2 template string true 告知模板类型\n3 data intArray true 告知 ID列表\n•响应参数JSON7. GM 接口 [选接 ] 20\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl--location --request POST'https://goodgame.jp/api' \\\n--header 'Accept: application/json' \\\n--header 'Content-Type: application/json' \\\n--header 'X-Gm-Action: offline' \\\n--header 'X-Gm-Template: bulletin' \\\n--header 'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n--data-raw '{\n\"action\": \"offline\",\n\"template\": \"bulletin\",\n\"data\": [10005, 100006]\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"下线成功\"\n}\n7.2.4 跑马灯\n跑马灯发送操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：向游戏内指定服务器内符合条件的玩家展示跑马灯。\n•验参： CP接入签名规则7. GM 接口 [选接 ] 21\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型 publish/edit"
    },
    {
        "data": "\"message\" :\"下线成功\"\n}\n7.2.4 跑马灯\n跑马灯发送操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：向游戏内指定服务器内符合条件的玩家展示跑马灯。\n•验参： CP接入签名规则7. GM 接口 [选接 ] 21\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型 publish/edit\n2 template string true 告知模板类型，固定传 news_ticker\n3 data json true 发布告知 json\ndata\n编号 字段名 类型 必传 描述\n1 id int true G123 生成的告知唯一 ID\n2 serverIds array true 服务器 ID列表\n3 startTime int true 开始时间 13位时间戳\n4 endTime int true 结束时间 13位时间戳\n5 levelMin int false 玩家最小等级\n6 levelMax int false 玩家最大等级\n7 interval int true 播放间隔，单位分钟，为 0时仅播放\nfrequency 次\n8 frequency int true 每回播放频次，单位条数\n9 extends json false cp 自定义字段，默认为空\n10 newsTicker array true 告知内容\nnewsTicker |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—– |:\n—————————————————————— | | 1 | language | string | true | 参考语言\n枚举 | | 2 | content | string | true | 跑马灯内容 |\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例7. GM 接口 [选接 ] 22\ncurl-XPOST'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\"
    },
    {
        "data": "•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例7. GM 接口 [选接 ] 22\ncurl-XPOST'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'Content-Type: application/json' \\\n-H'X-Gm-Action: publish' \\\n-H'X-Gm-Template: news_ticker' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"publish\",\n\"template\": \"news_ticker\",\n\"data\": {\n\"id\": 12345,\n\"serverIds\": [1380420001, 1380420002],\n\"startTime\": 1677734473000,\n\"endTime\": 1677734475000,\n\"levelMin\": 10,\n\"levelMax\": 100,\n\"interval\": 0,\n\"frequency\": 2,\n\"extends\": {},\n\"newsTicker\": [\n{\n\"language\": \"en\",\n\"content\": \"Join us for an exciting new game event in Seirei, featuring exclusive rewards and challenges!\"\n},\n{\n\"language\": \"ja\",\n\"content\": \"Seirei で新しいエキサイティングなゲームイベントに参加し、独占的な報酬とチャレンジを楽しもう！ \"\n}\n]\n}\n}'\n•响应样例7. GM 接口 [选接 ] 23\n{\n\"status\" :0,\n\"message\" :\"发布成功\"\n}\n跑马灯下线操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：将指定 ID的跑马灯进行下线操作。\n•验参： CP接入签名规则"
    },
    {
        "data": "}\n]\n}\n}'\n•响应样例7. GM 接口 [选接 ] 23\n{\n\"status\" :0,\n\"message\" :\"发布成功\"\n}\n跑马灯下线操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：将指定 ID的跑马灯进行下线操作。\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型，固定传 offline\n2 template string true 告知模板类型\n3 data intArray true 告知 ID列表\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl--location --request POST'https://goodgame.jp/api' \\\n--header 'Accept: application/json' \\\n--header 'Content-Type: application/json' \\\n--header 'X-Gm-Action: offline' \\\n--header 'X-Gm-Template: news_ticker' \\\n--header 'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n--data-raw '{\n\"action\": \"offline\",7. GM 接口 [选接 ] 24\n\"template\": \"news_ticker\",\n\"data\": [10005, 100006]\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"下线成功\"\n}\n7.3玩家管理系统\n协议说明\n•本文档意图说明接入 G123 GM 工具内的玩家管理系统所需提供的操作类型。\n•实现了对应接口后，请将 W ebhook 地址填入 Publisher 工具–>[GM 工具 ]–>[玩家管\n理 API]模块。\naction 操作类型枚举\n编号 枚举 含义\n1 rename 玩家重命名\n1 import 玩家数据导入"
    },
    {
        "data": "\"message\" :\"下线成功\"\n}\n7.3玩家管理系统\n协议说明\n•本文档意图说明接入 G123 GM 工具内的玩家管理系统所需提供的操作类型。\n•实现了对应接口后，请将 W ebhook 地址填入 Publisher 工具–>[GM 工具 ]–>[玩家管\n理 API]模块。\naction 操作类型枚举\n编号 枚举 含义\n1 rename 玩家重命名\n1 import 玩家数据导入\nqueryType 获取类型枚举\n编号 枚举 含义\n1 players 获取玩家列表\n2 player_details_tabs 获取 CP支持的玩家详情数据类型，本文档只提供协议规范和\n样例，具体实现需要 CP与运营共同商讨制订。\n3 player_details 获取指定类型的玩家数据详情。\n4 players 玩家数据操作\n5 item_logs 获取玩家道具流水日志7. GM 接口 [选接 ] 25\n编号 枚举 含义\n6 login_logs 获取玩家登录登出日志\n7 event_logs 获取玩家活动日志\n8 mail_logs 获取玩家邮件日志\n9 player_data_export 获取玩家数据导出 JSON\nHTTP 状态码\nHTTP 状态码 含义\n200 - OK 操作成功\n400 - Bad Request 错误请求，参数不合法或其他原因\n401 - Unauthorized 鉴权失败，未附 API key 或其他原因\n402 - Request F ailed 参数合法但其他原因请求失败\n403 - F orbidden 无权操作资源\n404 - Not F ound 该资源不可达\n409 - Conflict 资源状态与当前请求冲突\n500～504 - Server Errors 服务器内部错误\n7.3.1 玩家检索获取\n获取玩家列表\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取玩家列表\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传 players\n2 page int true 页码，从 1开始7. GM 接口 [选接 ] 26\n编号 字段名 类型 必传 描述\n3 pageSize int true 页面大小"
    },
    {
        "data": "•请求方： G123\n•响应方： CP\n•说明： G123平台获取玩家列表\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传 players\n2 page int true 页码，从 1开始7. GM 接口 [选接 ] 26\n编号 字段名 类型 必传 描述\n3 pageSize int true 页面大小\n4 serverId int false 玩家所在服务器 ID\n5 nicknameF uzz string false 玩家昵称，模糊搜索\n6 userId string false 玩家 ID或者 G123ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 玩家列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 玩家列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—— |:————————\n-| | 1 | playerId | string | true | 玩家 ID | | 2 | g123Id | string | true | G123 平台\nID | | 3 | nickname | string | true | 玩家昵称 | | 4 | serverId | int | true | 服务器\nId | | 5 | registeredAt | int | true | 创角时间， 13位时间戳 (ms) | | 6 | lastLoginAt\n| int | true | 上一次登录时间， 13位时间戳 (ms) | | 7 | lastLoginIp | string | true |\n上次登录 ip | | 8 | banType | string | false | 账号封禁类型：封禁 (lock)/ 禁言 (mute) |\n•请求样例"
    },
    {
        "data": "| int | true | 上一次登录时间， 13位时间戳 (ms) | | 7 | lastLoginIp | string | true |\n上次登录 ip | | 8 | banType | string | false | 账号封禁类型：封禁 (lock)/ 禁言 (mute) |\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: players' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=players&page=1&pageSize=100&serverId=123&nicknameFuzz=John&userId=1234'\n•响应样例\n{\n\"status\" :0,7. GM 接口 [选接 ] 27\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"playerId\" :\"1234\",\n\"g123Id\" :\"g123-123456\" ,\n\"nickname\" :\"John Marston\" ,\n\"serverId\" :123,\n\"registeredAt\" :1643218800000 ,\n\"lastLoginAt\" :1648304400000 ,\n\"lastLoginIp\" :\"127.0.0.1\"\n},\n{\n\"playerId\" :\"789012\" ,\n\"g123Id\" :\"g1234JP\" ,\n\"nickname\" :\"John Smith\" ,\n\"serverId\" :123,\n\"registeredAt\" :1643295600000 ,\n\"lastLoginAt\" :1648381200000 ,\n\"lastLoginIp\" :\"127.0.0.2\" ,\n\"banType\" :\"lock\"\n}\n]\n}\n}\n7.3.2 玩家详情查询获取\n获取玩家详情数据类型\n•调用方法： GET\n•请求方： G123\n•响应方： CP7. GM 接口 [选接 ] 28"
    },
    {
        "data": "\"registeredAt\" :1643295600000 ,\n\"lastLoginAt\" :1648381200000 ,\n\"lastLoginIp\" :\"127.0.0.2\" ,\n\"banType\" :\"lock\"\n}\n]\n}\n}\n7.3.2 玩家详情查询获取\n获取玩家详情数据类型\n•调用方法： GET\n•请求方： G123\n•响应方： CP7. GM 接口 [选接 ] 28\n•说明： G123平台获取玩家列表\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传 player_details_tabs\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 详情枚举列表\ndata\n编号 字段名 类型 必传 描述\n1 tabEnum string true 详情 T AB枚举，由运营和 CP制定\n2 tabType string true T AB 类型：信息页 (infos_page) / 道具页\n(assets_page)\n3 tabName string true T AB 名称，由运营提供\n•请求样例\ncurl-XGET\\\n'https://goodgame.jp/api?queryType=player_details_tabs \\\n-H 'Accept: application/json ' \\\n-H 'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY= ' \\\n-H 'X-Gm-QueryType: player_details_tabs '\n•响应样例\n{\n\"status\" :0,7. GM 接口 [选接 ] 29\n\"message\" :\"Success\" ,\n\"data\":[\n{\n\"tabEnum\" :\"primary_tab\" ,\n\"tabType\" :\"infos_page\" ,\n\"tabName\" :\"基本情報\"\n},\n{\n\"tabEnum\" :\"attributes_tab\" ,"
    },
    {
        "data": "•响应样例\n{\n\"status\" :0,7. GM 接口 [选接 ] 29\n\"message\" :\"Success\" ,\n\"data\":[\n{\n\"tabEnum\" :\"primary_tab\" ,\n\"tabType\" :\"infos_page\" ,\n\"tabName\" :\"基本情報\"\n},\n{\n\"tabEnum\" :\"attributes_tab\" ,\n\"tabType\" :\"infos_page\" ,\n\"tabName\" :\"属性情報\"\n},\n{\n\"tabEnum\" :\"inventory_tab\" ,\n\"tabType\" :\"assets_page\" ,\n\"tabName\" :\"バッグ\"\n}\n]\n}\n玩家详情页数据获取\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台按照先前获取的 tabEnum 拉取详情页数据\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传 player_details\n2 tabEnum string true 通过 player_details_tabs 获取的枚\n举类型\n3 playerId string true 玩家 ID7. GM 接口 [选接 ] 30\n•响应参数，当 tabEnum 类型为infos_page 时\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 详情 MODAL 列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:———– |:—— -|:—– |:————– | | 1 |\nmodalName | string | true | MODAL 名称，由运营提供 | | 2 | modalInfos | array\n| true | MODAL 内展示详情 |\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—– |:——————— | | 1 |"
    },
    {
        "data": "modalName | string | true | MODAL 名称，由运营提供 | | 2 | modalInfos | array\n| true | MODAL 内展示详情 |\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—– |:——————— | | 1 |\nmodalItem | string | true | MODAL 内条目名称，由运营提供 | | 2 | modalContent\n| string | true | MODAL 内条目内容，由 CP返回对应内容 |\n•请求样例\ncurl-XGET\\\n-H'Accept: application/json' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-H'X-Gm-QueryType: player_details' \\\nhttps://goodgame.jp/api ?queryType=player_details &tabEnum=primary_tab &playerId =123456\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"OK\",\n\"data\":[\n{\n\"modalName\" :\"基本\",\n\"modalInfos\" :[\n{\n\"modalItem\" :\"アカウント \",\n\"modalContent\" :\"G1H8HUCLP\"7. GM 接口 [选接 ] 31\n},\n{\n\"modalItem\" :\"チャンネル \",\n\"modalContent\" :\"G123\"\n},\n{\n\"modalItem\" :\"プレーヤー ID\",\n\"modalContent\" :\"JP819082058\"\n},\n{\n\"modalItem\" :\"サーバー\",\n\"modalContent\" :\"S191\"\n},\n{\n\"modalItem\" :\"プレーヤー名 \",\n\"modalContent\" :\"PlayerwAfMuZQ\"\n},\n{\n\"modalItem\" :\"レベル\",\n\"modalContent\" :\"40\"\n},\n{\n\"modalItem\" :\"vip\",\n\"modalContent\" :\"7\""
    },
    {
        "data": "},\n{\n\"modalItem\" :\"サーバー\",\n\"modalContent\" :\"S191\"\n},\n{\n\"modalItem\" :\"プレーヤー名 \",\n\"modalContent\" :\"PlayerwAfMuZQ\"\n},\n{\n\"modalItem\" :\"レベル\",\n\"modalContent\" :\"40\"\n},\n{\n\"modalItem\" :\"vip\",\n\"modalContent\" :\"7\"\n},\n{\n\"modalItem\" :\"vipExp\" ,\n\"modalContent\" :\"560\"\n},\n{\n\"modalItem\" :\"チャージ\",\n\"modalContent\" :\"5990\"\n}7. GM 接口 [选接 ] 32\n]\n},\n{\n\"modalName\" :\"通貨\",\n\"modalInfos\" :[\n{\n\"modalItem\" :\"精霊石\",\n\"modalContent\" :\"742443\"\n},\n{\n\"modalItem\" :\"精力\",\n\"modalContent\" :\"50\"\n},\n{\n\"modalItem\" :\"霊芝\",\n\"modalContent\" :\"0\"\n},\n{\n\"modalItem\" :\"玉液\",\n\"modalContent\" :\"742443\"\n},\n{\n\"modalItem\" :\"仙玉\",\n\"modalContent\" :\"50\"\n},\n{\n\"modalItem\" :\"彩玉\",\n\"modalContent\" :\"0\"\n},\n{\n\"modalItem\" :\"祈灵\",\n\"modalContent\" :\"742443\"\n},7. GM 接口 [选接 ] 33\n{\n\"modalItem\" :\"名望\",\n\"modalContent\" :\"50\"\n},\n{\n\"modalItem\" :\"修为\",\n\"modalContent\" :\"34405791\"\n}\n]\n},\n{\n\"modalName\" :\"時間\",\n\"modalInfos\" :[\n{\n\"modalItem\" :\"開服時間\",\n\"modalContent\" :\"2023-04-02 17:35:00\"\n},\n{\n\"modalItem\" :\"創角時間\",\n\"modalContent\" :\"2023-04-04 15:47:10\"\n},\n{\n\"modalItem\" :\"最後登録\","
    },
    {
        "data": "}\n]\n},\n{\n\"modalName\" :\"時間\",\n\"modalInfos\" :[\n{\n\"modalItem\" :\"開服時間\",\n\"modalContent\" :\"2023-04-02 17:35:00\"\n},\n{\n\"modalItem\" :\"創角時間\",\n\"modalContent\" :\"2023-04-04 15:47:10\"\n},\n{\n\"modalItem\" :\"最後登録\",\n\"modalContent\" :\"2023-04-19 14:45:37\"\n},\n{\n\"modalItem\" :\"最後活躍\",\n\"modalContent\" :\"2023-04-19 14:47:33\"\n},\n{\n\"modalItem\" :\"月卡到期\",\n\"modalContent\" :\"0\"\n}7. GM 接口 [选接 ] 34\n]\n}\n]\n}\n•响应参数，当 tabEnum 类型为assets_page 时\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 详情 MODAL 列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:———– |:—— -|:—– |:————– | | 1 |\nmodalName | string | true | MODAL 名称，由运营提供 | | 2 | modalInfos | array\n| true | MODAL 内展示详情 |\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:————– |:—— -|:—— |:——— -| | 1 |\nmodalItem | string | true | asset 名称 | | 2 | modalContent | string | true |\nasset数目 | | 3 | thumbnailLink | string | false | asset 图标链接 |\n•请求样例\ncurl-XGET\\\n-H'Accept: application/json' \\"
    },
    {
        "data": "modalItem | string | true | asset 名称 | | 2 | modalContent | string | true |\nasset数目 | | 3 | thumbnailLink | string | false | asset 图标链接 |\n•请求样例\ncurl-XGET\\\n-H'Accept: application/json' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-H'X-Gm-QueryType: player_details' \\\nhttps://goodgame.jp/api ?queryType=player_details &tabEnum=inventory_tab &playerId =123456\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"OK\",\n\"data\":[\n{\n\"modalName\" :\"全部\",7. GM 接口 [选接 ] 35\n\"modalInfos\" :[\n{\n\"modalItem\" :\"生命药水\",\n\"modalContent\" :\"80\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/potions.png\"\n},\n{\n\"modalItem\" :\"阔剑\",\n\"modalContent\" :\"2\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/claymore.png\"\n},\n{\n\"modalItem\" :\"长剑\",\n\"modalContent\" :\"1\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/sword.png\"\n},\n{\n\"modalItem\" :\"魔法药水\",\n\"modalContent\" :\"20\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/magic_potion.png\"\n}\n]\n},\n{\n\"modalName\" :\"武器\",\n\"modalInfos\" :[\n{\n\"modalItem\" :\"阔剑\",\n\"modalContent\" :\"2\","
    },
    {
        "data": "},\n{\n\"modalItem\" :\"魔法药水\",\n\"modalContent\" :\"20\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/magic_potion.png\"\n}\n]\n},\n{\n\"modalName\" :\"武器\",\n\"modalInfos\" :[\n{\n\"modalItem\" :\"阔剑\",\n\"modalContent\" :\"2\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/claymore.png\"\n},\n{\n\"modalItem\" :\"长剑\",7. GM 接口 [选接 ] 36\n\"modalContent\" :\"1\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/sword.png\"\n}\n]\n},\n{\n\"modalName\" :\"くすり\",\n\"modalInfos\" :[\n{\n\"modalItem\" :\"生命药水\",\n\"modalContent\" :\"80\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/potions.png\"\n},\n{\n\"modalItem\" :\"魔法药水\",\n\"modalContent\" :\"20\",\n\"thumbnailLink\" :\"https://goodgamecdn.jp/magic_potion.png\"\n}\n]\n}\n]\n}\n7.3.3 玩家重命名操作\n玩家详情页数据获取\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明： G123平台修改游戏玩家数据\n•验参： CP接入签名规则\n•请求参数JSON7. GM 接口 [选接 ] 37\n编号 字段名 类型 必传 描述\n1 action string true 操作类型 rename\n2 template string true 玩家数据模板类型 players\n3 data JSON true 重命名数据\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—– |:—— -| | 1 | playerId\n| string | true | 玩家 ID | | 2 | nickname | string | true | 新的玩家昵称 |\n•响应参数JSON"
    },
    {
        "data": "3 data JSON true 重命名数据\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—– |:—— -| | 1 | playerId\n| string | true | 玩家 ID | | 2 | nickname | string | true | 新的玩家昵称 |\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl-XPUT'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'Content-Type: application/json' \\\n-H'X-Gm-Action: rename' \\\n-H'X-Gm-Template: players' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"rename\",\n\"template\": \"players\",\n\"data\": {\n\"playerId\": \"12345\",\n\"nickname\": \"NewNickname\"\n}\n}'\n•响应样例\n{\n\"status\" :0,7. GM 接口 [选接 ] 38\n\"message\" :\"玩家昵称更新成功 \"\n}\nCP可以与运营商讨确认后，按自己游戏逻辑实现，假设运营没有特殊的重命名需求，可以恢复为默认\n玩家名，并发送 改名券 道具邮件到玩家邮箱中。如果运营明确指定了新的玩家昵称，则 CP侧需要\n做好重名校验，比如：\nHTTP/1.1 409 Conflict\nContent-Type: application/json\n{\n\"status\" : 1001,\n\"message\" :\"玩家昵称已存在 \"\n}\n7.3.4 玩家日志查询获取\n获取玩家道具流水日志\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取玩家道具流水日志\n•验参： CP接入签名规则\n•请求参数Query"
    },
    {
        "data": "HTTP/1.1 409 Conflict\nContent-Type: application/json\n{\n\"status\" : 1001,\n\"message\" :\"玩家昵称已存在 \"\n}\n7.3.4 玩家日志查询获取\n获取玩家道具流水日志\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取玩家道具流水日志\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传item_logs\n2 playerId string true 玩家 ID\n3 page int true 页码，从 1开始\n4 pageSize int true 页面大小\n5 startTime int true 开始时间， 13位时间戳（ ms）\n6 endTime int true 结束时间， 13位时间戳（ ms）7. GM 接口 [选接 ] 39\n编号 字段名 类型 必传 描述\n7 itemAction string true 行为枚举：获取 (acquired)/ 消耗\n(consumed)/ 全部 (all)\n8 item string false 道具 ID（精准）或道具名（模糊搜索）\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 玩家列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 日志列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—– |:\n——————————— -| | 1 | itemId | string | true | 道具 ID | | 2 | itemName |\nstring | true | 道具名 | | 3 | itemAction | string | true | 行为枚举：获取 (acquired)/"
    },
    {
        "data": "——————————— -| | 1 | itemId | string | true | 道具 ID | | 2 | itemName |\nstring | true | 道具名 | | 3 | itemAction | string | true | 行为枚举：获取 (acquired)/\n消耗 (consumed) | | 4 | amount | int | true | 变动数量 | | 5 | quantity | int |\ntrue | 变动后数量 | | 6 | changeModule | string | true | 变动模块，例：战斗奖励，活动\n奖励 | | 7 | changeReason | string | true | 变动原因，例：竞技场挑战，五月七日连续登陆\n活动 | | 8 | changeTime | int | true | 变动时间 |\n•请求样例\ncurl-XGET'https://goodgame.jp/api?queryType=player_logs&playerId=123456&page=1&pageSize=20&startTime=1677734473000&endTime=1677734473000&itemAction=all&item=health_potion' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: item_logs' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY='\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",7. GM 接口 [选接 ] 40\n\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"itemId\" :\"1001\",\n\"itemName\" :\"生命药水\",\n\"itemAction\" :\"acquired\" ,\n\"amount\" :10,\n\"quantity\" :10,\n\"changeModule\" :\"战斗获得\",\n\"changeReason\" :\"完成任务 '击败哥布林王 '\",\n\"changeTime\" :1677734473000"
    },
    {
        "data": "\"elements\" :[\n{\n\"itemId\" :\"1001\",\n\"itemName\" :\"生命药水\",\n\"itemAction\" :\"acquired\" ,\n\"amount\" :10,\n\"quantity\" :10,\n\"changeModule\" :\"战斗获得\",\n\"changeReason\" :\"完成任务 '击败哥布林王 '\",\n\"changeTime\" :1677734473000\n},\n{\n\"itemId\" :\"1001\",\n\"itemName\" :\"生命药水\",\n\"itemAction\" :\"consumed\" ,\n\"amount\" :2,\n\"quantity\" :8,\n\"changeModule\" :\"道具使用\",\n\"changeReason\" :\"战斗中使用 \",\n\"changeTime\" :1677734474000\n}\n]\n}\n}\n获取玩家登陆登出日志\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取玩家登陆登出日志\n•验参： CP接入签名规则7. GM 接口 [选接 ] 41\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传login_logs\n2 playerId string true 玩家 ID\n3 page int true 页码，从 1开始\n4 pageSize int true 页面大小\n5 startTime int true 开始时间， 13位时间戳（ ms）\n6 endTime int true 结束时间， 13位时间戳（ ms）\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 玩家列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 日志列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—– |:—————————"
    },
    {
        "data": "data |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 日志列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—– |:—————————\n| | 1 | g123Id | string | true | g123 平台 ID | | 2 | nickname | string | true | 玩\n家昵称 | | 3 | logType | string | true | 类型枚举：登录 (login)/ 登出 (logout) | | 4 |\ntime | int | true | 操作时间， 13位时间戳（ ms）| | 5 | ip | string | true | 操作 IP |\n•请求样例\ncurl-XGET\\\n'https://goodgame.jp/api?playerId=12345&page=1&pageSize=10&startTime=1677734473000&endTime=1677734474000&queryType=login_logs' \\\n-H'Accept: application/json' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-H'X-Gm-QueryType: login_logs'\n•响应样例7. GM 接口 [选接 ] 42\n{\n\"status\" :200,\n\"message\" :\"Success\" ,\n\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"g123Id\" :\"1234567890\" ,\n\"nickname\" :\"JohnDoe123\" ,\n\"logType\" :\"login\",\n\"time\":1648976400000 ,\n\"ip\":\"192.168.1.1\"\n},\n{\n\"g123Id\" :\"1234567890\" ,\n\"nickname\" :\"JohnDoe123\" ,"
    },
    {
        "data": "\"total\":2,\n\"elements\" :[\n{\n\"g123Id\" :\"1234567890\" ,\n\"nickname\" :\"JohnDoe123\" ,\n\"logType\" :\"login\",\n\"time\":1648976400000 ,\n\"ip\":\"192.168.1.1\"\n},\n{\n\"g123Id\" :\"1234567890\" ,\n\"nickname\" :\"JohnDoe123\" ,\n\"logType\" :\"logout\" ,\n\"time\":1648976800000 ,\n\"ip\":\"192.168.1.1\"\n}\n]\n}\n}\n获取玩家活动日志\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取玩家活动日志\n•验参： CP接入签名规则\n•请求参数Query7. GM 接口 [选接 ] 43\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传event_logs\n2 playerId string true 玩家 ID\n3 page int true 页码，从 1开始\n4 pageSize int true 页面大小\n5 startTime int true 开始时间， 13位时间戳（ ms）\n6 endTime int true 结束时间， 13位时间戳（ ms）\n7 event string false 活动名（模糊）或活动 ID（精准）\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 玩家列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 日志列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— |:—— -|:—– |:————— -| | 1"
    },
    {
        "data": "data |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 日志列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— |:—— -|:—– |:————— -| | 1\n| eventId | string | true | 活动 ID | | 2 | eventName | string | true | 活动名 | | 3\n| eventAction | string | true | 活动行为 | | 4 | time | int | true | 操作时间， 13位时\n间戳（ ms）|\n•请求样例\ncurl-XGET\\\n-H'Accept: application/json' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-H'X-Gm-QueryType: event_logs' \\\n'https://goodgame.jp/api?playerId=123456&page=1&pageSize=10&startTime=1677734473000&endTime=1677734573000&event= イベント 2023'\n•响应样例7. GM 接口 [选接 ] 44\n{\n\"status\" :200,\n\"message\" :\"OK\",\n\"data\":{\n\"total\":5,\n\"elements\" :[\n{\n\"eventId\" :\"E0001\",\n\"eventName\" :\"夏祭りイベント 2023\",\n\"eventAction\" :\"参加\",\n\"time\":1677743441000\n},\n{\n\"eventId\" :\"E0002\",\n\"eventName\" :\"端午の節句イベント 2023\",\n\"eventAction\" :\"報酬受取\",\n\"time\":1677731122000\n},\n{\n\"eventId\" :\"E0003\",\n\"eventName\" :\"ハロウィンイベント 2023\","
    },
    {
        "data": "\"eventAction\" :\"参加\",\n\"time\":1677743441000\n},\n{\n\"eventId\" :\"E0002\",\n\"eventName\" :\"端午の節句イベント 2023\",\n\"eventAction\" :\"報酬受取\",\n\"time\":1677731122000\n},\n{\n\"eventId\" :\"E0003\",\n\"eventName\" :\"ハロウィンイベント 2023\",\n\"eventAction\" :\"交換\",\n\"time\":1677719923000\n}\n]\n}\n}\n获取玩家邮件日志\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取玩家邮件日志7. GM 接口 [选接 ] 45\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传mail_logs\n2 playerId string true 玩家 ID\n3 page int true 页码，从 1开始\n4 pageSize int true 页面大小\n5 startTime int true 开始时间， 13位时间戳（ ms）\n6 endTime int true 结束时间， 13位时间戳（ ms）\n7 mailType string true 邮件类型枚举：全部 (all)\n全服邮件 (serverMail) ，由 gm发送的\n全服邮件\n个人邮件 (playerMail) ，由 gm发送的\n个人邮件\n系统邮件 (systemMail) ，由游戏系统发\n送的玩家邮件\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 玩家列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 日志列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—— |:"
    },
    {
        "data": "data |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 日志列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—— |:\n—————————————————————————————— -| | 1 | mailType | string |\ntrue |邮件类型：全服邮件 (serverMail) ，由 GM发送的全服邮件 /个人邮件 (playerMail) ，\n由 GM发送的个人邮件 /系统邮件 (systemMail) ，由游戏系统发送的玩家邮件 | | 2 | mailId\n| string | true | 邮件 ID，GM邮件 id为发送时所带 ID | | 3 | timeReceived | int |7. GM 接口 [选接 ] 46\ntrue | 收到时间， 13位时间戳（ ms）| | 4 | timeRead | int | true | 阅读时间， 13位时间\n戳（ ms）| | 5 | timeClaimed | int | false | 领取附件时间， 13位时间戳（ ms）| | 6 |\nassets | array | false | 邮件附件 |\nassets |编号 |字段名 |类型 |必传 |描述 | |:—|:—— -|:—— -|:—– |:——– | | 1 | itemId |\nstring | true | 道具 /资源 ID | | 2 | num | int | true | 道具 /资源数量 |\n•请求样例\ncurl-XGET\\\n'https://goodgame.jp/api?queryType=mail_logs&playerId=123456&page=1&pageSize=10&startTime=1664476800000&endTime=1664715600000&mailType=all' \\\n-H'Accept: application/json' \\"
    },
    {
        "data": "•请求样例\ncurl-XGET\\\n'https://goodgame.jp/api?queryType=mail_logs&playerId=123456&page=1&pageSize=10&startTime=1664476800000&endTime=1664715600000&mailType=all' \\\n-H'Accept: application/json' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-H'X-Gm-QueryType: mail_logs'\n•响应样例\n{\n\"status\" :200,\n\"message\" :\"Success\" ,\n\"data\":{\n\"total\":20,\n\"elements\" :[\n{\n\"mailType\" :\"systemMail\" ,\n\"mailId\" :\"12345\",\n\"timeReceived\" :1664559600000 ,\n\"timeRead\" :1664570400000 ,\n\"timeClaimed\" :1664570400000 ,\n\"assets\" :[\n{\n\"itemId\" :\"10001\",\n\"num\":2\n},\n{\n\"itemId\" :\"20002\",7. GM 接口 [选接 ] 47\n\"num\":1\n}\n]\n},\n{\n\"mailType\" :\"playerMail\" ,\n\"mailId\" :\"67890\",\n\"timeReceived\" :1664632800000 ,\n\"timeRead\" :1664643600000 ,\n\"timeClaimed\" :0,\n\"assets\" :[]\n},\n{\n\"mailType\" :\"serverMail\" ,\n\"mailId\" :\"24680\",\n\"timeReceived\" :1664450400000 ,\n\"timeRead\" :1664457600000 ,\n\"timeClaimed\" :0,\n\"assets\" :[\n{\n\"itemId\" :\"30003\",\n\"num\":5\n}\n]\n}\n]\n}\n}\n7.3.5 玩家数据导出 /导入操作\n玩家数据导出\n•调用方法： GET7. GM 接口 [选接 ] 48"
    },
    {
        "data": "\"timeReceived\" :1664450400000 ,\n\"timeRead\" :1664457600000 ,\n\"timeClaimed\" :0,\n\"assets\" :[\n{\n\"itemId\" :\"30003\",\n\"num\":5\n}\n]\n}\n]\n}\n}\n7.3.5 玩家数据导出 /导入操作\n玩家数据导出\n•调用方法： GET7. GM 接口 [选接 ] 48\n•请求方： G123\n•响应方： CP\n•说明： G123平台导出玩家数据 JSON\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传 player_data_export\n2 playerId string true 玩家 ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true JSON 数据。 JSON 数据用户可自定义\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: player_data_export' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=player_data_export&playerId=12345'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"playerCurrency\" :{\n\"coins\":100,\n\"gems\":50\n},7. GM 接口 [选接 ] 49\n\"playerId\" :\"12345\",\n\"playerInventory\" :{\n\"items\":[\n{\n\"itemId\" :\"1\",\n\"quantity\" :5\n},\n{\n\"itemId\" :\"2\",\n\"quantity\" :10\n}\n]\n},\n\"playerLevel\" :50,"
    },
    {
        "data": "\"coins\":100,\n\"gems\":50\n},7. GM 接口 [选接 ] 49\n\"playerId\" :\"12345\",\n\"playerInventory\" :{\n\"items\":[\n{\n\"itemId\" :\"1\",\n\"quantity\" :5\n},\n{\n\"itemId\" :\"2\",\n\"quantity\" :10\n}\n]\n},\n\"playerLevel\" :50,\n\"playerName\" :\"John Doe\"\n}\n}\n玩家数据导入\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明： G123平台将玩家数据导入游戏测试服指定角色\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型 import\n2 template string true 玩家数据模板类型 players\n3 data JSON true 重命名数据\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:———– |:—— -|:—– |:———– | | 1 | playerId\n| string | true | 玩家 ID | | 2 | playerData | json | true | 先前导出 JSON 数据 |7. GM 接口 [选接 ] 50\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl-XPOST'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-Action: import' \\\n-H'X-Gm-Template: players' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"import\",\n\"template\": \"players\",\n\"data\": {\n\"playerId\": \"12345\",\n\"playerData\": {"
    },
    {
        "data": "-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"import\",\n\"template\": \"players\",\n\"data\": {\n\"playerId\": \"12345\",\n\"playerData\": {\n\"playerCurrency\": {\n\"coins\": 100,\n\"gems\": 50\n},\n\"playerId\": \"12345\",\n\"playerInventory\": {\n\"items\": [\n{\n\"itemId\": \"1\",\n\"quantity\": 5\n},\n{\n\"itemId\": \"2\",\n\"quantity\": 10\n}7. GM 接口 [选接 ] 51\n]\n},\n\"playerLevel\": 50,\n\"playerName\": \"John Doe\"\n}\n}\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"导入成功\"\n}\n7.4常用数据系统\n协议说明\n•本文档意图说明接入 G123 GM 工具内的常用数据系统所需提供的操作类型。\n•实现了对应接口后，请将 W ebhook 地址填入 Publisher 工具–>[GM 工具 ]–>[常用数\n据 API]模块。\naction 操作类型枚举\n编号 枚举 含义\n1 rename 公会重命名操作\n2 ban_account G123 平台封禁玩家操作\n3 ban_lift G123平台解封玩家操作\nqueryType 获取类型枚举\n编号 枚举 含义\n1 server_ranking_types 获取 CP支持的全服排行榜类型7. GM 接口 [选接 ] 52\n编号 枚举 含义\n2 server_rankings 通过具体的 server_ranking_type 来获取排行\n榜数据\n3 servers 获取区服列表\n4 server_details 获取区服详情数据\n5 server_rankings 获取服务器下排行数据\n6 event_accounting 获取服务器下活动结算日志\n7 guilds 获取公会列表\n8 guild_members 获取公会成员列表\n9 guild_logs 获取公会日志列表"
    },
    {
        "data": "榜数据\n3 servers 获取区服列表\n4 server_details 获取区服详情数据\n5 server_rankings 获取服务器下排行数据\n6 event_accounting 获取服务器下活动结算日志\n7 guilds 获取公会列表\n8 guild_members 获取公会成员列表\n9 guild_logs 获取公会日志列表\n10 mute_types 获取 CP支持的禁言类型\n11 ban_list 查看游戏当前封禁列表\n12 ban_status 查看指定玩家当前封禁状态\n13 assets 获取游戏道具资源列表\n14 gift_criteria 获取 AI礼包配置的限制条件\nHTTP 状态码\nHTTP 状态码 含义\n200 - OK 操作成功\n400 - Bad Request 错误请求，参数不合法或其他原因\n401 - Unauthorized 鉴权失败，未附 API key 或其他原因\n402 - Request F ailed 参数合法但其他原因请求失败\n403 - F orbidden 无权操作资源\n404 - Not F ound 该资源不可达\n409 - Conflict 资源状态与当前请求冲突\n500～504 - Server Errors 服务器内部错误\n7.4.1 游戏区服排行榜数据查询获取\n获取排行榜的类型列表\n•调用方法： GET7. GM 接口 [选接 ] 53\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取排行榜的类型列表\n•验参： CP接入签名规则\n•请求参数Query\n编\n号 字段名 类型 必传 描述\n1 queryType string true 默认传server_ranking_types\n2 language string true 用户语言，参照 语言枚举\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 详情枚举列表\ndata\n编号 字段名 类型 必传 描述\n1 rankingType string true 排行榜类型\n2 rankingName string true 排行榜命名"
    },
    {
        "data": "•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 详情枚举列表\ndata\n编号 字段名 类型 必传 描述\n1 rankingType string true 排行榜类型\n2 rankingName string true 排行榜命名\n3 updateTime string true 更新时间， 13位时间戳\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: server_ranking_types' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=server_ranking_types&language=ja'\n•响应样例7. GM 接口 [选接 ] 54\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":[\n{\n\"rankingType\" :\"playerPower\" ,\n\"rankingName\" :\"プレイヤー戦闘力ランキング \",\n\"updateTime\" :1668124800000\n},\n{\n\"rankingType\" :\"trialTower\" ,\n\"rankingName\" :\"トライアルタワーランキング \",\n\"updateTime\" :1668124800000\n},\n{\n\"rankingType\" :\"arenaRanking\" ,\n\"rankingName\" :\"アリーナランキング \",\n\"updateTime\" :1668124800000\n}\n]\n}\n获取指定游服的排行榜信息\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台按照先前获取的 rankingType 拉取排行数据\n•验参： CP接入签名规则\n•请求参数Query\n编\n号 字段名 类型 必传 描述"
    },
    {
        "data": "\"rankingName\" :\"アリーナランキング \",\n\"updateTime\" :1668124800000\n}\n]\n}\n获取指定游服的排行榜信息\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台按照先前获取的 rankingType 拉取排行数据\n•验参： CP接入签名规则\n•请求参数Query\n编\n号 字段名 类型 必传 描述\n1 queryTypestring true 默认传server_rankings\n2 serverId int true 服务器 ID7. GM 接口 [选接 ] 55\n编\n号 字段名 类型 必传 描述\n3 rankingType string true 排行榜类型\n4 page int true 页码，从 1开始\n5 pageSize int true 页面大小\n6 language string true 用户语言，参照 语言枚举\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 排行\nelements\n编号 字段名 类型 必传 描述\n1 ranking int true 排行\n2 id string true 对应实体 ID，如玩家ID或者\n公会ID\n3 name string true 对应实体名，如 玩家名 或公会名\n4 rankingV alue string true 对应排名值，如 玩家战力 ，充值\n金额\n5 customized array false CP 自定义字段，由运营和 CP商\n讨制定\ncustomized |编号 |字段名 |类型 |必传 |描述 | | :—| :—| :—| :—| :—|\n| 1 | attrName | string | true | 字段定义，由运营和 CP商讨制定 | | 2 | attrV alue |\nstring | true | 字段值，由运营和 CP商讨制定 |\n•请求样例7. GM 接口 [选接 ] 56\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\"
    },
    {
        "data": "| 1 | attrName | string | true | 字段定义，由运营和 CP商讨制定 | | 2 | attrV alue |\nstring | true | 字段值，由运营和 CP商讨制定 |\n•请求样例7. GM 接口 [选接 ] 56\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: server_rankings' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=server_rankings&serverId=123&rankingType=level&page=1&pageSize=10&language=ja'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":3,\n\"elements\" :[\n{\n\"ranking\" :1,\n\"id\":\"player123\" ,\n\"name\":\"John Doe\" ,\n\"rankingValue\" :\"5000\",\n\"customized\" :[\n{\n\"attrName\" :\"チャージ金額 \",\n\"attrValue\" :\"10000\"\n},\n{\n\"attrName\" :\"座標位置\",\n\"attrValue\" :\"(178,89)\"\n}\n]\n},\n{\n\"ranking\" :2,\n\"id\":\"player456\" ,\n\"name\":\"Jane Smith\" ,7. GM 接口 [选接 ] 57\n\"rankingValue\" :\"4500\",\n\"customized\" :[\n{\n\"attrName\" :\"チャージ金額 \",\n\"attrValue\" :\"12000\"\n},\n{\n\"attrName\" :\"座標位置\",\n\"attrValue\" :\"(198,276)\"\n}\n]\n},\n{\n\"ranking\" :3,\n\"id\":\"player789\" ,\n\"name\":\"David Johnson\" ,\n\"rankingValue\" :\"4000\","
    },
    {
        "data": "{\n\"attrName\" :\"チャージ金額 \",\n\"attrValue\" :\"12000\"\n},\n{\n\"attrName\" :\"座標位置\",\n\"attrValue\" :\"(198,276)\"\n}\n]\n},\n{\n\"ranking\" :3,\n\"id\":\"player789\" ,\n\"name\":\"David Johnson\" ,\n\"rankingValue\" :\"4000\",\n\"customized\" :[\n{\n\"attrName\" :\"チャージ金額 \",\n\"attrValue\" :\"567\"\n},\n{\n\"attrName\" :\"座標位置\",\n\"attrValue\" :\"(188,908)\"\n}\n]\n}\n]\n}\n}7. GM 接口 [选接 ] 58\n7.4.2 游戏服务器数据查询\n获取指定游服的排行榜信息\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取游戏区服列表\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传servers\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 区服列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—– |:—— | | 1 | serverId |\nint | true | 服务器 ID | | 2 | name | string | true | 服务器名 |\n•请求样例\ncurl-XGET'https://goodgame.jp/api?queryType=servers' \\\n-H'Accept: application/json' \\\n-H\"X-Gm-QueryType: servers\" \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY='\n•响应样例\n{\n\"status\" :0,7. GM 接口 [选接 ] 59\n\"message\" :\"查询成功\",\n\"data\":[\n{"
    },
    {
        "data": "-H\"X-Gm-QueryType: servers\" \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY='\n•响应样例\n{\n\"status\" :0,7. GM 接口 [选接 ] 59\n\"message\" :\"查询成功\",\n\"data\":[\n{\n\"serverId\" :1380420001 ,\n\"name\":\"CBT-1 服\"\n},\n{\n\"serverId\" :1380420002 ,\n\"name\":\"CBT-2 服\"\n}\n]\n}\n获取区服详情数据\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取游戏区服详情列表\n•验参： CP接入签名规则\n•请求参数Query\n编\n号 字段名 类型 必传 描述\n1 queryType string true 默认传server_details\n2 page int true 页码，从 1开始\n3 pageSize int true 页面大小\n4 language string true 用户语言，参照 语言枚举\n5 serverId int false 区服 ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义7. GM 接口 [选接 ] 60\n编号 字段名 类型 必传 描述\n2 message string false 响应信息，用户可自定义\n3 data array true 区服列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—— -| | 1 | total | int\n| true | 总数 | | 2 | elements | array | true | 区服详情列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:——————— |:—— -|:—— |:——————\n–| | 1 | serverId | int | true | 区服 ID | | 2 | name | string | true | 区服名 | |"
    },
    {
        "data": "| true | 总数 | | 2 | elements | array | true | 区服详情列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:——————— |:—— -|:—— |:——————\n–| | 1 | serverId | int | true | 区服 ID | | 2 | name | string | true | 区服名 | |\n3 | mergeServerGroup | string | true | 合服分组，由运营和 CP商讨定制格式 | | 4 |\ncrossServerGroup | string | true | 当前跨服分组，由运营和 CP商讨定制格式 | | 5 |\nlastCrossServerGroup | string | true | 上回跨服分组，由运营和 CP商讨定制格式 | | 6\n| serverStartTime | int | true | 开服对外时间， 13位时间戳 | | 7 | populationMax |\nstring | false | 服务器人数上限 |\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: server_details' \\\n-H\"Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=\" \\\n-d'queryType=server_details&page=1&pageSize=10&language=ja&serverId=123'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"serverId\" :123,\n\"name\":\"Server A\" ,\n\"mergeServerGroup\" :\"S3,S4,S5,S123\" ,7. GM 接口 [选接 ] 61\n\"crossServerGroup\" :\"50\",\n\"lastCrossServerGroup\" :\"41\","
    },
    {
        "data": "\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"serverId\" :123,\n\"name\":\"Server A\" ,\n\"mergeServerGroup\" :\"S3,S4,S5,S123\" ,7. GM 接口 [选接 ] 61\n\"crossServerGroup\" :\"50\",\n\"lastCrossServerGroup\" :\"41\",\n\"serverStartTime\" :1643218800000 ,\n\"populationMax\" :1000\n},\n{\n\"serverId\" :456,\n\"name\":\"Server B\" ,\n\"mergeServerGroup\" :\"\",\n\"crossServerGroup\" :\"42\",\n\"lastCrossServerGroup\" :\"50\",\n\"serverStartTime\" :1643295600000 ,\n\"populationMax\" :1500\n}\n]\n}\n}\n7.4.3 游戏活动结算数据查询\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取活动结算数据\n•验参： CP接入签名规则\n•请求参数Query\n编\n号 字段名 类型 必传 描述\n1 queryType string true 默认传event_accounting\n2 page int true 页码，从 1开始\n3 pageSize int true 页面大小\n4 serverId int false 区服 ID7. GM 接口 [选接 ] 62\n编\n号 字段名 类型 必传 描述\n5 language string true 用户语言，参照 语言枚举\n6 startTime int true 时间范围开始， 13位时间戳\n7 endTime int true 时间范围结束， 13位时间戳\n8 event string false 活动ID或活动名\n9 participantId string false 参与者 ID，玩家ID或公会ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 区服列表"
    },
    {
        "data": "8 event string false 活动ID或活动名\n9 participantId string false 参与者 ID，玩家ID或公会ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 区服列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—— -| | 1 | total | int\n| true | 总数 | | 2 | elements | array | true | 区服详情列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:————— |:—— -|:—– |:———— | | 1\n| eventId | string | true | 活动 ID | | 2 | eventName | string | true | 活动名 | | 3\n| serverId | int | true | 服务器 ID | | 4 | accountingTime | int | true | 结算时间，\n13位时间戳 | | 5 | accountingData | array | true | 结算数据 |\naccountingData |编号 |字段名 |类型 |必传 |描述 | |:—|:————– |:—— -|:—– |:\n———————— | | 1 | ranking | int | true | 结算排名 | | 2 | participantId | string\n| true | 参与者 ID，玩家ID或公会ID | | 3 | value | string | true | 结算数据，如\n战力，消费金额 ，击杀数 |\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: event_accounting' \\"
    },
    {
        "data": "| true | 参与者 ID，玩家ID或公会ID | | 3 | value | string | true | 结算数据，如\n战力，消费金额 ，击杀数 |\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: event_accounting' \\\n-H\"Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=\" \\\n-d'queryType=event_accounting&page=1&pageSize=10&serverId=123&language=ja&event=subjugation1233&startTime=1642218800000&endTime=1644218800000&participantId=player123'7. GM 接口 [选接 ] 63\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":1,\n\"elements\" :[\n{\n\"eventId\" :\"subjugation1233\" ,\n\"eventName\" :\"討伐イベント \",\n\"serverId\" :123,\n\"accountingTime\" :1643218800000 ,\n\"accountingData\" :[\n{\n\"ranking\" :1,\n\"participantId\" :\"player123\" ,\n\"value\":\"5000\"\n},\n{\n\"ranking\" :2,\n\"participantId\" :\"player456\" ,\n\"value\":\"4500\"\n},\n{\n\"ranking\" :3,\n\"participantId\" :\"player789\" ,\n\"value\":\"4000\"\n}\n]\n}\n]\n}\n}7. GM 接口 [选接 ] 64\n7.4.4 公会数据查询 /公会重命名\n获取公会列表\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取公会列表\n•验参： CP接入签名规则\n•请求参数Query"
    },
    {
        "data": "},\n{\n\"ranking\" :3,\n\"participantId\" :\"player789\" ,\n\"value\":\"4000\"\n}\n]\n}\n]\n}\n}7. GM 接口 [选接 ] 64\n7.4.4 公会数据查询 /公会重命名\n获取公会列表\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取公会列表\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传guilds\n2 page int true 页码，从 1开始\n3 pageSize int true 页面大小\n4 serverId int false 公会所在服务器 ID\n5 guild string false 公会名或公会 ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 区服列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 公会列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— |:—— -|:—— |:—— -| | 1 |\nguildId | string | true | 公会 ID | | 2 | guildName | string | true | 公会名 | | 3 |\nserverId | int | true | 服务器 ID | | 4 | guildLevel | int | false | 公会等级 | | 5 |\ncreatedAt | int | true | 公会创建时间 | | 6 | memberT otal | int | true | 公会成员总\n数 |7. GM 接口 [选接 ] 65\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\"
    },
    {
        "data": "createdAt | int | true | 公会创建时间 | | 6 | memberT otal | int | true | 公会成员总\n数 |7. GM 接口 [选接 ] 65\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: guilds' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=guilds&page=1&pageSize=100&serverId=123&guild=1234'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"guildId\" :\"123456\" ,\n\"guildName\" :\"Hunters\" ,\n\"serverId\" :123,\n\"guildLevel\" :10,\n\"createdAt\" :1643218800000 ,\n\"memberTotal\" :20\n},\n{\n\"guildId\" :\"789012\" ,\n\"guildName\" :\"Guild 1234\" ,\n\"serverId\" :123,\n\"guildLevel\" :5,\n\"createdAt\" :1643295600000 ,\n\"memberTotal\" :15\n}\n]\n}\n}7. GM 接口 [选接 ] 66\n获取公会成员列表\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取指定公会成员列表\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传guild_members\n2 page int true 页码，从 1开始\n3 pageSize int true 页面大小\n4 guildId string true 公会 ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义"
    },
    {
        "data": "•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传guild_members\n2 page int true 页码，从 1开始\n3 pageSize int true 页面大小\n4 guildId string true 公会 ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 公会成员信息\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 成员列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—– |:—— -| | 1 |\nplayerId | string | true | 成员玩家 ID | | 2 | nickname | string | true | 成员玩家昵\n称 |\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: guild_members' \\7. GM 接口 [选接 ] 67\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=guild_members&page=1&pageSize=20&guildId=123456'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":3,\n\"elements\" :[\n{\n\"playerId\" :\"123456\" ,\n\"nickname\" :\"Alice\"\n},\n{\n\"playerId\" :\"789012\" ,\n\"nickname\" :\"Bob\"\n},\n{\n\"playerId\" :\"345678\" ,"
    },
    {
        "data": "•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":3,\n\"elements\" :[\n{\n\"playerId\" :\"123456\" ,\n\"nickname\" :\"Alice\"\n},\n{\n\"playerId\" :\"789012\" ,\n\"nickname\" :\"Bob\"\n},\n{\n\"playerId\" :\"345678\" ,\n\"nickname\" :\"Charlie\"\n}\n]\n}\n}\n获取公会行为列表\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取指定公会过去一个月的行为日志，默认按发生时间降序排序\n•验参： CP接入签名规则\n•请求参数Query7. GM 接口 [选接 ] 68\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传guild_logs\n2 page int true 页码，从 1开始\n3 pageSize int true 页面大小\n4 guildId string true 公会 ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 公会成员信息\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—– | | 1 | total | int |\ntrue | 总数 | | 2 | elements | array | true | 日志列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— |:—— -|:—– |:————— -| | 1\n| playerId | string | true | 玩家 ID | | 2 | operation | string | true | 操作行为 | |\n3 | operateTime | int | true | 操作时间， 13位时间戳 (ms) |\n•请求样例"
    },
    {
        "data": "| playerId | string | true | 玩家 ID | | 2 | operation | string | true | 操作行为 | |\n3 | operateTime | int | true | 操作时间， 13位时间戳 (ms) |\n•请求样例\ncurl-XGET'https://goodgame.jp/api?queryType=guild_logs&page=1&pageSize=20&guildId=12345' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: guild_logs' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY='\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":5,\n\"elements\" :[7. GM 接口 [选接 ] 69\n{\n\"playerId\" :\"123456\" ,\n\"operation\" :\"123456 创建公会\",\n\"operateTime\" :1677734473000\n},\n{\n\"playerId\" :\"234567\" ,\n\"operation\" :\"234567 加入公会\",\n\"operateTime\" :1677734475000\n},\n{\n\"playerId\" :\"345678\" ,\n\"operation\" :\"345678 退出公会\",\n\"operateTime\" :1677734480000\n},\n{\n\"playerId\" :\"456789\" ,\n\"operation\" :\"345678 解散公会\",\n\"operateTime\" :1677734485000\n},\n{\n\"playerId\" :\"567890\" ,\n\"operation\" :\"567890 转让公会给 456789\",\n\"operateTime\" :1677734490000\n}\n]\n}\n}\n公会重命名操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP7. GM 接口 [选接 ] 70\n•说明： G123平台修改游戏公会数据（公会重名名）"
    },
    {
        "data": "},\n{\n\"playerId\" :\"567890\" ,\n\"operation\" :\"567890 转让公会给 456789\",\n\"operateTime\" :1677734490000\n}\n]\n}\n}\n公会重命名操作\n•调用方法： POST\n•请求方： G123\n•响应方： CP7. GM 接口 [选接 ] 70\n•说明： G123平台修改游戏公会数据（公会重名名）\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型rename\n2 template string true 公会数据操作类型 guilds\n3 data json true 重命名数据\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— -|:—— -|:—– |:—— -| | 1 | guildId |\nstring | true | 公会 ID | | 2 | guildName | string | true | 新的公会名称 |\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl-XPUT'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'Content-Type: application/json' \\\n-H'X-Gm-Action: rename' \\\n-H'X-Gm-Template: guilds' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"rename\",\n\"template\": \"guilds\",\n\"data\": {\n\"guildId\": \"12345\",\n\"guildName\": \"HouseOfNorth\"\n}\n}'7. GM 接口 [选接 ] 71\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"重命名成功 \"\n}\n•重名情况"
    },
    {
        "data": "-d'{\n\"action\": \"rename\",\n\"template\": \"guilds\",\n\"data\": {\n\"guildId\": \"12345\",\n\"guildName\": \"HouseOfNorth\"\n}\n}'7. GM 接口 [选接 ] 71\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"重命名成功 \"\n}\n•重名情况\nHTTP/1.1 409 Conflict\nContent-Type: application/json\n{\n\"status\": 10001,\n\"message\": \" 公会名已存在，请使用其他名称。 \"\n}\n7.4.5 玩家封禁查询 /操作\n获取禁言玩家类型\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取禁言玩家类型\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传mute_types\n•响应参数7. GM 接口 [选接 ] 72\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 详细枚举列表\n4 language string true 当前语言\ndata |编号 |字段名 |类型 |必传 |描述 | | :—| :—| :—| :—| :—|\n| 1 | muteType |string | true | 禁言类型，由运营和 CP制定，比如（ private_chat,\npublic_chat ）| | 2 | displayName | string | true | 显示名字，比如（公共聊天 ,私聊） |\n•请求样例\ncurl-XGET\\\n'https://goodgame.jp/api?queryType=mute_types&language=ja \\\n-H 'Accept: application/json ' \\\n-H 'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY= ' \\"
    },
    {
        "data": "•请求样例\ncurl-XGET\\\n'https://goodgame.jp/api?queryType=mute_types&language=ja \\\n-H 'Accept: application/json ' \\\n-H 'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY= ' \\\n-H 'X-Gm-QueryType: mute_types '\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":[\n{\n\"muteType\" :\"private_chat\" ,\n\"displayName\" :\"個人チャット \"\n},\n{\n\"muteType\" :\"public_chat\" ,\n\"displayName\" :\"パブリックチャット \"\n}\n]\n}7. GM 接口 [选接 ] 73\n封禁列表查询\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取封禁列表\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传ban_list\n2 page int true 页码，从 1开始\n3 pageSize int true 页面大小\n4 banType string true 账号封禁类型：封禁 (lock)/ 禁言 (mute)\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 封禁玩家列表\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—— -| | 1 | total | int\n| true | 总数 | | 2 | elements | array | true | 封禁玩家列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—— |:"
    },
    {
        "data": "data |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— |:—– |:—— -| | 1 | total | int\n| true | 总数 | | 2 | elements | array | true | 封禁玩家列表 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—— |:\n———————————————————————— | | 1 | playerId | string | true | 玩家\nID | | 2 | serverId | string | true | 服务器 ID | | 3 | level | int | true | 玩家等级 | | 4\n| muteType | string | false | 如果请求参数的 banType 是mute，则返回muteType ，\n这里和获取禁言玩家类型 返回的muteType 保持一致 | | 5 | updateTime | int |\ntrue | 封禁玩家操作时间， 13位时间戳（ ms）| | 6 | endTime | int | true | 封禁结束时间，\n13位时间戳（ ms）为 0时永久 | | 7 | operatorName | string | true | 操作者名 | | 8 |\nnote | string | true | 附注说明 |7. GM 接口 [选接 ] 74\n•如果 endTime 少于请求时间或者 Ban已被解除，应从封禁列表中移除\n如果banType=lock\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: ban_list' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=ban_list&page=1&pageSize=10&banType=lock'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":2,"
    },
    {
        "data": "-d'queryType=ban_list&page=1&pageSize=10&banType=lock'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"playerId\" :\"player123\" ,\n\"serverId\" :123,\n\"level\":50,\n\"muteType\" :\"\",\n\"updateTime\" :1677734473000 ,\n\"endTime\" :1677834483000 ,\n\"operatorName\" :\"Admin\",\n\"note\":\"Account banned for violating game rules\"\n},\n{\n\"playerId\" :\"player456\" ,\n\"serverId\" :456,\n\"level\":30,\n\"muteType\" :\"\",\n\"updateTime\" :1677734473000 ,7. GM 接口 [选接 ] 75\n\"endTime\" :1677834483000 ,\n\"operatorName\" :\"Admin\",\n\"note\":\"Account banned for inappropriate behavior\"\n}\n]\n}\n}\n如果banType=mute\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: ban_list' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=ban_list&page=1&pageSize=10&banType=mute'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"playerId\" :\"player123\" ,\n\"serverId\" :123,\n\"level\":50,\n\"muteType\" :\"private_chat\" ,"
    },
    {
        "data": "•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"total\":2,\n\"elements\" :[\n{\n\"playerId\" :\"player123\" ,\n\"serverId\" :123,\n\"level\":50,\n\"muteType\" :\"private_chat\" ,\n\"updateTime\" :1677734473000 ,\n\"endTime\" :1677834473000 ,\n\"operatorName\" :\"Admin\",\n\"note\":\"Account muted for violating game rules\"\n},7. GM 接口 [选接 ] 76\n{\n\"playerId\" :\"player456\" ,\n\"serverId\" :456,\n\"level\":30,\n\"muteType\" :\"guild_chat\" ,\n\"updateTime\" :1677734473000 ,\n\"endTime\" :1677834473000 ,\n\"operatorName\" :\"Admin\",\n\"note\":\"Account muted for inappropriate behavior\"\n}\n]\n}\n}\n玩家 ID查询封禁状态\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取玩家 ID查询封禁状态\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传ban_status\n2 page int true 玩家 ID\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data json true 玩家当前封禁状态7. GM 接口 [选接 ] 77\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—— |:————————————————————————\n| | 1 | banType | string | true | 账号封禁类型：封禁 (lock)/ 禁言 (mute) | | 2 |"
    },
    {
        "data": "3 data json true 玩家当前封禁状态7. GM 接口 [选接 ] 77\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—— |:————————————————————————\n| | 1 | banType | string | true | 账号封禁类型：封禁 (lock)/ 禁言 (mute) | | 2 |\nmuteType | string | false | 如果请求参数的 banType 是mute，则返回muteType ，\n这里和获取禁言玩家类型 返回的muteType 保持一致 | | 1 | endTime | int | true |\n封禁结束时间， 13位时间戳（ ms）为 0时永久 | | 2 | note | string | true | 附注说明 |\nelements |编号 |字段名 |类型 |必传 |描述 | |:—|:———— -|:—— -|:—— |:\n———————————————————————— | | 1 | playerId | string | true | 玩家\nID | | 2 | serverId | string | true | 服务器 ID | | 3 | level | int | true | 玩家等级 | | 4\n| muteType | string | false | 如果请求参数的 banType 是mute，则返回muteType ，\n这里和获取禁言玩家类型 返回的muteType 保持一致 | | 5 | updateTime | int |\ntrue | 封禁玩家操作时间， 13位时间戳（ ms）| | 6 | endTime | int | true | 封禁结束时间，\n13位时间戳（ ms）为 0时永久 | | 7 | operatorName | string | true | 操作者名 | | 8 |\nnote | string | true | 附注说明 |\n•如果 endTime 少于请求时间或者 Ban已被解除，应从封禁列表中移除\n如果banType=lock\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\"
    },
    {
        "data": "note | string | true | 附注说明 |\n•如果 endTime 少于请求时间或者 Ban已被解除，应从封禁列表中移除\n如果banType=lock\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: ban_status' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=ban_status&playerId=player123'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":{\n\"banType\" :\"mute\",\n\"muteType\" :\"private_chat\" ,\n\"endTime\" :1677834483000 ,\n\"note\":\"Account muted for violating game rules\"7. GM 接口 [选接 ] 78\n}\n}\n封禁玩家\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明： G123平台封禁玩家请求\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型ban_account\n2 template string true 玩家数据模板类型 players\n3 data json true 数据\ndata\n编号 字段名 类型 必传 描述\n1 playerId string true 玩家 ID\n2 banType string true 账号封禁类型：封禁 (lock)/ 禁言\n(mute)\n3 muteType string false 禁言类型，从【获取禁言玩家类型】的\ntype\n4 endTime int true 封禁结束时间， 13位时间戳（ ms）为\n0时永久封禁\n5 note string true 附注说明\n6 operatorName string true 操作者名\n•响应参数JSON7. GM 接口 [选接 ] 79\n编号 字段名 类型 必传 描述"
    },
    {
        "data": "(mute)\n3 muteType string false 禁言类型，从【获取禁言玩家类型】的\ntype\n4 endTime int true 封禁结束时间， 13位时间戳（ ms）为\n0时永久封禁\n5 note string true 附注说明\n6 operatorName string true 操作者名\n•响应参数JSON7. GM 接口 [选接 ] 79\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl-XPOST'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'Content-Type: application/json' \\\n-H'X-Gm-Action: ban_account' \\\n-H'X-Gm-Template: players' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"ban_account\",\n\"template\": \"players\",\n\"data\": {\n\"playerId\": \"player123\",\n\"banType\": \"lock\",\n\"endTime\": 1677734473000,\n\"note\": \"Account banned for violating game rules\",\n\"operatorName\": \"John.S\"\n}\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"玩家封禁请求成功 \"\n}\n解除玩家封禁\n•调用方法： POST\n•请求方： G1237. GM 接口 [选接 ] 80\n•响应方： CP\n•说明： G123平台解封玩家请求\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型ban_lift\n2 template string true 玩家数据模板类型 players\n3 data json true 数据"
    },
    {
        "data": "•调用方法： POST\n•请求方： G1237. GM 接口 [选接 ] 80\n•响应方： CP\n•说明： G123平台解封玩家请求\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型ban_lift\n2 template string true 玩家数据模板类型 players\n3 data json true 数据\ndata |编号 |字段名 |类型 |必传 |描述 | |:—|:——— |:—— -|:—– |:——– | | 1 | playerId\n| string | true | 被操作玩家 ID |\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n•请求样例\ncurl-XPOST'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'Content-Type: application/json' \\\n-H'X-Gm-Action: ban_lift' \\\n-H'X-Gm-Template: players' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"ban_lift\",\n\"template\": \"players\",\n\"data\": {\n\"playerId\": \"player123\"\n}\n}'7. GM 接口 [选接 ] 81\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"玩家解封请求成功 \"\n}\n7.4.6 拉取道具资源列表\n获取道具资源列表\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取游戏内有效的道具、资源列表。本接口为 F orge GM 工具中道具信息\n获取的主要数据源，并将作为 G123 AI 礼包配置的主要数据源。\n•验参： CP接入签名规则\n•请求参数Query\n编\n号 字段名 类型 必传 描述"
    },
    {
        "data": "}\n7.4.6 拉取道具资源列表\n获取道具资源列表\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取游戏内有效的道具、资源列表。本接口为 F orge GM 工具中道具信息\n获取的主要数据源，并将作为 G123 AI 礼包配置的主要数据源。\n•验参： CP接入签名规则\n•请求参数Query\n编\n号 字段名 类型 必传 描述\n1 queryType string true 默认传 assets\n2 language string true 参照语言枚举\n3 itemName string false 查询道具名\n•响应参数\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 区服列表\ndata7. GM 接口 [选接 ] 82\n编\n号 字段名 类型 必传 描述\n1 itemId string true 道具 /资源 ID\n2 name string true 道具 /资源名 ,按照 query 中语言进行赋值\n3 i18nKey string true 道具 /资源表示名字的多语言 key\n4 detail string true 道具 /资源的描述信息\n5 detailI18nKey string true 道具 /资源的描述信息的多语言 key\n6 iconUrl string true 道具 /资源 Icon ctw-box link\n7 value float true 道具原始价格\n8 typeId string true 物品分类的类别 ID\n9 typeName string true 物品分类的类别名字\n10 isStoreSupported bool true 是否属于配置道具商城\n11 isAiSupportedbool true 是否支持配置 AI礼包 (如果道具属于联名道具或\n者需要严格管理投放数量，请传 false 0)\n12 attributes json true 道具 /资源属性\nattributes\nattributes 运营礼包，道具商城所需支持信息其中 store_category :根据游戏定制化的目\n录,方便玩家选择自己所需道具"
    },
    {
        "data": "11 isAiSupportedbool true 是否支持配置 AI礼包 (如果道具属于联名道具或\n者需要严格管理投放数量，请传 false 0)\n12 attributes json true 道具 /资源属性\nattributes\nattributes 运营礼包，道具商城所需支持信息其中 store_category :根据游戏定制化的目\n录,方便玩家选择自己所需道具\n编号 字段名 类型 必传 描述\n1 storeDisplayPrice int true when is_store_supported\nfalse, then empty , 运营后期补\n值\n2 storeCategory string true 道具的贩卖目录 key值, value\ncan be empty , 运营后期补值 ,\n取值例 : charac-\nter_up/character_skill\n3 setQuantity int true 道具贩卖的打包的最小单位个数。例\n如:碎片 100个才有意义 ,该值最\n小单位为 1007. GM 接口 [选接 ] 83\n编号 字段名 类型 必传 描述\n4 purchaseLimit int true 道具贩卖的个数限制 , 0 = No\nlimit\n5 sellMinCp int true 可供贩卖的最低性价比 ,取值如 :\n100, 150, 表示意思 : 100%,\n150%\n6 sellMaxCp int true 可供贩卖的最高性价比 ,取值如 :\n300, 500, 表示意思 : 300%,\n500%\n7 rarity string true 道具稀有度，使用颜色表示稀有度：\n灰色 /绿色 /蓝色 /紫色 /橙色 /红\n色/金色 /彩色\n•请求样例\ncurl https://goodgame.jp/api ?queryType=assets &language =zh&itemName =稀有碎片 \\\n-H\"Accept: application/json\" \\\n-H\"X-Gm-QueryType: assets\" \\\n-H\"Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=\"\n•响应样例\n{\n\"status\" :0,"
    },
    {
        "data": "-H\"Accept: application/json\" \\\n-H\"X-Gm-QueryType: assets\" \\\n-H\"Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=\"\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":[\n{\n\"itemId\" :\"11111\",\n\"name\":\"稀有碎片\",\n\"i18nKey\" :\"111111\" ,\n\"detail\" :\"稀有的碎片 \",\n\"detailI18nKey\" :\"11111111\" ,\n\"iconUrl\" :\"https://goodgame.jp/cdn/icon/138392\" ,\n\"value\":9999.0,7. GM 接口 [选接 ] 84\n\"typeId\" :\"111\",\n\"typeName\" :\"升级素材\",\n\"isStoreSupported\" :true,\n\"isAiSupported\" :false,\n\"attributes\" :{\n\"storeDisplayPrice\" :9999,\n\"storeCategory\" :\"character_up\" ,\n\"setQuantity\" :100,\n\"purchaseLimit\" :0,\n\"sellMinCp\" :100,\n\"sellMaxCp\" :500,\n\"rarity\" :\"绿色\",\n}\n}\n]\n}\n7.5高级功能系统\n协议说明\n•本文档意图说明接入 G123 GM 工具内的高级功能系统所需提供的操作类型。\n•实现了对应接口后，请将 W ebhook 地址填入 Publisher 工具–>[GM 工具 ]–>[高级功\n能 API]模块。\nHTTP 状态码\nHTTP 状态码 含义\n200 - OK 操作成功\n400 - Bad Request 错误请求，参数不合法或其他原因\n401 - Unauthorized 鉴权失败，未附 API key 或其他原因\n402 - Request F ailed 参数合法但其他原因请求失败\n403 - F orbidden 无权操作资源7. GM 接口 [选接 ] 85\nHTTP 状态码 含义\n404 - Not F ound 该资源不可达"
    },
    {
        "data": "400 - Bad Request 错误请求，参数不合法或其他原因\n401 - Unauthorized 鉴权失败，未附 API key 或其他原因\n402 - Request F ailed 参数合法但其他原因请求失败\n403 - F orbidden 无权操作资源7. GM 接口 [选接 ] 85\nHTTP 状态码 含义\n404 - Not F ound 该资源不可达\n409 - Conflict 资源状态与当前请求冲突\n500～504 - Server Errors 服务器内部错误\n7.5.1 充值礼包列表\n•调用方法： GET\n•请求方： G123\n•响应方： CP\n•说明： G123平台获取充值礼包列表\n•验参： CP接入签名规则\n•请求参数Query\n编号 字段名 类型 必传 描述\n1 queryType string true 默认传recharge_gifts\n2 language string true 当前语言\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\n3 data array true 充值礼包列表\ndata\n编号 字段名 类型 必传 描述\n1 giftId string true 充值礼包 ID\n2 giftName string true 充值礼包名\n3 eventId string false 对应充值活动 ID7. GM 接口 [选接 ] 86\n编号 字段名 类型 必传 描述\n4 eventName string false 对应充值活动名\n•请求样例\ncurl-XGET'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'X-Gm-QueryType: recharge_gifts' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=recharge_gifts&language=en'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\","
    },
    {
        "data": "-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'queryType=recharge_gifts&language=en'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"查询成功\",\n\"data\":[\n{\n\"giftId\" :\"gift123\" ,\n\"giftName\" :\"Beginner's Pack\" ,\n\"eventId\" :\"event456\" ,\n\"eventName\" :\"Recharge Event\"\n},\n{\n\"giftId\" :\"gift789\" ,\n\"giftName\" :\"Premium Pack\" ,\n\"eventId\" :\"event456\" ,\n\"eventName\" :\"Recharge Event\"\n}\n]\n}7. GM 接口 [选接 ] 87\n7.5.2 充值补单 /养号\n•调用方法： POST\n•请求方： G123\n•响应方： CP\n•说明：平台运营需要针对掉单玩家进行补单或者对 GM白名单玩家进行养号模拟充值\n•验参： CP接入签名规则\n•请求参数JSON\n编号 字段名 类型 必传 描述\n1 action string true 操作类型gm_recharge\n2 template string true 玩家数据模板类型 players\n3 data json true 数据\ndata\n编\n号 字段名 类型 必传 描述\n1 playerId string true 玩家 ID\n2 rechargeType string true 行为枚举：补单 -order Id(compensation)\n补单 -礼包 ID(compensation_gift)\n模拟充值 (simulate_recharges)\n3 orderId string false 订单 ID，compensation 类型时，该参数为必传\n4 eventId string false 活动 ID，simulate_recharges ，\ncompensation_gift 类型时，该参数必传\n5 giftId string false 礼包 ID，simulate_recharges ，"
    },
    {
        "data": "3 orderId string false 订单 ID，compensation 类型时，该参数为必传\n4 eventId string false 活动 ID，simulate_recharges ，\ncompensation_gift 类型时，该参数必传\n5 giftId string false 礼包 ID，simulate_recharges ，\ncompensation_gift 类型时，该参数必传\n以上三种rechargeType 中： - compensation - compensation_gift\n为对普通玩家的充值行为，其中 compensation_gift 不会透传orderId ，- simu-\nlate_recharges\n视作运营或 GM养号行为， G123会做白名单校验。7. GM 接口 [选接 ] 88\n•响应参数JSON\n编号 字段名 类型 必传 描述\n1 status int false 响应状态码，用户可自定义\n2 message string false 响应信息，用户可自定义\nrechargeType 为compensation 时\n•请求样例\ncurl-XPOST'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'Content-Type: application/json' \\\n-H'X-Gm-Action: gm_recharge' \\\n-H'X-Gm-Template: players' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"gm_recharge\",\n\"template\": \"players\",\n\"data\": {\n\"playerId\": \"player123\",\n\"rechargeType\": \"compensation\",\n\"orderId\": \"order456\",\n\"eventId\": \"\",\n\"giftId\": \"\"\n}\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"GM充值成功\"\n}"
    },
    {
        "data": "\"template\": \"players\",\n\"data\": {\n\"playerId\": \"player123\",\n\"rechargeType\": \"compensation\",\n\"orderId\": \"order456\",\n\"eventId\": \"\",\n\"giftId\": \"\"\n}\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"GM充值成功\"\n}\nrechargeType 是simulate_recharges 时7. GM 接口 [选接 ] 89\n•请求样例\ncurl-XPOST'https://goodgame.jp/api' \\\n-H'Accept: application/json' \\\n-H'Content-Type: application/json' \\\n-H'X-Gm-Action: gm_recharge' \\\n-H'X-Gm-Template: players' \\\n-H'Authorization: Basic Z29vZGdhbWU6U0VDMXhYdkNrZlIxcVZoWjJHTldSdDJKazVFNVI4aHBkRXY=' \\\n-d'{\n\"action\": \"gm_recharge\",\n\"template\": \"players\",\n\"data\": {\n\"playerId\": \"player123\",\n\"rechargeType\": \"simulate_recharges\",\n\"orderId\": \"\",\n\"eventId\": \"e_123\",\n\"giftId\": \"monthcard_1\"\n}\n}'\n•响应样例\n{\n\"status\" :0,\n\"message\" :\"GM充值成功\"\n}5.客服接口 1\nimport Callout from ‘nextra-theme-docs/callout ’\n5.客服接口\n游戏内通过接入此 API调起G123平台提供的客服系统\n5.1前端上报玩家关键信息 API\n此API主要用于，向平台客服系统传入，玩家当前游戏内的信息。接入 客服API前，必须要接入此\nAPI。通常在游戏登录成功时调用此方法即可。\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"inform\" ,\n\"data\":{"
    },
    {
        "data": "5.客服接口\n游戏内通过接入此 API调起G123平台提供的客服系统\n5.1前端上报玩家关键信息 API\n此API主要用于，向平台客服系统传入，玩家当前游戏内的信息。接入 客服API前，必须要接入此\nAPI。通常在游戏登录成功时调用此方法即可。\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"inform\" ,\n\"data\":{\n\"role_id\" :\"U-123-ABC\" ,\n\"role_name\" :\"我是角色名 \",\n\"game_server\" :\"S101\",\n\"tags\":['VIP2','tag2','tag3','tag4']\n}\n}),'*');\n参数\nparameter value required?\nrole_id 玩家在游戏内的唯一 uid Yes\nrole_name 玩家在游戏内的角色名 Yes\ngame_server 玩家当前的游戏服 Yes\ntags 玩家的关键信息 (VIP等级信息为必须 ，\n其他信息请在对接群中与 PM沟通)，数\n量没有上限，只允许英文数字字母，有多个\ntag时请用英文” ,“号隔开Yes为平台活动提供的事件触发 2\n5.2客服 API\n玩家点击游戏内的客服按钮时调用此方法，必须实现 前端上报玩家关键信息 api\nwindow.top.postMessage (JSON.stringify ({\n\"action\" :\"support\"\n}),'*');\n为平台活动提供的事件触发\n平台会在某些时候需要获取游戏内的事件，并根据事件开展活动。为防止作弊，需要 CP和平台进行 服\n务器间的通讯协作。\n1.level_up 事件\nCP对应流程\n1.创建事件：当用户每次升级时 , CP游戏服务器向平台服务器发送事件，平台返回响应消息\n2.触发事件：CP游戏服务器将收到的响应消息推送至游戏前端 ,前端再将该信息通过 win-\ndow.top.postMessage 发送到平台主窗口完成触发。\n注:游戏服务器端 要确保用户确实升级\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp"
    },
    {
        "data": "2.触发事件：CP游戏服务器将收到的响应消息推送至游戏前端 ,前端再将该信息通过 win-\ndow.top.postMessage 发送到平台主窗口完成触发。\n注:游戏服务器端 要确保用户确实升级\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp\n此外， 该流程使用登录流程的 appId 和appSecret ， 参见https://developers.g123.jp/login.html#_1-\n%E7%99%BB%E5%BD%95为平台活动提供的事件触发 3\n1.1创建事件\nPOST /api/v1/cp/game_event/level_up\nRequest Header 使用Basic认证方式发送 appId 和appSecret\nRequest header Description\nContent-Type application/json\nAuthorization Basic base64( ‘𝑎𝑝𝑝𝐼 𝑑 ∶appSecret ’)\nRequest Body\nRequest Body Format Value Required\nuid string 用户游戏唯一标示 id Yes\nserver_id string 用户所在游戏服 id Yes\nctwid string g123 平台生成id Yes\ntimestamp long 事件发生时间 (UNIX 时间单位:ms) Yes\nlevel integer 用户级别 Yes\nResponse Body 状态码: 200消息内容：JSON 格式的返回数据\n注:返回的数据格式可能会在正式版本发布时有所变动，请在 1.2前端事件触发这一步中，将返回数\n据全部通过 postMessage 提交\n示例\ncurl -i -X POST \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization:Basic $(echo -n $APP_ID:$APP_SECRET | openssl base64)\" \\\n-d \\\n'{\n\"uid\": \"123\",CP需要提供的接口 4\n\"server_id\": \"s73\",\n\"ctwid\": \"GIL6T4CO\","
    },
    {
        "data": "-H \"Content-Type:application/json\" \\\n-H \"Authorization:Basic $(echo -n $APP_ID:$APP_SECRET | openssl base64)\" \\\n-d \\\n'{\n\"uid\": \"123\",CP需要提供的接口 4\n\"server_id\": \"s73\",\n\"ctwid\": \"GIL6T4CO\",\n\"timestamp\": 1605076260715,\n\"level\": 10\n}' \\\n'https://h5.stg.g123.jp/api/v1/cp/game_event/level_up'\nOUTPUT:\nHTTP/1.1 200 OK\nvary: accept-encoding\ncontent-type: application/json;charset=UTF-8\ntransfer-encoding: chunked\ndate: Wed, 11 Nov 2020 07:53:51 GMT\nconnection: close\n{\"action\":\"game_event_created\",\"id\":\"1\",\"token\":\"fdda6c9f-5745-4adc-9541-c3827d654dfa\"}\n注:返回的数据格式今后可能会发生变更，请将平台返回的完整消息传递到前端进行触发\n1.2前端事件触发\n将平台服务器的返回的消息，在前端通过 window.top.postMessage 传递到平台\nwindow.top.postMessage(responseData, '*');\nimport Callout from ‘nextra-theme-docs/callout ’\nCP需要提供的接口\n游戏玩家角色查询接口\n•调用方式：HTTP POST\n•使用场景：平台查询玩家在游戏中每个区服的角色信息CP需要提供的接口 5\n注意：-安全策略：接口需增加 IP白名单\nRequest Body\n参数 示例 签名 说明\nappID ceruhor 是 G123平台发行的的\nappID\nCTWID G123ABC 是 玩家在G123平台的\nID\nserver 1 是 游戏区服编号，如该字段\n为空，则需返回改玩家在\n游戏内所有区服的角色信\n息"
    },
    {
        "data": "•使用场景：平台查询玩家在游戏中每个区服的角色信息CP需要提供的接口 5\n注意：-安全策略：接口需增加 IP白名单\nRequest Body\n参数 示例 签名 说明\nappID ceruhor 是 G123平台发行的的\nappID\nCTWID G123ABC 是 玩家在G123平台的\nID\nserver 1 是 游戏区服编号，如该字段\n为空，则需返回改玩家在\n游戏内所有区服的角色信\n息\ntime 1571192005377 是 服务端时间戳 13位[毫\n秒]\nsign\n‘9397176eabd8c494946df910d98a41f2 ’否 签名规则\nResponse\n{\n\"code\":200,\n\"message\" :\"success\" ,\n\"data\":[\n{\n\"server\" :1, //游戏区服，如单个区服有多个角色，需以多个数据返回\n\"roleName\" :\"アイウエオ \", //角色名称\n\"roleId\" :12, //角色 id\n\"level\":13, //等级\n\"vipLevel\" :1 // vip等级\n},\n{\n\"server\" :10, //游戏区服CP需要提供的接口 6\n\"roleName\" :\"剑仙2\", //角色名称\n\"roleId\" :13, //角色 id\n\"level\":5, //等级\n\"vipLevel\" :10 // vip等级\n},\n{\n\"server\" :218, //游戏区服\n\"roleName\" :\"剑仙2\", //角色名称\n\"roleId\" :14, //角色 id\n\"level\":170, //等级\n\"vipLevel\" :13 // vip等级\n}\n]\n}\n异常\n{\n\"code\":401,\n\"message\" :\"params error\" //参数错误\n}\n签名规则\n将属于签名的参数列表，按照参数名称字母先后顺序排序 : key1=value1 …. keyN=valueN 。\nvalueN 需过滤特殊字符，使用 php:rawurldecode 等进行解密说明： + php 的rawur-\nlencode 和urlencode 区别是在空格加密不一样， rawurlencode:%20 urlencode:+ +"
    },
    {
        "data": "}\n签名规则\n将属于签名的参数列表，按照参数名称字母先后顺序排序 : key1=value1 …. keyN=valueN 。\nvalueN 需过滤特殊字符，使用 php:rawurldecode 等进行解密说明： + php 的rawur-\nlencode 和urlencode 区别是在空格加密不一样， rawurlencode:%20 urlencode:+ +\nphp的rawurlencode 和js的encodeURIComponent 遵循的是国际标准备忘录 RFC\n3986，理论上可互通 +js的base64 库\n•将分配的得到的密钥（ callbackKey ）接到参数字符串尾部进行 md5加密（UTF8 编码）\n•格式是：md5(key1=value1key2=value2 …callbackKey)\n<?phpCP需要提供的接口 7\n$data=array(\n\"appId\" =>$appId,\n\"CTWID\" =>$money,\n\"server\" =>$server,\n\"time\"=>$time,\n\"xxxx\"=>$xxxx,\n$sign=generateSign( $data,$callbackKey );\n/**\n*签名算法\n*/\nfunction generateSign( $data,$callbackKey ='')\n{\nif(empty($data))\nreturn'';\nksort($data);\n$str=\"\";\nforeach($data as$k=>$v)\n$str.=sprintf(\"%s=%s\",$k,$v);\nreturnmd5(sprintf(\"%s%s\",$str,$callbackKey ));\n}\n```import Callout from 'nextra-theme-docs/callout'\n# 4.追踪转化 (过期)\n使用场景：玩家触发 `玩家创角成功 `事件(广告转化条件 )时，游戏通过此 API通知平台。\n```js\ntry{\nwindow.top.postMessage( JSON.stringify({11.分析用数据同步 8\nevent:'CreateRole' ,\n}),'https://h5.stg.g123.jp' );\n//正式环境 https://h5.g123.jp"
    },
    {
        "data": "使用场景：玩家触发 `玩家创角成功 `事件(广告转化条件 )时，游戏通过此 API通知平台。\n```js\ntry{\nwindow.top.postMessage( JSON.stringify({11.分析用数据同步 8\nevent:'CreateRole' ,\n}),'https://h5.stg.g123.jp' );\n//正式环境 https://h5.g123.jp\n} catch(e) {\nwindow.console &&window.console.log(e);\n}\n*一位玩家只允许触发一次广告转化条件 *根据游戏不同， 会有玩家创角事件以外的转化条件 import\nCallout from “nextra-theme-docs/callout ”;\n11.分析用数据同步\n平台为运营团队提供各种数据分析支持，如游戏活动效果等。数据来源需要 CP将各类数据以特定格式\n上传至平台 s3指定位置。\n11.1游戏内活动信息\n目的是将礼包内容和活动信息同步，以活动为单位进行分析。\nA WS S3 指定位置\ns3://production-g123-data-tier1/biz-external-game-{appid}/{yyyy}/{mm}/{dd}/\n-appid 为平台给游戏分配的 ID， 与其他接口用的 appid相同， 该路径由平台创建 -链接中的时间为\n上传的时间平台会为游戏在 S3建立上述指定的上传位置，请在钉钉交流群联系平台负责人沟通 AWS\nS3访问方法用例 :s3://production-g123-data-tier1/biz-external-game-your_game/2022/09/13/\n上传时机与方式\n•新的活动生成时\n•准备自动化脚本每日或者定期自动上传最新内容（为提升效率，这一步请务必实施）11.分析用数据同步 9\n文件命名与格式\n•文件格式：csv或者xlsx\n•文件名： events.csv 或者 events.xlsx\ncolumns format value required desc\nappid string Yes\nevent_type string Yes 区分活\n动类型\n（主题，\n日常等）\nevent_id string Yes 活动\nid\nevent_name string Yes 活动名\n如主题\n人物名"
    },
    {
        "data": "•文件格式：csv或者xlsx\n•文件名： events.csv 或者 events.xlsx\ncolumns format value required desc\nappid string Yes\nevent_type string Yes 区分活\n动类型\n（主题，\n日常等）\nevent_id string Yes 活动\nid\nevent_name string Yes 活动名\n如主题\n人物名\n字等，\n或者开\n服活动\nsub_event_id string 可以为空 如果有\n主题活\n动下的\n副活动，\n可以记\n入\nsub_event_name string 可以为空 副活动\n名\nitem_id string Yes 礼包\nid\nitem_name string Yes 礼包名\nitem_price integer Yes 礼包价\n格11.分析用数据同步 10\ncolumns format value required desc\ncurrency string Yes 礼包价\n格的货\n币单位\nstart_date string YYY-MM-DD Yes 活动起\n始时间\nend_date string YYY-MM-DD Yes 活动结\n束时间\n用例\n平台为游戏 appid=queensblade 创建的指定位置\n#\n8.数据属性\n基础属性\n游戏服\n游戏服开服时间，以及合服信息\ncolumns format value required desc\nid string 原游戏服id Yes\nbegin_time unix time int(10) 开服时间 Yes11.分析用数据同步 11\ncolumns format value required desc\nstate integer 是否合服，0：没有，\n1:合服Yes\nworld_id string 合服后id Yes\n道具\n道具的meta配置表。\n请按照各游戏即有的配置表直接同步过来\n例：异世界配置表\ncolumns format （default ）value required （default ）\nid 物品ID\ntime 生效时间\nautoUse 进包自动使用\nmagic 使用魔法属性\npar 使用魔法属性\n参数\nquality 品质\nname 物品名称\ndesc 物品描述\ndesc1 物品来源"
    },
    {
        "data": "道具\n道具的meta配置表。\n请按照各游戏即有的配置表直接同步过来\n例：异世界配置表\ncolumns format （default ）value required （default ）\nid 物品ID\ntime 生效时间\nautoUse 进包自动使用\nmagic 使用魔法属性\npar 使用魔法属性\n参数\nquality 品质\nname 物品名称\ndesc 物品描述\ndesc1 物品来源\ntype 类型\ntypeTwo 子类型\ncanUse 能否使用\npanelId 使用弹出面板\ncomposeNeed 合成所需数量\nhuodongId 所属活动\nindex 排序\nredpoint 是否显示红点\nrepetItem 重复获得11.分析用数据同步 12\ncolumns format （default ）value required （default ）\nhero 武将ID\ncomposeNeed2 兑换所需数量\ntab 合成页签\n礼包\n礼包配置表，按各游戏的礼包配置表直接同步信息\n例：异世界礼包配置表\ncolumns value\npid 平台id\nzoneid 手机系统类型\ngoodsId 商品id\ngoodsId1 商品编号\ngold 充值金额日元\nyuanbao 充值元宝\nvipExp 获得VIP经验\nname 商品名称\ndesc 商品描述\ngiftcost1 价值1\ngiftcost2 价值2\nimgName 商品图片\ntype 商品类型\nparam 商品参数\nitemlist 充值获得道具\nlinkId 关联ID\nnode 活动节点\nlibaoType 礼包类型\nfirstRecharge 是否算首充\ncostitem 消耗道具11.分析用数据同步 13\ncolumns value\ntrigger 是否触发运营活动\nneedShow 是否在充值列表展示 (0=显示，1=不显示）\ndesc2 页面展示描述\nsortNum 显示顺序（最小的在第一条）\ngold2 开服特惠价格\nisFourfold 首充送几倍元宝（ 0不加倍，3是三倍）\ndesc3 三倍页面展示描述\nratio 折扣比例\n礼包道具的中日文名称对应信息（ Optional ）\n*如果有的话需要同步。\n用户属性\n基本属性"
    },
    {
        "data": "needShow 是否在充值列表展示 (0=显示，1=不显示）\ndesc2 页面展示描述\nsortNum 显示顺序（最小的在第一条）\ngold2 开服特惠价格\nisFourfold 首充送几倍元宝（ 0不加倍，3是三倍）\ndesc3 三倍页面展示描述\nratio 折扣比例\n礼包道具的中日文名称对应信息（ Optional ）\n*如果有的话需要同步。\n用户属性\n基本属性\n根据各游戏的相关用户信息做同步，所需要获取的信息：对用户在游戏里的一些有重要影响的信息，比\n如：用户的 demographic 信息，用户在游戏里的使用信息等。\n例：异世界\nColumn Format ValueRequired （If exist then\nYes)\nuid string 用户游戏唯一\n标示idYes\nname string 用户昵称 Yes\nsex string 用户注册性别 Yes\nctwid string g123 平台\nidYes\nserver_id string 游戏服id Yes11.分析用数据同步 14\nColumn Format ValueRequired （If exist then\nYes)\nreg_time Unix\ntime注册时间 Yes\nlevel string 玩家级别 Yes\nvip_level string 玩家vip级\n别Yes\nvip_exp string 玩家vip经\n验Yes\nlast_login_time Unix\ntime上次登录时间 Yes\nlast_online_time Unix\ntime上次在线时间 Yes\nlogin_streak integer 连续登录天数 Yes\ndevice_id string 设备唯一标示\n符Yes\nmoney integer 金币 Yes\nfood integer 粮食 Yes\nintelligence integer 魔力 Yes\ngold integer 元宝 Yes\nexp integer 等级经验 Yes\nenergy integer 美女精力 Yes\npower integer 战力 Yes\nmarkDays integer 签到总天数 Yes\nyearCardDays integer 年卡天数 Yes\nmonthCardDays integer 月卡天数 Yes"
    },
    {
        "data": "gold integer 元宝 Yes\nexp integer 等级经验 Yes\nenergy integer 美女精力 Yes\npower integer 战力 Yes\nmarkDays integer 签到总天数 Yes\nyearCardDays integer 年卡天数 Yes\nmonthCardDays integer 月卡天数 Yes\nrechargeGear integer 首充状态 Yes\ntoday_online_time integer 今天在线时间 Yes11.分析用数据同步 15\n行为属性\n打点事件 event_type: - ‘g_view ’:浏览事件-‘g_click ’:点击事件-‘g_obtain ’:道\n具获得-‘g_consumption ’:消耗事件\nformat ：v2\ncolumns format value required desc\nevent_type string event type: ‘g_view ’,\n‘g_click ’\nversion string 打点版本号 Yes\nuid string 用户游戏唯一标示 id Yes\nserver_id string 用户所在游戏服 id Yes\nctwid integer g123 平台生成id Yes\ntimestamp unix\ntime事件发生时间 Yes\nitem string item 相关字段 Yes\nrole string 用户相关字段 Yes\ncustom_parameter string 自定义字段 No 针对埋点对象所\n需传值的自定义\n项\n::: item 字段:::\nitem\nid string 商品id Yes\ntype string 商品类型 Yes\nname string 商品名 Yes\ncount string 商品总量 Yes\nprice string 商品价格 Yes\nbalance string 商品剩余量 Yes\ndesc string 商品描述 Yes\ncontent string 商品内容 Yes11.分析用数据同步 16\nitem\nreferer string 商品的上一跳转名称 Yes\npayment_type string 付费方式，各种虚拟货币 Yes\ncustom string item 中的其他内容 No"
    },
    {
        "data": "balance string 商品剩余量 Yes\ndesc string 商品描述 Yes\ncontent string 商品内容 Yes11.分析用数据同步 16\nitem\nreferer string 商品的上一跳转名称 Yes\npayment_type string 付费方式，各种虚拟货币 Yes\ncustom string item 中的其他内容 No\n::: role 字段:::\nrole\nid string 商品\nidYes\nlevel string 商品名Yes\nexp string 商品价\n格Yes\nvip_level string 商品总\n量Yes\nvip_exp string 商品内\n容Yes\nvistual_balance string 虚拟货\n币内容Yes“virtual_balance ”: {“diamond ”: 1234,\n“gold”: 567000 }\ncustom string role\n中的其\n他内容No\n::: custom_parameter: 保留字段，存放自定义项 :::\n例：JSON Format\nV ersion Requests v1 V1 api\n{\n\"schema\" :\"g_obtain/1-0-0\" ,\n\"type\":\"g_obtain\" ,11.分析用数据同步 17\n\"uuid\":\"\" ,\n\"ctwid\":\"G8Z0V61R\" ,\n\"appid\":\"vividarmy\" ,\n\"time\":\"1601258400416\" ,\n\"plt_url\" :\"\",\n\"app_url\" :\"\",\n\"page\":{\n\"browser_id\" :\"\" ,\n\"url\":\"\" ,\n\"client_ip\" :\"153.232.108.190\" ,\n\"network_connection\" :\"\",\n\"network_information\" :\"\" ,\n\"referer\" :\"\" ,\n\"user_agent\" :\"\"\n},\n\"payload\" :{\n\"game_server_id\" :\"444\",\n\"game_user_id\" :\"263155351996\",\n\"role_id\" :\"263155351996\",\n\"role_level\" :73,\n\"role_exp\" :9.413059144099768e53,"
    },
    {
        "data": "\"referer\" :\"\" ,\n\"user_agent\" :\"\"\n},\n\"payload\" :{\n\"game_server_id\" :\"444\",\n\"game_user_id\" :\"263155351996\",\n\"role_id\" :\"263155351996\",\n\"role_level\" :73,\n\"role_exp\" :9.413059144099768e53,\n\"role_custom\" :\"{\\\"talent\\\":1201002,\\\"reg_server_id\\\":\\\"444\\\"}\",\n\"role_vip_level\" :9,\n\"role_vip_exp\" :19097,\n\"role_power\" :8.456929943728848e56,\n\"virtual_balance1\" :9097,\n\"virtual_balance2\" :0,\n\"virtual_balance3\" :0,\n\"item_id\" :\"\",\n\"item_type\" :\"item\",\n\"item_name\" :\"钻石\",\n\"item_count\" :5,\n\"item_balance\" :9102,11.分析用数据同步 18\n\"item_desc\" :\"free\",\n\"item_content\" :\"\",\n\"item_referer\" :\"\"\n}\n}\nV1 cp 侧\n{\n\"action\" :\"g_login\" ,\n\"data\" : {\n\"game_server_id\" :\"\",\n\"game_user_id\" :\"\",\n\"role_id\" :\"\" ,\n\"role_custom\" :\"\",\n\"role_level\" :\"\" ,\n\"role_exp\" :\"\" ,\n\"role_vip_level\" :\"\",\n\"role_vip_exp\" :\"\",\n\"role_power\" :\"\" ,\n\"virtual_balance1\" :\"\",\n\"virtual_balance2\" :\"\",\n\"virtual_balance3\" :\"\",\n\"item_id\" :\"\" ,\n\"item_type\" :\"\" ,\n\"item_name\" :\"\" ,\n\"item_count\" :\"\" ,\n\"item_balance\" :\"\",\n\"item_desc\" :\"\" ,\n\"item_content\" :\"\","
    },
    {
        "data": "\"virtual_balance1\" :\"\",\n\"virtual_balance2\" :\"\",\n\"virtual_balance3\" :\"\",\n\"item_id\" :\"\" ,\n\"item_type\" :\"\" ,\n\"item_name\" :\"\" ,\n\"item_count\" :\"\" ,\n\"item_balance\" :\"\",\n\"item_desc\" :\"\" ,\n\"item_content\" :\"\",\n\"item_referer\" :\"\"\n}\n}11.分析用数据同步 19\nV ersion request v2 V2 api\n{\n\"schema\" :\"g_obtain/2-0-0\" ,\n\"type\":\"g_obtain\" ,\n\"uuid\":\"\" ,\n\"ctwid\":\"G8Z0V61R\" ,\n\"appid\":\"vividarmy\" ,\n\"time\":\"1601258400416\" ,\n\"plt_url\" :\"\",\n\"app_url\" :\"\",\n\"page\":{\n\"browser_id\" :\"\" ,\n\"url\":\"\" ,\n\"client_ip\" :\"153.232.108.190\" ,\n\"network_connection\" :\"\",\n\"network_information\" :\"\" ,\n\"referer\" :\"\" ,\n\"user_agent\" :\"\"\n},\n\"payload\" :{\n\"game_server_id\" :\"444\",\n\"game_user_id\" :\"263155351996\",\n\"role\" :{\n\"id\":\"\" ,\n\"level\":\"\" ,\n\"exp\":\"\" ,\n\"vip_level\" :\"\",\n\"vip_exp\" :\"\",\n\"power\":\"\" ,\n\"virtual_balance\" : {\n\"diamond\" :1234 ,\n\"gold\" :567000\n},11.分析用数据同步 20\n\"custom\" : {\n\"power\":\"\",\n\"food\":\"\",\n\"intelligence\" :\"\",\n\"energy\" :\"\",\n\"own_items\" :\"\"\n}\n},\n\"item\":{\n\"id\":\"\",\n\"type\":\"\",\n\"name\":\"\",\n\"count\":\"\",\n\"balance\" :\"\",\n\"desc\":\"\",\n\"content\" :\"\","
    },
    {
        "data": "},11.分析用数据同步 20\n\"custom\" : {\n\"power\":\"\",\n\"food\":\"\",\n\"intelligence\" :\"\",\n\"energy\" :\"\",\n\"own_items\" :\"\"\n}\n},\n\"item\":{\n\"id\":\"\",\n\"type\":\"\",\n\"name\":\"\",\n\"count\":\"\",\n\"balance\" :\"\",\n\"desc\":\"\",\n\"content\" :\"\",\n\"referer\" :\"\",\n\"payment_type\" :\"\" ,\n\"custom\" : {}\n},\n\"custom\" :{\n\"device_id\" :\"\"\n}\n}\n}\nV2 cp 侧\n{\n\"version\" :\"v2\" ,\n\"action\" :\"g_login\" ,\n\"data\" : {\n\"game_server_id\" :\"\",\n\"game_user_id\" :\"\",11.分析用数据同步 21\n\"role\" :{\n\"id\":\"\" ,\n\"level\":\"\" ,\n\"exp\":\"\" ,\n\"vip_level\" :\"\",\n\"vip_exp\" :\"\",\n\"virtual_balance\" : {\n\"diamond\" :1234 ,\n\"gold\" :567000\n},\n\"custom\" : {\n\"power\":\"\",\n\"food\":\"\",\n\"intelligence\" :\"\",\n\"energy\" :\"\",\n\"own_items\" :\"\",\n}\n},\n\"item\":{\n\"id\":\"\" ,\n\"type\":\"\" ,\n\"name\":\"\" ,\n\"count\":\"\" ,\n\"price\":\"\" ,\n\"balance\" :\"\",\n\"desc\":\"\" ,\n\"content\" :\"\",\n\"referer\" :\"\",\n\"payment_type\" :\"\" ,\n\"custom\" : {}\n},\n\"custom_parameter\" :{\n\"device_id\" :\"\"11.分析用数据同步 22\n}\n}\n}\n|\n礼包购买 psp，追加item_id 和item_type\nhttps://developers.g123.jp/payment.html#_2-1-%E5%88%9B%E5%BB%BA%E5%85%A8%E5%B1%80%E8%AE%A4%E8%AF%81-\ntoken"
    },
    {
        "data": "},\n\"custom_parameter\" :{\n\"device_id\" :\"\"11.分析用数据同步 22\n}\n}\n}\n|\n礼包购买 psp，追加item_id 和item_type\nhttps://developers.g123.jp/payment.html#_2-1-%E5%88%9B%E5%BB%BA%E5%85%A8%E5%B1%80%E8%AE%A4%E8%AF%81-\ntoken\nitem_id 是在这个items的code字段\nitem_type 是放在custom 字段\n同步方式\n文件同步\nCP可以自动每天同步数据到我们指定的 s3 path\n•游戏服开合服信息（全量）\n•道具配置表（全量）\n•礼包配置表（全量）\n•用户持有道具信息表（异世界）\n•用户持有英雄信息表（异世界）\n数据库访问（添加访问权限）\n•用户属性表\n•用户extra表（异世界）\n打点事件\n用户浏览，点击，获得，消耗道具 /礼包事件打点11.分析用数据同步 23\n•浏览，点击礼包信息\n•获得，消耗道具信息\n•购买礼包信息\n例：#### 异世界文件同步（ @Chin 给CP S3 路径和目录 format ，Today CP 开始放\n数据到指定 S3路径）-道具配置表（全量） -礼包配置表（全量）数据库访问（添加访问权限） – CP\n给我们权限（ Today ）-游戏服开合服信息（全量） -用户持有道具信息表（异世界） -用户持有英雄\n信息表（异世界） -用户属性表 -用户extra表打点事件 - @wang 同CP开始沟通具体内容\n百花\n•游戏服开合服信息（全量）提供 CP，S3文件路径@Chin- チン\n•道具配置表（全量）\n•礼包配置表（全量）麻烦 CP把用户信息相应的表结构和样本数据发给我们看一下。例：\n•用户持有道具信息表\n•用户持有英雄信息表\n•用户属性表\n•用户extra表打点事件\n•@wang 同CP开始沟通具体内容\n八男\n•游戏服开合服信息（全量）提供 CP，S3文件路径@Chin- チン\n•道具配置表（全量）\n•礼包配置表（全量）麻烦 CP把用户信息相应的表结构和样本数据发给我们看一下。例：\n•用户持有道具信息表\n•用户持有英雄信息表\n•用户属性表\n•用户extra表打点事件\n•@wang 同CP开始沟通具体内容\n同步频率"
    },
    {
        "data": "•用户属性表\n•用户extra表打点事件\n•@wang 同CP开始沟通具体内容\n八男\n•游戏服开合服信息（全量）提供 CP，S3文件路径@Chin- チン\n•道具配置表（全量）\n•礼包配置表（全量）麻烦 CP把用户信息相应的表结构和样本数据发给我们看一下。例：\n•用户持有道具信息表\n•用户持有英雄信息表\n•用户属性表\n•用户extra表打点事件\n•@wang 同CP开始沟通具体内容\n同步频率\n•Daily同步9.服务器间事件上报 24\n业务属性\n礼包推荐\n道具推荐\n道具组合礼包\n新手礼包\n9.服务器间事件上报\n说明\n服务器端事件目前主要用于含有奖励的活动（如：升到指定级别发送 PayPay 红包） ，以及成果报酬\n型广告（如：通过第三方积分网站进入游戏，升到指定级别向用户发放第三方积分） 。因此需要游戏服务\n器和平台服务器间通讯以确保数据可靠性，防止作弊。\n9.1升级 (level_up)\nCP对应流程\n1.当用户达到升级时 , CP游戏服务器向平台服务器发送事件，平台返回响应消息\n2.CP游戏服务器将收到的响应信息推送至游戏前端 ,前端将该信息通过 win-\ndow.top.postMessage 发送到平台主窗口。\n注:游戏服务器端要确保用户达到指定等级\n环境参数\n系统 环境 API Host\n登录 测试 https://h5.stg.g123.jp\n登录 正式 https://h5.g123.jp9.服务器间事件上报 25\n系统 环境 API Host\n此外，该流程使用登录流程的 appId 和appSecret ，参见账号接口\n9.2创建事件\nPOST /api/v1/cp/game_event/level_up\nRequest Header 使用Basic认证方式发送 appId 和appSecret\nRequest header Description\nContent-Type application/json\nAuthorization Basic base64( ‘𝑎𝑝𝑝𝐼 𝑑 ∶appSecret ’)\nRequest Body\nRequest Body Format Value Required\nuid string 用户游戏唯一标示 id Yes\nserver_id string 用户所在游戏服 id Yes"
    },
    {
        "data": "Content-Type application/json\nAuthorization Basic base64( ‘𝑎𝑝𝑝𝐼 𝑑 ∶appSecret ’)\nRequest Body\nRequest Body Format Value Required\nuid string 用户游戏唯一标示 id Yes\nserver_id string 用户所在游戏服 id Yes\nctwid string g123 平台生成id Yes\ntimestamp long 事件发生时间 (UNIX 时间单位:ms) Yes\nlevel integer 用户级别 Yes\ndata object 数据系统用 Yes\n::: data 字段:::\ncolumns format value required desc\ngame_user_id string CP 数据库玩家账号 Yes 游戏数据库分配\n的账号唯一标识9.服务器间事件上报 26\ncolumns format value required desc\nrole object 用户相关字段 Yes 玩家属性信息\ncustom object 自定义字段 Yes 针对埋点对象所\n需传值的自定义\n项，目前必传项\n为 physi-\ncal_server\n（如该uid触发\n事件所在物理服\n务器的域名信\n息） 。\nResponse Body 状态码: 200消息内容：JSON 格式的返回数据\n注:返回的数据格式可能会在正式版本发布时有所变动，请在 1.2前端事件触发这一步中，将返回数\n据全部通过 postMessage 提交\n示例\ncurl -i -X POST \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization:Basic $(echo -n $APP_ID:$APP_SECRET | openssl base64)\" \\\n-d \\\n'{\n\"uid\": \"123\",\n\"server_id\": \"s73\",\n\"ctwid\": \"GIL6T4CO\",\n\"timestamp\": 1605076260715,\n\"level\": 10,\n\"data\": {\n\"game_user_id\":\"1234567\",\n\"role\": {\n\"id\":\"3444382\",9.服务器间事件上报 27"
    },
    {
        "data": "-d \\\n'{\n\"uid\": \"123\",\n\"server_id\": \"s73\",\n\"ctwid\": \"GIL6T4CO\",\n\"timestamp\": 1605076260715,\n\"level\": 10,\n\"data\": {\n\"game_user_id\":\"1234567\",\n\"role\": {\n\"id\":\"3444382\",9.服务器间事件上报 27\n\"exp\":\"1\",\n\"vip_level\":\"0\",\n\"vip_exp\":\"0\",\n\"virtual_balance\": {\n\"diamond\": \"1234\",\n\"gold\": \"567000\"\n},\n\"custom\": {\n\"reg_server_id\": \"1\" // server id where g_register occurred\n}\n},\n\"custom\":{\n\"device_id\": \"\",\n\"physical_server\": \"$SERVER_HOST|$SERVER_IP\"\n}\n}\n}' \\\n'https://h5.stg.g123.jp/api/v1/cp/game_event/level_up'\nOUTPUT:\nHTTP/1.1 200 OK\nvary: accept-encoding\ncontent-type: application/json;charset=UTF-8\ntransfer-encoding: chunked\ndate: Wed, 11 Nov 2020 07:53:51 GMT\nconnection: close\n{\"action\":\"game_event_created\",\"id\":\"1\",\"token\":\"fdda6c9f-5745-4adc-9541-c3827d654dfa\"}\n注:返回的数据格式可能会在正式版本发布时有所变动10.常见问题 28\n9.3前端事件触发\n将平台服务器的返回的消息，在前端通过 window.top.postMessage 传递到平台\nwindow.top.postMessage(responseData, '*');\n10.常见问题\n1.域名连接不稳定 A:请检查网络服务器、 cdn以及负载等的配置，以及 ssl的配置（加密太多\n等） 。\n2.游戏账号丢失 A:系统默认发放的 guest 账号信息保存在浏览器缓存中，若清除了缓存和"
    },
    {
        "data": "将平台服务器的返回的消息，在前端通过 window.top.postMessage 传递到平台\nwindow.top.postMessage(responseData, '*');\n10.常见问题\n1.域名连接不稳定 A:请检查网络服务器、 cdn以及负载等的配置，以及 ssl的配置（加密太多\n等） 。\n2.游戏账号丢失 A:系统默认发放的 guest 账号信息保存在浏览器缓存中，若清除了缓存和\ncookie 则账号信息会丢失。可以通过在游戏内将账号绑定 SNS社交账号（twiiter 、LINE 等）\n来避免账号丢失。\n3.获取 userId 时出错的常见原因\n1.code过期，请重新加载页面从游戏入口中获取新的 code\n2.API Host 选取错误，请注意区分测试环境与正式环境 ,点此查询\n3.调用API地址书写错误\n4.appId 与appSecret 参数错误\n4.对接过程中出现异常错误 请首先尝试连接 VPN验证是否为网络问题。\n5.游戏资源加载慢 请检查浏览器内游戏资源下载的时间，可能是选择的 cdn节点导致。\n6.平台游戏要适配的屏幕分辨率、主要是哪几种？ 需要在主流 PC和Mobile 的浏览器上适配。\n可以参考这里各个设备的 Viewport 值https://blisk.io/devices10.常见问题 29\n7.游戏系统运维部署方面是怎样安排的？\n•我们目前跟国内 CP的合作方式、是仅提供服务器、 CDN等infra资源。为方便理解、请提\n供游戏整体架构图，机器硬件配置要求。服务器的配置以及部署发版、完全由 CP方自己负责。\n•其中、CDN的部分我们使用 AWS的 CloudF ront 、源站是S3用来存放html图\n片等静态资源、我们会提供 key用来上传S3资源。如何配置AWS CLI\n•服务器与数据库 (目前仅提供正式环境资源、测试环境烦请自行搭建 )的部分、我们使用的是阿\n里云的ECS与 RDS(MySQL, MongoDB, Redis 等)服务。\n•其他资源、如域名 (g123-{appid}.com) 、SSL(*.g123-{appid}.com) 证书\n等、也会由我方提供。\n•监控方面、请 CP方做好游戏应用相关的监控。平台方会配置 Infra 层的监控、如\nCPU/Memory/Disk/Connection 等。"
    },
    {
        "data": "里云的ECS与 RDS(MySQL, MongoDB, Redis 等)服务。\n•其他资源、如域名 (g123-{appid}.com) 、SSL(*.g123-{appid}.com) 证书\n等、也会由我方提供。\n•监控方面、请 CP方做好游戏应用相关的监控。平台方会配置 Infra 层的监控、如\nCPU/Memory/Disk/Connection 等。\n8.何时向平台申请游戏服务器等 Infra 资源 ?功能版本的开发请自行搭建测试服、待功能完善且\n平台可进行大规模 QA之前、可向平台申请测试环境资源。\n9.国际化对应的时候，游戏获取到平台传来的币种后，具体商品的价格如何转换 ?商品的价格不需\n要转换，运营负责人会提供不同的币种下的商品价目表。参考： 国际化文档\n10.运营策略方面、开服后、要准备好多少可以随时开的游戏服？ 需要看一个服多少人（平台游戏\n一般7500创角自动开新服） 、如果有预注册的游戏、一般第一天导入 1万左右。可以先准备 10个\n服左右、看游戏数据与导量情况再开。\n11.平台支持的浏览器版本有哪些？ 平台使用开源的 浏览器代码编译级别 来保证绝大多数浏览器的\n兼容（部分过旧版本的浏览器访问游戏可能会出错） ,当前平台设置的规则是\n>1% inJP,\n>1%,not IE 11\n当前对应的浏览器范围是： and_chr 103 、chrome 103 、chrome 102 、chrome 101 、edgeG123平台接入指南 30\n103、edge 102 、edge 101 、firefox 101 、ios_saf 15.5 、ios_saf 15.4 、ios_saf 14.5-\n14.8、safari 15.5 、samsung 17.0\nimport Callout from ‘nextra-theme-docs/callout ’\nG123 平台接入指南\n一、 G123 平台特性\n•G123平台主打H5网页游戏，开发适配时请参考 最佳实践\n•G123用户无需注册账号，进入游戏即为其分配唯一的用户 ID（G123 ID ）\n•G123平台支持 多语言切换\n•G123平台提供推荐 多语言字体 下载，开发多语言游戏版本时，请参照下载使用\n•G123平台支持 多币种支付\n二、接入流程概述\n图1:workflow"
    },
    {
        "data": "G123 平台接入指南\n一、 G123 平台特性\n•G123平台主打H5网页游戏，开发适配时请参考 最佳实践\n•G123用户无需注册账号，进入游戏即为其分配唯一的用户 ID（G123 ID ）\n•G123平台支持 多语言切换\n•G123平台提供推荐 多语言字体 下载，开发多语言游戏版本时，请参照下载使用\n•G123平台支持 多币种支付\n二、接入流程概述\n图1:workflow\n三、 G123 平台接口 /文档列表G123平台接入指南 31\n平台接\n口/文档 说明 接入阶段\n1.平台翻译\n工具接口可上传原文\n文本，并下\n载译文游戏制作\n2.账号接口\n(必接)获取G123\n用户唯一\nID及国际\n化参数等账\n号信息测试环境&正式环境\n3.支付接口\n(必接)接入G123\n平台支付系\n统（多币种\n支持）测试环境&正式环境\n4.数据接口\n(必接)向G123\n平台上报重\n要的日志数\n据测试环境&正式环境\n5.客服接口\n(必接)调起G123\n平台客服系\n统测试环境&正式环境\n6.礼包接口\n(必接)提供\npopup\nAPI接口\n给平台，调\n用gift\nAPI获取\n礼包信息测试环境&正式环境\n7.其他接口\n(选接)G123\nSNS分\n享/绑定/切\n换账号登选\n接API测试环境&正式环境G123平台接入指南 32\n平台接\n口/文档 说明 接入阶段\n8.Infra 申\n请申请Infra\n资源测试环境&正式环境\n9.切换到正\n式环境测试QA\n通过后正式\n替换接口环\n境参数正式环境\n10.常见问\n题关于接入平\n台时的常见\n问题正式环境\n11.数据分\n析用游戏上线后，\n游戏内活动\n效果数据分\n析用上线后\n四、接入须知\n多语言切换技术要点\n平台这边默认所有游戏、后续都会进行海外的投放、游戏国际化的技术实现、请提前同步以下几点\n•游戏的多语言支持：玩家可以在游戏内自由 切换语言 。\n请务必确认对游戏切语言的支持、必要时烦请提前做好游戏架构更新。\n•玩家进入游戏时的语言：始终根据平台透传的相关 语言参数、展示给玩家对应的语言界面。\n•切换语言时与平台的联动：玩家游戏内切换语言时、需要将切换的目标 语言参数通知平台。\n•海外多币种支持：始终根据平台透传的 币种参数、使用该币种的固定价目表来展示金额、以及创\n建订单。 （创建订单时传递的金额和币种一定要匹配）"
    },
    {
        "data": "请务必确认对游戏切语言的支持、必要时烦请提前做好游戏架构更新。\n•玩家进入游戏时的语言：始终根据平台透传的相关 语言参数、展示给玩家对应的语言界面。\n•切换语言时与平台的联动：玩家游戏内切换语言时、需要将切换的目标 语言参数通知平台。\n•海外多币种支持：始终根据平台透传的 币种参数、使用该币种的固定价目表来展示金额、以及创\n建订单。 （创建订单时传递的金额和币种一定要匹配）\n•支持全球玩家混服等数据互动：后台全球玩家数据互通、 infra单地区单系统即可。 （阿里云日\n本区、全球玩家访问速度没问题）\n接入详情请参照： 国际化详细文档G123平台接入指南 33\n其他须知\n1.所有API请走后端,不要将平台 key等暴露在前端显示\n2.网络不稳定或支付测试报错时请尝试连接 VPN后重试\n3.控制台偶有报错是由于网络不稳定，属于正常情况，持续报错才有问题\n4.平台提供了 登录支付模拟 demo\n5.平台测试环境数据库 15分钟无动作会自动休眠，发送一次请求后即可唤醒数据库，等待 1~2\n分钟即可。\n五、最佳实践\n资源加载\n•图片等静态资源、尽量不要做加密处理。很多设备的加解密性能很差、影响游戏加载速度。\n•尽早发现功能上的加载热点（比如某个功能的点开需要数十个资源请求） 、做好相关资源的提前加\n载。\n•在不影响玩家体验的前提下、尽量压缩游戏资源、以加快 CDN下载速度与减少资源内存占\n用。 （CDN自动压缩的对象资源最大 10M）\n•游戏整体的静态资源、尽量做到分批加载。如加载完游戏首屏的资源下载量 20M、通过新手教\n程的资源下载量 50M等。 （以页游的推广策略与留存来看、大多数玩家可能在前期离开、 CDN\n的按量成本需要做好控制）\n•游戏使用cocos引擎时、前端 maxConcurrency 与maxRequestsPerFrame 配\n置可尽量调大些。现在连接都是 http 2.0 、调大这些参数会加载得更快、尤其对于数量多的小\n文件。REF\n•同上，使用白鹭引擎时，通过 setMaxLoadingThread() 增加资源并发加载数\njs代码压缩\n•代码混淆会使 js文件大小急剧增加，使游戏加载速度变慢，因此不推荐对 js进行代码混淆。可\n以使用Terser/UglifyJS 等工具对代码进行压缩。6.礼包接口 34\n游戏体验相关\n关于游戏服务器选服"
    },
    {
        "data": "文件。REF\n•同上，使用白鹭引擎时，通过 setMaxLoadingThread() 增加资源并发加载数\njs代码压缩\n•代码混淆会使 js文件大小急剧增加，使游戏加载速度变慢，因此不推荐对 js进行代码混淆。可\n以使用Terser/UglifyJS 等工具对代码进行压缩。6.礼包接口 34\n游戏体验相关\n关于游戏服务器选服\n•游戏服务器命名统一从 S1，S2，S3的形式递增往下命名，无需特殊命名名称\n•游戏载入时，不要停留在选服页面，直接进入游戏，仅在用户在设定中选择服务器时才显示选服\n确认页面\n关于游戏内常规运营活动\n•游戏内签到功能，尽量做到用户登录后直接弹出来，自动为用户点击签到并领取奖励\n平台游戏实例\nimport Callout\nfrom “nextra-theme-docs/callout ”; import GiftSequenceDiagram from\n“./assets/gift-sequence-diagram.svg ”;\n6.礼包接口\n时序图\n购买时序请参照支付6.礼包接口 35\n6.1使用 G123 礼包管理系统上传物品并创建礼包\n在接入礼包 API之前，需要在 G123礼包管理系统中添加物品信息并配置礼包。\nG123礼包管理系统入口如下： -测试环境-正式环境-请联系平台获取登陆用户名和密码。\n请在G123礼包管理系统完成以下操作： -物品配置：添加物品类型，逐个添加物品或批量上传物品 -\n礼包配置：添加礼包模版，配置礼包基本信息以及礼包内包含的物品 -可以在系统面板中查看并编辑已\n配置的物品和礼包信息。 -详情请参照 产品使用说明书\n6.2 CP 提供 popup API 接口给平台\nEndpoint POST {API Host}/gift/popup\nCP需要提供此处的 API Host 。\n例：https://jp-test-001.g123-xxxx.com:1234/gift/popup\nRequest 需要包含以下信息： | Parameter | Description |Type | Required |\nExample | | ———————— - |————————————– |———–|———- |———| |"
    },
    {
        "data": "CP需要提供此处的 API Host 。\n例：https://jp-test-001.g123-xxxx.com:1234/gift/popup\nRequest 需要包含以下信息： | Parameter | Description |Type | Required |\nExample | | ———————— - |————————————– |———–|———- |———| |\npopup_id |用于校验使用者是否能够购买该礼包， g123生成| String | Yes | 6f9cf1a3-\n3103-4f95-a148-0e2e5659d8a5 | | ctwid|平台用户id,以G开头8位数| String |\nYes | G12QWASD | | game_user_id | CP侧记录用户 id | String | No | 1234567\n| |game_server_id |游戏服id | String | Yes | s01 | | role.id |用户在游戏服上的\nid | String | Yes | 30000077 | | gift.id |推送的礼包 id | String | Yes | 50005001\n| |template_id | CP侧准备的礼包 page展示模版id |String | Yes | 1 |\nResponse HTTPCode 返回204即成功。\n用例\nRequest6.礼包接口 36\n{\n\"popup_id\" :\"xxxxxxx\" ,\n\"ctwid\":\"GXXXXXXX\" ,\n\"game_user_id\" :\"1234567\" ,\n\"game_server_id\" :\"s01\",\n\"role\":{\n\"id\":\"xxxxxxx\"\n},\n\"gift\":{\n\"id\":\"xxxxx\"\n},\n\"template_id\" :\"1\"\n}\nResponse (Success)\nHTTP Code: 204\nNo Content\nResponse (F ailed)\nHTTP Code: 417\n{\"reason\": \"xxxxx\"}\n•弹出礼包时用户不在线： Failed response\n6.3调用 gift API 获取礼包信息\nPublic API 的文档链接： -测试环境-正式环境"
    },
    {
        "data": "\"template_id\" :\"1\"\n}\nResponse (Success)\nHTTP Code: 204\nNo Content\nResponse (F ailed)\nHTTP Code: 417\n{\"reason\": \"xxxxx\"}\n•弹出礼包时用户不在线： Failed response\n6.3调用 gift API 获取礼包信息\nPublic API 的文档链接： -测试环境-正式环境\nPublic API 分为两类。- OAuth ：用于认证 - Gifts ：用于获取礼包信息\n环境参数6.礼包接口 37\n系统 环境 API Host\n礼包 测试 https://h5.stg.g123.jp\n礼包 正式 https://h5.g123.jp\n6.3.1 获取 Access T oken\nEndpoint POST {API Host}/oauth2/login-password\n认证机制基于 OAuth ，需要request Header 中有一个有效的 Access Token 。\nRequest 发送一个POST request ，request body 中包含用户名和密码。\n用户名和密码请联系平台获取。\nParameter Description Type RequiredExample\nusername 用户名，请联系平台获取 String Yes string\npassword 密码，请联系平台获取 String Yes string\nResponse 系统将返回一个包含 AccessToken 的response 。|Parameter|Descrip-\ntion | | ————|—————————————————————————————————— | |\naccess_token | Access token | | token_type | Bearer | | expires_in | Expire\ntime(in seconds) | | refresh_token | Refresh token |\n获得的Access Token 可以在request Header 中使用。\n用例\nRequest\ncurl-X'POST'\\\n'https://gift.stg.g123.jp/oauth2/login-password' \\"
    },
    {
        "data": "time(in seconds) | | refresh_token | Refresh token |\n获得的Access Token 可以在request Header 中使用。\n用例\nRequest\ncurl-X'POST'\\\n'https://gift.stg.g123.jp/oauth2/login-password' \\\n-H'accept: */*' \\6.礼包接口 38\n-H'Content-Type: application/json' \\\n-d'{\n\"username\": \"string\",\n\"password\": \"string\"\n}'\nResponse\n{\n\"access_token\" :\"JWT\",\n\"token_type\" :\"Bearer\" ,\n\"expires_in\" :2592000,\n\"refresh_token\" :\"token\",\n\"user_id\" : null,\n\"scope\": null}\n6.3.2 获取单个礼包信息\nEndpoint GET {API Host}/api/v1/gifts/{id}\nRequest\nParameter Description Type RequiredExample\nid 礼包的标识字符串 String Yes string\napp_id 平台定义的 appId（联系平台获取） String Yes vividarmy\nResponse\nParameter Description Type RequiredExample\nid 礼包的标识字符串 String Yes string\nvipPoints 购买礼包后可获得的 vip点数 Integer Yes 06.礼包接口 39\nParameter Description Type RequiredExample\namountToDiamond 此礼包付费但是购买失败后给玩家补\n单的钻石数量Integer No 0\nprice 礼包的定价 Integer Yes 0\npriceValueRatio 礼包性价比 Integer No 0\nduration 弹出时长（小时） Integer No 0\npurchaseLimitAmount 礼包限购数量 Integer No 0\nisAISupported 是否支持AI Bool,"
    },
    {
        "data": "单的钻石数量Integer No 0\nprice 礼包的定价 Integer Yes 0\npriceValueRatio 礼包性价比 Integer No 0\nduration 弹出时长（小时） Integer No 0\npurchaseLimitAmount 礼包限购数量 Integer No 0\nisAISupported 是否支持AI Bool,\ntrue or\nfalseYes true\nitems 礼包内包含的物品 {item id:\nitem quantity, item id:\nitem quantity}Dict Yes { “4”:\n1880,\n“11019”\n: 30,\n“80613”\n: 1}\nplatform_creative 背景图片enabled: true/false\n(exist then true else false)Dict No { “en-\nabled”\n: true,\n“back-\nground ”\n:\n“https://platform-\nik.stg.g123.jp/auxin/gift-\ncreative/queensblade/banner_BG01_007.png?tr=f-\nwebp”\n}或者\n{“en-\nabled”\n: false\n}6.礼包接口 40\n用例\nRequest\ncurl-X'GET'\\\n'https://gift.stg.g123.jp/api/v1/gifts/50005003?app_id=tenseikenja' \\\n-H'accept: application/json' \\\n-H'Authorization: Bearer JWT\nRequest URL\nhttps://gift.stg.g123.jp/api/v1/gifts/50005003?app_id=tenseikenja\nResponse\n{\n\"id\":\"50005003\" ,\n\"vipPoints\" :1280,\n\"amountToDiamond\" :1280,\n\"price\":1280,\n\"priceValueRatio\" :1000,\n\"duration\" :24,\n\"purchaseLimitAmount\" :1,\n\"isAISupported\" : true,\n\"platformCreative\" :{"
    },
    {
        "data": "Response\n{\n\"id\":\"50005003\" ,\n\"vipPoints\" :1280,\n\"amountToDiamond\" :1280,\n\"price\":1280,\n\"priceValueRatio\" :1000,\n\"duration\" :24,\n\"purchaseLimitAmount\" :1,\n\"isAISupported\" : true,\n\"platformCreative\" :{\n\"enabled\" :true,\n\"background\" :\"https://ctwbox-static.stg.g123.jp/preview/4e9c2ca44ccbbcf06000ec13c56a4a48a100742df9cf639f85b04d6a.png\"\n},\n\"items\":{\n\"4\":1880,\n\"11019\":30,\n\"80613\":1}\n}G123 CP SDK 1\nimport Callout from ‘nextra-theme-docs/callout ’;\nG123 CP SDK\n1.介绍\nG123平台为游戏开发商提供了一套简单易用的接口，以便在游戏中实现登录、支付等功能。本文档将\n介绍如何在游戏中接入 G123平台。\n2加载 SDK\n在游戏的登录页面中，加载 G123平台提供的 SDK文件，注意区分环境，测试环境和正式环境的\nSDK文件不同。\n环境 API Host\n测试 https://platform-sc.stg.g123.jp/cp-sdk/g123-cp-sdk.umd.js\n正式 https://platform-sc.g123.jp/cp-sdk/g123-cp-sdk.umd.js\n调用 window.CpSdk 时，需要确保 SDK已经加载完成，因此 SDK的加载应该当以同步的方\n式嵌入到页面中。\n3.类型定义 (TypeScript)\n点击查看 : SDK 的 TypeScript 定义\n/**\n*支付窗口调起参数\n*\n*该参数由游戏服务器通过调用平台支付接口生成，然后通过游戏前端传递给 SDK\n*/G123 CP SDK 2\nexport declare interface CreateOrderResponse {\norderNo : string ;\ntoken : string ;\n};\n/**\n*平台参数\n*"
    },
    {
        "data": "点击查看 : SDK 的 TypeScript 定义\n/**\n*支付窗口调起参数\n*\n*该参数由游戏服务器通过调用平台支付接口生成，然后通过游戏前端传递给 SDK\n*/G123 CP SDK 2\nexport declare interface CreateOrderResponse {\norderNo : string ;\ntoken : string ;\n};\n/**\n*平台参数\n*\n*用于初始化游戏，及获取 code等参数\n*/\nexport declare interface PlatformParams {\n/**\n* Access Code ，用于获取用户信息\n*/\ncode : string ;\n/**\n*平台其它参数，详细参考文档\n*/\nparams : Record <string ,string >;\n/**\n*环境变量: 'production' | 'staging'\n*/\nenv : string ;\n};\nexport declare interface CpSdk {\n/**\n*获取code等平台参数\n*/\ngetPlatformParams : () => Promise <PlatformParams |undefined >;\n/**\n*激活支付窗口\n*/G123 CP SDK 3\nsendPayment : (params :CreateOrderResponse) => Promise <void >;\n/**\n*保存数据\n*/\nsaveData : (s: string )=> Promise <void >;\n/**\n*恢复数据\n*/\nrestoreData : () => Promise <string >;\n};\ndeclare global {\ninterface Window {\nCpSdk :CpSdk ;\n}\n}\n4. API\n4.1获取平台参数\n参见账号接口 文档\n此前平台会将 code等参数通过 URL的query string 传递给游戏，现在改为通过 SDK获取，\n游戏需要在初始化时调用 getPlatformParams 方法获取平台参数。\n获取 code\nconst platformParams = await window .CpSdk .getPlatformParams () ;"
    },
    {
        "data": "}\n}\n4. API\n4.1获取平台参数\n参见账号接口 文档\n此前平台会将 code等参数通过 URL的query string 传递给游戏，现在改为通过 SDK获取，\n游戏需要在初始化时调用 getPlatformParams 方法获取平台参数。\n获取 code\nconst platformParams = await window .CpSdk .getPlatformParams () ;\n//获取code，用于服务器端获取用户平台 ID，lang, currency 等信息\nconst code = platformParams .code ;\n//获取其它参数\nconst params =platformParams .params ;G123 CP SDK 4\n关于其它参数，目前平台会传递以下参数：\n参数名 说明 默认值\nplatform 主窗口 URL Query 透传，\n旧版 API广告追踪参数‘ctw’\nbid 主窗口 URL Query 透传，\n旧版 API广告追踪参数undefined\nver 主窗口 URL Query 透传，\n旧版 API广告追踪参数undefined\nutm_medium 主窗口 URL Query 透传，\n用于部分游戏的活动undefined\nlang 平台语言，注意：此参数仅用于\n加载背景图等 critical 的资\n源。用户使用的语言请通过账号\n接口获取‘ja’\nctw_share_id 主窗口 URL Query 透传，\n用户通过分享链接打开时，获取\n分享链接的 IDundefined\nctw_share_extra 主窗口 URL Query 透传，\n用户通过分享链接打开时，获取\n分享链接的数据undefined\n4.2激活支付窗口\n参见支付文档\n游戏在服务器端调用平台支付 API，平台返回激活支付窗口的参数。游戏前端需要将这些参数传递给\nSDK，以便 SDK激活支付窗口。\nconst createOrderResponse =//服务器端调用平台支付 API，返回激活支付窗口的参数\nwindow .CpSdk .sendPayment (createOrderResponse) ;G123 CP SDK 5\n4.3保存和恢复数据\n处理 iOS环境下的数据存储问题"
    },
    {
        "data": "SDK，以便 SDK激活支付窗口。\nconst createOrderResponse =//服务器端调用平台支付 API，返回激活支付窗口的参数\nwindow .CpSdk .sendPayment (createOrderResponse) ;G123 CP SDK 5\n4.3保存和恢复数据\n处理 iOS环境下的数据存储问题\n由于在 iOS环境中，游戏 iframe 和平台 origin 不匹配，导致 localStorage 中保存的数据会\n在浏览器重启后丢失。为解决这个问题，请使用 SDK的 saveData 和 restoreData 方法保存\n必要的数据。\n注意\n存储空间有限\n•平台所有游戏共享同一个 localStorage 空间，请仅保存与当前设备相关的数据，其他数据应\n存储在服务器上，以实现不同设备间的配置同步。\n•典型应用场景：保存用户的游戏画质设置，使用户能够在手机和 PC端设置不同画质。\n仅支持字符串格式\n•转换所有数据为字符串格式，例如使用 JSON.stringify ，并合并多个数据项为单一字符串。\n//保存数据\nconst data = JSON .stringify ({\n//保存的数据\n}) ;\nawait window .CpSdk .saveData (data) ;\n//恢复数据\nconst restoredDataStr =await window .CpSdk .restoreData () ;\nif (restoredDataStr) {\n//恢复的数据\nconst restoredData =JSON .parse (restoredDataStr) ;\n}"
    }
]